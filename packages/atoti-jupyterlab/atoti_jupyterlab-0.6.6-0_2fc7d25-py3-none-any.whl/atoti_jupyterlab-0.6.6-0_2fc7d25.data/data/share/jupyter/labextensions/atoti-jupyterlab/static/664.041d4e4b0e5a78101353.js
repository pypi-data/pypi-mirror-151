"use strict";(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[664],{60664:(e,o,n)=>{n.r(o),n.d(o,{default:()=>Y});var t=n(7560),r=n(56271),a=n(8336),i=n(39349),s=n(40906),d=n(10208),l=(n(72235),n(72279),n(94738),n(28038),n(62099),n(55188),n(41305),n(61941),n(34382),n(6381),n(56441),n(66763)),u=n(14484),m=n(35676),c=n.n(m),g=n(16760),f=n.n(g),p=n(56974),h=n.n(p),b=n(55281),v=n.n(b);const k={id:"mdx",monarchLanguage:{defaultToken:"",tokenPostfix:".mdx",ignoreCase:!0,brackets:[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{close:"(",open:")",token:"delimiter.parenthesis"}],functionKeywords:d.Qp,kpiKeywords:d.kh,argumentKeywords:d.z4,memberPropertyKeywords:d.vV,axisKeywords:d.OD,cellPropertyKeywords:d.ql,booleanOperatorKeywords:d.wQ,booleanKeywords:d.c9,structuralKeywords:d.S3,tokenizer:{root:[{include:"@comments"},{include:"@whiteSpace"},{include:"@numbers"},{include:"@strings"},{include:"@delimitedIdentifier"},[/[\w@]+/,{cases:{"@structuralKeywords":"keyword.structural","@booleanKeywords":"boolean","@booleanOperatorKeywords":"keyword.booleanOperator","@axisKeywords":"keyword.axis","@cellPropertyKeywords":"keyword.cellProperty","@functionKeywords":"keyword.function","@kpiKeywords":"keyword.kpi","@memberPropertyKeywords":"keyword.memberProperty","@argumentKeywords":"keyword.argument","@default":"identifier.regular"}}],{include:"@operators"}],comments:[[/(^|[^\\:])\/\/.*/,"comment"],[/(^|[^\\:])-{2}.*/,"comment"],[/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,"comment"]],whiteSpace:[[/\s+/,"white"]],numbers:[[/\d*\.\d+(E(\+|-)?\d+)?/,"number"],[/\d+/,"number"]],operators:[[/\+|\/|\*|\^|-/,"operator"],[/>=|<=|<>|=|>|</,"operator"],[/:|&/,"operator"]],delimitedIdentifier:[[/\[([^\]]{0,100})\]/,"identifier.delimited"]],strings:[[/'/,{token:"string",next:"@string"}],[/"/,{token:"string.double",next:"@stringDouble"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],stringDouble:[[/[^"]+/,"string.double"],[/""/,"string.double"],[/"/,{token:"string.double",next:"@pop"}]]}},configuration:{comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],onEnterRules:[{beforeText:/.*\bSELECT\s*$/,action:{indentAction:1}},{beforeText:/.*\bFROM\s*$/,action:{indentAction:1}}]}},M={provideDocumentFormattingEdits:e=>{try{return[{range:e.getFullModelRange(),text:(0,d.Pz)((0,d.Qc)(e.getValue()),{indent:!0})}]}catch{}}},x=e=>(e=>{const o=e.matchAll(/Member (?<calculatedMemberUniqueName>.*) AS/gim),n=new Set;for(const e of o){var t;const o=null==e||null===(t=e.groups)||void 0===t?void 0:t.calculatedMemberUniqueName;o&&n.add(o)}return Array.from(n)})(e).map((e=>{var o;const[{groups:n={}}={}]=e.matchAll(/(\[Measures]).(?:(\[(?<quotedMeasure>.*)\])|(?<unquotedMeasure>\w*))/gi);return null!==(o=n.unquotedMeasure)&&void 0!==o?o:n.quotedMeasure})).filter(Boolean),y=(e,o,n=0)=>e.getValueInRange({startColumn:0,endColumn:o.column,startLineNumber:o.lineNumber-n,endLineNumber:o.lineNumber}),w=({label:e={label:""},insertText:o,kind:n=u.languages.CompletionItemKind.Constant,...t})=>({label:e,kind:n,insertText:void 0!==o?o:"string"==typeof e?e:e.label,range:void 0,...t}),$=e=>c()(f()(null==e?void 0:e.catalogs,"cubes")),N={getSuggestions:({position:e,textModel:o,cube:n,dataModel:t,formatMessage:r})=>{const a=y(o,e);if(a.toLowerCase().includes("from "))return[];const i=h()(a.match(/\[[^\]]*\]?(?:\.(?:\[[^\]]*\]?|\w*))*$/gim));if(i){const[e,a,s,l]=(i||"").split(".").map((e=>e.replace(/\[([^\]]*)\]?/,"$1"))),m=n?[n]:$(t);if("Measures"===e)return(({cubes:e,textModel:o,formatMessage:n})=>e.reduce(((e,{name:o,measures:n})=>(e.push(...(null==n?void 0:n.map((({name:e})=>w({label:{label:e,description:o}}))))||[]),e)),x(o.getValue()).map(((e="")=>w({label:{label:e,description:n({id:"aui.mdxEditor.autoCompletion.calculatedMeasure"})}})))||[]))({cubes:m,textModel:o,formatMessage:r});if(void 0===a)return(({cubes:e})=>[w({kind:u.languages.CompletionItemKind.Unit,label:"Measures",preselect:!0}),...e.reduce(((e,{name:o,dimensions:n})=>(e.push(...n.map((({name:e})=>w({label:{label:e,description:o}})))),e)),[])])({cubes:m});if(void 0===s)return(({cubes:e,dimensionName:o})=>e.reduce(((e,{name:n,dimensions:t})=>{var r,a;return e.push(...(null===(r=t.find((({name:e})=>e===o)))||void 0===r||null===(a=r.hierarchies)||void 0===a?void 0:a.map((({name:e})=>w({label:{label:e,description:`${n}/${o}`}}))))||[]),e}),[]))({cubes:m,dimensionName:e});if(void 0===l)return(({cubes:e,dimensionName:o,hierarchyName:n})=>[w({label:{label:"AllMember",description:`${o}/${n}`},preselect:!0}),...e.reduce(((e,{name:t,dimensions:r})=>{var a,i,s;return e.push(...(null===(a=r.find((({name:e})=>e===o)))||void 0===a||null===(i=a.hierarchies.find((({name:e})=>e===n)))||void 0===i||null===(s=i.levels)||void 0===s?void 0:s.map((({name:e})=>w({label:{label:e,description:`${t}/${o}/${n}`}}))))||[]),e}),[])])({cubes:m,dimensionName:e,hierarchyName:a});const c="ALL"===s?[w({label:{label:"AllMember",description:`${e}/${a}`},preselect:!0})]:[];return c.push(...d.vV.map((e=>w({label:e,kind:u.languages.CompletionItemKind.Property,sortText:"zzz"})))),c}return[]}},C={getSuggestions:({position:e,textModel:o,cube:n,dataModel:t})=>{var r;return null!==y(o,e,1).match(new RegExp(`(${d.kh.join("|")})[(][^)]*`,"i"))?null===(r=n?[n]:$(t))||void 0===r?void 0:r.reduce(((e,{name:o,kpis:n})=>(e.push(...(null==n?void 0:n.map((({name:e})=>w({kind:u.languages.CompletionItemKind.Event,label:{label:e,description:o}}))))||[]),e)),[]):[]}},E={getSuggestions:({position:e,textModel:o})=>null!==y(o,e).match(/(\bON\b\s*)([\w]*)$/i)?d.OD.map((e=>w({label:e}))):[]},A={getSuggestions:({position:e,textModel:o,cube:n,dataModel:t})=>{var r;const a=y(o,e).match(/(FROM\s+)(\[)([^\]]*)(?<CB>\])*/i);return null!==a&&void 0===(null===(r=a.groups)||void 0===r?void 0:r.CB)?(n?[n]:$(t)).map((({name:e})=>w({kind:u.languages.CompletionItemKind.Interface,label:e}))):[]}},K=({position:e,textModel:o,cube:n,dataModel:t,formatMessage:r})=>{const a=[A,E,N,C].reduce(((a,{getSuggestions:i})=>[...a,...i({position:e,textModel:o,cube:n,dataModel:t,formatMessage:r})]),[]);return a.length>0?a:[...[...d.Qp,...d.kh,...d.vV,...d.z4].map((e=>w({kind:u.languages.CompletionItemKind.Function,label:e}))),...[...d.OD].map((e=>w({kind:u.languages.CompletionItemKind.EnumMember,label:e}))),...[...d.c9,...d.wQ].map((e=>w({kind:u.languages.CompletionItemKind.Operator,label:e}))),...[...d.S3,...d.ql].map((e=>w({kind:u.languages.CompletionItemKind.Keyword,label:e})))]},P={id:"dark-theme",data:{base:"vs-dark",inherit:!0,rules:[{token:"identifier.delimited",foreground:"#9f9f9f"},{token:"identifier.regular",foreground:"#9d9d9d"},{token:"keyword.structural",foreground:"#c792ea"},{token:"keyword.axis",foreground:"#c792ea"},{token:"keyword.function",foreground:"#82aaff"},{token:"keyword.kpi",foreground:"#82aaff"},{token:"keyword.memberProperty",foreground:"#82aaff"},{token:"keyword.argument",foreground:"#addb67"},{token:"keyword.booleanOperator",foreground:"#397800"},{token:"keyword.cellProperty",foreground:"#397800"},{token:"boolean",foreground:"#addb67"},{token:"number",foreground:"#ff901e"},{token:"operator",foreground:"#ff8000"},{token:"comment",foreground:"#aa5500"}],colors:{"editor.foreground":"#d6deeb","editor.background":"#011627","editor.selectionBackground":"#5f7e9779","editor.lineHighlightBackground":"#010E17","editorCursor.foreground":"#80a4c2","editorWhitespace.foreground":"#2e2040","editorIndentGuide.background":"#5e81ce52","editor.selectionHighlightBorder":"#122d42"}}},I={id:"light-theme",data:{base:"vs",inherit:!0,rules:[{token:"identifier.delimited",foreground:"#1b1a1a"},{token:"identifier.regular",foreground:"#5a5a5a"},{token:"keyword.structural",foreground:"#3399ff"},{token:"keyword.axis",foreground:"#3399ff"},{token:"keyword.function",foreground:"#59bb00"},{token:"keyword.kpi",foreground:"#59bb00"},{token:"keyword.memberProperty",foreground:"#59bb00"},{token:"keyword.argument",foreground:"#ff901e"},{token:"keyword.booleaOperator",foreground:"#397800"},{token:"keyword.cellProperty",foreground:"#397800"},{token:"boolean",foreground:"#ff901e"},{token:"number",foreground:"#ff901e"},{token:"operator",foreground:"#ff8000"},{token:"comment",foreground:"#aa5500"}],colors:{}}},D=e=>c()(f()(null==e?void 0:e.catalogs,"cubes")),L=e=>c()(f()(e,"measures")),R=e=>c()(f()(e,"dimensions")),q=(e,o)=>{var n,t;return null!==(n=null===(t=v()(R(e),["name",o]))||void 0===t?void 0:t.hierarchies)&&void 0!==n?n:[]},O="#faad14",S=({classNames:e={},textModel:o,offset:n,options:t={},length:r,type:a})=>{const i={error:{color:"red",className:e.line_error,position:4,zIndex:10},warning:{color:O,className:e.line_warning,position:1,zIndex:1}};return{range:u.Range.fromPositions(o.getPositionAt(n),o.getPositionAt(n+r)),options:{overviewRuler:{color:i[a].color,position:i[a].position},inlineClassName:i[a].className,zIndex:i[a].zIndex,...t}}},V=(e="",o=[])=>o.reduce(((o,n)=>{const t=((e="",o="")=>{if(e.length<2||o.length<2)return 0;const n=new Map;for(let o=0;o<e.length-1;o++){var t;const r=e.substr(o,2);n.set(r,null!==(t=n.get(r))&&void 0!==t?t:1)}let r=0;for(let e=0;e<o.length-1;e++){var a;const t=o.substr(e,2),i=null!==(a=n.get(t))&&void 0!==a?a:0;i>0&&(n.set(t,i-1),r++)}return 2*r/(e.length+o.length-2)})(n,e);return o.coefficient<t?{hint:n,coefficient:t}:o}),{hint:"",coefficient:0}),j=({header:e="",body:o="",hint:n={coefficient:0,hint:""},formatMessage:t=(()=>"")})=>{const r=[{value:`#### **${e}**`}];return n.coefficient>.65&&r.push({value:`${t({id:"aui.mdxEditor.hover.didYouMean"})}: ***${n.hint}?***`,isTrusted:!0}),r.push({value:o}),r},F={getDecorations:({textModel:e,mdxErrorDetails:o,classNames:n,formatMessage:t=(()=>"")})=>{var r,a;if(!o)return[];const i=((e,o)=>{const n=u.editor.createModel(e);try{if(o.from.ch>=0){const e=n.getValueInRange(new u.Range(o.from.line+1,o.from.ch,o.to.line+1,n.getLineLastNonWhitespaceColumn(o.to.line+1))),t=e.length-e.trimLeft().length;return new u.Range(o.from.line+1,o.from.ch+t,o.to.line+1,o.to.ch+t)}return new u.Range(o.from.line,n.getLineLastNonWhitespaceColumn(o.from.line),o.to.line+1,n.getLineFirstNonWhitespaceColumn(o.to.line+1)+o.text.length)}catch{return new u.Range(0,0,0,0)}})(e.getValue(),o),s=e.getOffsetAt(i.getStartPosition());return[S({type:"error",classNames:n,textModel:e,offset:s,length:e.getOffsetAt(i.getEndPosition())-s,options:{hoverMessage:j({header:`${t({id:"aui.mdxEditor.hover.errorOnLine"})} ***${i.startLineNumber}***`,body:`${t({id:"aui.mdxEditor.hover.availableOptionsAre"})} : \n${null===(r=o.expected)||void 0===r?void 0:r.map((e=>`- ${e}`)).join("\n")}`,hint:V(o.text,null===(a=o.expected)||void 0===a?void 0:a.map((e=>e.replace(/'/g,"")))),formatMessage:t})}})]}},z={getDecorations:({textModel:e,classNames:o,formatMessage:n=(()=>"")})=>{const t=e.getValue().matchAll(/(?<function>\w+)\(/gi),r=[...d.Qp,...d.kh],a=[];for(const d of t){var i,s,l,u,m;d.index&&!["FROM",...r].map((e=>e.toLowerCase())).includes((null!==(i=null===(s=d.groups)||void 0===s?void 0:s.function)&&void 0!==i?i:"").toLowerCase())&&a.push(S({type:"warning",classNames:o,textModel:e,offset:d.index,length:null===(l=d[0])||void 0===l?void 0:l.length,options:{hoverMessage:j({header:`${n({id:"aui.mdxEditor.hover.unkownFunction"})} ***${null===(u=d.groups)||void 0===u?void 0:u.function}***`,body:`${n({id:"aui.mdxEditor.hover.availableFunctionsAre"})} : \n${r.map((e=>`- ${e}`)).join("\n")}`,hint:V(null===(m=d.groups)||void 0===m?void 0:m.function,r),formatMessage:n})}}))}return a}},_={getDecorations:({textModel:e,cube:o,dataModel:n,classNames:t,formatMessage:r=(()=>"")})=>{if(!n&&!o)return[];const a=e.getValue().matchAll(/(?:FROM\s+)(?:([(])|\[([^\]]*)\]?|(\w*))/gi),i=o?[o.name]:D(n).map((({name:e})=>e)),s=[];for(const o of a){var d;if("("===o[1])continue;const n=null!==(d=o[2])&&void 0!==d?d:o[3];var l;o.index&&!i.includes(n)&&s.push(S({type:"error",classNames:t,textModel:e,offset:o.index,length:null===(l=o[0])||void 0===l?void 0:l.length,options:{hoverMessage:j({header:`${r({id:"aui.mdxEditor.hover.cubeNotFound"})} ***${n}***`,body:`${r({id:"aui.mdxEditor.hover.availableCubesAre"})} : \n${i.map((e=>`- ${e}`)).join("\n")}`,hint:V(n,i),formatMessage:r})}}))}return s}},H={getDecorations:({textModel:e,cube:o,dataModel:n,classNames:t,formatMessage:r=(()=>"")})=>{if(!n&&!o)return[];const a=e.getValue().matchAll(/(\[(?<dimensionName>[^\]]*)\]?)(?<dotAfterDimension>\s*\.\s*)?((?:(\[(?<quotedHierarchy>[^\]]*)\]?)|(?<unquotedHierarchy>\w*)))?(?<dotAfterHierarchy>\s*\.\s*)?(?<memberPath>.*)?/gim),i=[];for(const u of a){var s;if(!u.index)continue;const{dimensionName:a,dotAfterDimension:m,quotedHierarchy:c,unquotedHierarchy:g}=u.groups||{},f=e.getPositionAt(u.index);if("Measures"===a||["from ","member "].some((o=>e.getValueInRange({startLineNumber:f.lineNumber,endLineNumber:f.lineNumber,startColumn:0,endColumn:f.column}).toLowerCase().includes(o))))continue;const p=o?[o]:D(n),h=R(p).map((({name:e})=>e));if(!h.includes(a)){var d;i.push(S({type:"warning",classNames:t,textModel:e,offset:u.index,length:null===(d=u[0])||void 0===d?void 0:d.length,options:{hoverMessage:j({header:`${r({id:"aui.mdxEditor.hover.dimensionNotFound"})} ***${a}***`,body:`${r({id:"aui.mdxEditor.hover.availableDimensionsAre"})} : \n${h.map((e=>`- ${e}`)).join("\n")}`,hint:V(a,h),formatMessage:r})}}));continue}const b=null!==(s=c||g)&&void 0!==s?s:"";if(m){const o=q(p,a).map((({name:e})=>e));if(!o.includes(b)){var l;i.push(S({type:"warning",classNames:t,textModel:e,offset:u.index,length:null===(l=u[0])||void 0===l?void 0:l.length,options:{hoverMessage:j({header:r({id:"aui.mdxEditor.hover.hierarchyWarning"},{dimensionName:a,hierarchyName:b}),body:`${r({id:"aui.mdxEditor.hover.availableHierarchiesAre"},{dimensionName:a,hierarchyName:b})} : \n${o.map((e=>`- ${e}`)).join("\n")}`,hint:V(b,o),formatMessage:r})}}));continue}}}return i}},T={getDecorations:({textModel:e,dataModel:o,classNames:n,formatMessage:t=(()=>"")})=>{var r;if(!o)return[];const a=e.getValue().matchAll(new RegExp(`(${d.kh.join("|")})[(][^]*?"(?<kpi>.*)"[^]*?[)]`,"gim")),i=null===(r=D(o))||void 0===r?void 0:r.reduce(((e,{kpis:o})=>(e.push(...(null==o?void 0:o.map((({name:e})=>e)))||[]),e)),[]),s=[];for(const o of a){var l,u;const r=null!==(l=null===(u=o.groups)||void 0===u?void 0:u.kpi)&&void 0!==l?l:"";var m;o.index&&!i.includes(r)&&s.push(S({type:"warning",classNames:n,textModel:e,offset:o.index,length:null===(m=o[0])||void 0===m?void 0:m.length,options:{hoverMessage:j({header:`${t({id:"aui.mdxEditor.hover.invalidKPI"})} ***${r}***`,body:`${t({id:"aui.mdxEditor.hover.availableKPIsAre"})} : \n${i.map((e=>`- ${e}`)).join("\n")}`,hint:V(r,i),formatMessage:t})}}))}return s}},Q={getDecorations:({textModel:e,cube:o,dataModel:n,classNames:t,formatMessage:r=(()=>"")})=>{if(!n)return[];const a=e.getValue().matchAll(/(\[Measures]).(?:(\[(?<quotedMeasure>.*)\])|(?<unquotedMeasure>\w*))/gi),i=o?[o]:D(n),s=[...L(i).map((({name:e})=>e)),...x(e.getValue())],d=[];for(const o of a){var l;const{groups:{unquotedMeasure:n,quotedMeasure:a}={unquotedMeasure:void 0,quotedMeasure:void 0}}=o||{},i=null!==(l=null!=n?n:a)&&void 0!==l?l:" ";if(o.index&&!s.includes(i)){var u;const n=e.getPositionAt(o.index);if(["from","member"].some((o=>e.getValueInRange({startLineNumber:n.lineNumber,endLineNumber:n.lineNumber,startColumn:0,endColumn:n.column}).toLowerCase().includes(o))))continue;d.push(S({type:"warning",classNames:t,textModel:e,offset:o.index,length:null===(u=o[0])||void 0===u?void 0:u.length,options:{hoverMessage:j({header:`${r({id:"aui.mdxEditor.hover.invalidMeasure"})} **${i}**`,body:`${r({id:"aui.mdxEditor.hover.availableMeasuresAre"})} : \n${s.map((e=>`- ${e}`)).join("\n")}`,hint:V(i,s),formatMessage:r})}}))}}return d}},B=e=>`background-image:\n     linear-gradient(45deg, transparent 65%, ${e} 80%, transparent 90%),\n     linear-gradient(135deg, transparent 5%, ${e} 15%, transparent 25%),\n     linear-gradient(135deg, transparent 45%, ${e} 55%, transparent 65%),\n     linear-gradient(45deg, transparent 25%, ${e} 35%, transparent 50%);\n     background-repeat:repeat-x;\n     background-size: 8px 2px;\n     background-position:0 95%;`,W={line_error:B("red"),line_warning:B(O)},U=()=>{},G=(0,r.forwardRef)((({value:e,cube:o,dataModel:n,classNames:t={},onChange:m=U},c)=>{const{formatMessage:g}=(0,i.useIntl)(),[f,p]=(0,r.useState)(),[h,b]=(0,r.useState)(),v=(0,r.useMemo)((()=>({tabSize:2})),[]),x=(0,r.useMemo)((()=>((e,o,n=(({id:e})=>`${e}`))=>({triggerCharacters:["[","."],provideCompletionItems:(t,r,a,i)=>{if(!i.isCancellationRequested)return{suggestions:K({position:r,textModel:t,cube:e,dataModel:o,formatMessage:n})}}}))(o,n,g)),[o,n,g]),y=(0,r.useMemo)((()=>(({value:e,mdxErrorDetails:o,cube:n,dataModel:t,classNames:r,formatMessage:a})=>{if(!e)return[];const i=u.editor.createModel(e);return[F,_,Q,H,T,z].reduce(((e,{getDecorations:s})=>[...e,...s({textModel:i,mdxErrorDetails:o,cube:n,dataModel:t,classNames:r,formatMessage:a})]),[])})({value:e,dataModel:n,mdxErrorDetails:h,classNames:t,formatMessage:g})),[e,h,n,t,g]),w=(0,s.Fg)();return(0,r.useEffect)((()=>{p(w.isDark?P:I)}),[w.isDark]),(0,r.useEffect)((()=>{try{e&&(0,d.Qc)(e),b(void 0)}catch(e){if(!(e instanceof d.wb))throw e;b(e.details)}}),[e]),(0,a.jsx)(l.default,{ref:c,value:e,onChange:m,language:k,theme:f,options:v,documentFormattingEditProvider:M,completionItemProvider:x,deltaDecorations:y})})),Y=(0,r.forwardRef)(((e,o)=>(0,a.jsx)(a.ClassNames,null,(({css:n})=>(0,a.jsx)(G,(0,t.Z)({},e,{ref:o,classNames:{line_error:n(W.line_error),line_warning:n(W.line_warning)}}))))))}}]);