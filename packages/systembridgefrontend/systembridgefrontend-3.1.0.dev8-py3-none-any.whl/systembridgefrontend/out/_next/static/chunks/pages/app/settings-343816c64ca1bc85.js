(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{4768:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/settings",function(){return t(8438)}])},8438:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return U}});var r=t(5893),i=t(7294),o=t(9520),a=t(2315),c=t(4051),l=t.n(c),s=t(2734),u=t(6886),d=t(8456),p=t(1163),f=t(5317),y=t(7262),h=t(9375),g=t(5934),m=t(9875),v=t(796),x=t(9953),b=t(3395),j=t(9653),Z=t(4054),w=t(7709),P=t(7109),S=t(3946),k=t(5545),C=t(5301),O=t(8849);function I(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var A=function(e){var n=e.keyIn,t=e.valueIn,o=e.handleChanged,a=function(e){A(e)},c=function(e){a(e.target.value)},l=(0,i.useState)(!1),d=l[0],p=l[1],y=(0,i.useState)(t),h=y[0],A=y[1],_=(0,i.useMemo)((function(){return t!==h}),[t,h]),E=F[n],N=E.name,T=E.description,z=E.icon,D=E.containerDisabled,G=E.isPassword,R=E.minimum,W=(0,s.Z)();return(0,r.jsxs)(m.ZP,{children:[(0,r.jsx)(v.Z,{children:(0,r.jsx)(O.Icon,{id:"icon",title:N,size:1,path:z})}),(0,r.jsx)(x.Z,{style:{maxWidth:"64%"},primary:N,secondary:T,sx:{userSelect:"none"}}),(0,r.jsx)(b.Z,{sx:{width:420,textAlign:"end"},children:(0,r.jsxs)(u.ZP,{container:!0,alignItems:"center",justifyContent:"flex-end",children:[(0,r.jsx)(u.ZP,{item:!0,children:"boolean"===typeof h?(0,r.jsx)(j.Z,{edge:"end",disabled:D,checked:h,onChange:function(e,n){a(n)}}):"string"===typeof h&&"api_key"===n?(0,r.jsx)(Z.Z,{fullWidth:!0,variant:"outlined",children:(0,r.jsx)(w.Z,{type:"text",disabled:!0,value:h,endAdornment:(0,r.jsxs)(P.Z,{position:"end",children:[(0,r.jsx)(S.Z,{"aria-label":"Generate Api Key",onClick:function(){a((0,g.Z)())},edge:"end",size:"large",sx:{margin:W.spacing(-1,-.5)},children:(0,r.jsx)(O.Icon,{id:"generate-api-key",title:"Generate API Key",size:1,path:f.VmU})}),(0,r.jsx)(S.Z,{"aria-label":"Copy to clipboard",onClick:function(){return e=h,void navigator.permissions.query({name:"clipboard-write"}).then((function(n){"granted"!==n.state&&"prompt"!==n.state||navigator.clipboard.writeText(e)}));var e},size:"large",sx:{margin:W.spacing(-1,-.5)},children:(0,r.jsx)(O.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:f.a0Z})})]})})}):"string"===typeof h&&"log_level"===n?(0,r.jsx)(k.Z,{id:n,options:["DEBUG","INFO","WARNING","ERROR","CRITICAL"],renderInput:function(e){return(0,r.jsx)(C.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){I(e,n,t[n])}))}return e}({},e,{variant:"outlined"}))},onChange:function(e,n){n&&a(n)},sx:{width:210},value:h}):"string"===typeof h&&G?(0,r.jsx)(Z.Z,{variant:"outlined",children:(0,r.jsx)(w.Z,{type:d?"text":"password",defaultValue:h,onChange:c,endAdornment:(0,r.jsx)(P.Z,{position:"end",children:(0,r.jsx)(S.Z,{"aria-label":"Toggle visibility",onClick:function(){p(!d)},onMouseDown:function(e){e.preventDefault()},size:"large",children:(0,r.jsx)(O.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:d?f.rgx:f.DqW})})})})}):"string"===typeof h?(0,r.jsx)(C.Z,{type:"text",defaultValue:h,disabled:D,onChange:c,variant:"outlined"}):"number"===typeof h?(0,r.jsx)(C.Z,{error:!!R&&h<R,type:"number",disabled:D,inputProps:{minimum:R},defaultValue:h,onChange:c,variant:"outlined"}):""}),(0,r.jsx)(u.ZP,{item:!0,children:(0,r.jsx)(S.Z,{disabled:!1===_,onClick:function(){o(n,h)},sx:{margin:W.spacing(1)},children:(0,r.jsx)(O.Icon,{id:"save",title:"Save",size:1,path:f.JTj,style:{opacity:_?1:.25}})})})]})})]})},_=t(5861),E=t(5113),N=t(8462);var T,z=function(e){var n=e.name,t=e.description,i=e.children;return(0,r.jsxs)(u.ZP,{container:!0,direction:"row",item:!0,xs:12,children:[(0,r.jsxs)(u.ZP,{item:!0,xs:4,style:{userSelect:"none"},children:[(0,r.jsx)(_.Z,{component:"h3",variant:"h5",children:n}),(0,r.jsx)(_.Z,{variant:"subtitle1",children:t})]}),(0,r.jsx)(u.ZP,{item:!0,xs:8,children:(0,r.jsx)(E.Z,{children:(0,r.jsx)(N.Z,{children:i})})})]})};function D(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function G(e,n,t,r,i,o,a){try{var c=e[o](a),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function R(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function W(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(l){c=!0,i=l}finally{try{a||null==t.return||t.return()}finally{if(c)throw i}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return D(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return D(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var F={autostart:{name:"Autostart",description:"Automatically start the application on startup",icon:f.USr},log_level:{name:"Log Level",description:"Log level for the application",icon:f.eLz},port_api:{name:"API Port",description:"Port for the API and WebSocket",icon:f.A0p}};var L=function(){var e=W((0,y.r)(),2),n=e[0],t=e[1],o=(0,i.useState)(!1),a=o[0],c=o[1],f=(0,p.useRouter)().query,g=(0,i.useCallback)((function(e){if(console.log("Event:",e),"SETTINGS_RESULT"===e.type){console.log("Settings result:",e.data);var n={};console.log("settingsMap:",F);var r=Object.keys(F);e.data.sort((function(e,n){return r.indexOf(e.key)>r.indexOf(n.key)?1:-1})).forEach((function(e){"boolean"===typeof e.value||Number.isNaN(Number(e.value))?"True"===e.value||"False"===e.value?n[e.key]="True"===e.value:n[e.key]=e.value:n[e.key]=Number(e.value)})),console.log("Settings:",n),t(n)}}),[t]),m=(0,i.useCallback)((function(e,n){var t;console.log("Setup WebSocketConnection"),T=new h.C(e,n,(t=l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T.getSettings();case 1:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){G(o,r,i,a,c,"next",e)}function c(e){G(o,r,i,a,c,"throw",e)}a(void 0)}))})),T.onEvent=g}),[g]),v=(0,i.useCallback)((function(e,r){T.updateSetting(e,r),t(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){R(e,n,t[n])}))}return e}({},n,R({},e,r)))}),[n,t]);(0,i.useEffect)((function(){!a&&f&&f.apiKey&&(c(!0),m(Number(f.apiPort)||9170,String(f.apiKey)))}),[a,m,f]);var x=(0,s.Z)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(u.ZP,{container:!0,direction:"column",spacing:2,alignItems:"stretch",sx:{marginBottom:x.spacing(8),padding:x.spacing(2)},children:n?(0,r.jsx)(z,{name:"General",description:"General settings",children:(0,r.jsx)(r.Fragment,{children:Object.keys(n).map((function(e,t){return(0,r.jsx)(A,{keyIn:e,valueIn:n[e],handleChanged:v},t)}))})}):(0,r.jsx)(u.ZP,{container:!0,direction:"row",justifyContent:"center",sx:{margin:x.spacing(2,0,10)},children:(0,r.jsx)(d.Z,{})})})})};var U=function(){return(0,r.jsx)(a.Z,{title:"Settings",url:"https://system-bridge.timmo.dev",description:"Frontend for System Bridge",noHeader:!0,noFooter:!0,children:(0,r.jsx)(o.Z,{component:"article",maxWidth:"xl",children:(0,r.jsx)(L,{})})})}}},function(e){e.O(0,[702,740,524,301,545,257,807,471,774,888,179],(function(){return n=4768,e(e.s=n);var n}));var n=e.O();_N_E=n}]);