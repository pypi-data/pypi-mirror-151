var k=Object.defineProperty,D=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var b=(t,e,i)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,w=(t,e)=>{for(var i in e||(e={}))P.call(e,i)&&b(t,i,e[i]);if(v)for(var i of v(e))T.call(e,i)&&b(t,i,e[i]);return t},S=(t,e)=>D(t,I(e));import{ad as o,ae as W,af as M,ag as B,ah as L,c as A,ai as R,aj as y,ak as H,al as q,am as O,an as j,ao as G,ap as N,aq as z,ar as E,as as d,at as F,_ as Y,y as V,o as l,h as u,l as $,H as _,p as g,au as p,F as X,av as J,X as m}from"./index.435faa1e.js";var K=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,U=(t,e,i,a)=>{for(var s=a>1?void 0:a?Q(e,i):e,n=t.length-1,r;n>=0;n--)(r=t[n])&&(s=(a?r(e,i,s):r(s))||s);return a&&s&&K(e,i,s),s};const Z=o(".%L"),tt=o("%-I:%M:%S %p"),et=o("%-I:%M %p"),it=o("%-I %p"),st=o("%a %d"),at=o("%b %d"),rt=o("%B"),nt=o("%Y"),ht=t=>(q(t)<t?Z:O(t)<t?tt:j(t)<t?et:G(t)<t?it:N(t)<t?z(t)<t?st:at:E(t)<t?rt:nt)(t);class ot{constructor(){this.axisPosition=d({required:!1,default:"bottom"}),this.backgroundColor=d({required:!1,default:null}),this.items=d({required:!0}),this.maxEndTime=d({required:!1,default:null}),this.hideHeader=d({required:!1,default:()=>!1,type:Boolean}),this.padding=d({required:!1,default:{top:0,bottom:0,middle:0,left:0,right:0}})}}let x=class extends W(M).with(ot){constructor(){super(...arguments),this.disableLeftScrollButton=!0,this.disableRightScrollButton=!0,this.computedItems=[],this.axisHeight=this.hideHeader?20:38,this.intervalHeight=20,this.intervalWidth=125,this.xScale=B(),this.yScale=L(),this.rows=[],this.scrollContainer=A(),this.axisSvg=null,this.gridSelection=null,this.xAxisGroup=null,this.backgroundRect=null,this.xAxis=t=>t.transition().duration(250).attr("class","x-axis").call(R(this.xScale).ticks(this.numberIntervals).tickFormat(ht).tickSizeOuter(0).tickSizeInner(0))}get interval(){return Object.entries(y).sort(([,t],[,e])=>e-t).reduce(([t,e],[i,a])=>this.totalSeconds<a?[i,a]:[t,e])[0]}get numberIntervals(){return Math.ceil(Math.max(this.totalSeconds/y[this.interval],this.width/this.intervalWidth)/this.intervalWidth)*this.intervalWidth}get numberRows(){return Math.max(this.rows.length,Math.ceil(this.height/this.intervalHeight))}get start(){return new Date(new Date(Math.min(...this.sortedItems.map(t=>new Date(t.start_time).getTime()))).getTime())}get end(){return new Date(this.maxEndTime?this.maxEndTime:new Date(Math.max(...this.sortedItems.map(t=>t.end_time?new Date(t.end_time).getTime():Date.now()))).getTime())}get totalSeconds(){return this.end.getTime()/1e3-this.start.getTime()/1e3}get chartHeight(){return this.container?this.numberRows*this.intervalHeight-this.paddingY:0}get chartWidth(){return Math.max(this.numberIntervals*this.intervalWidth,this.width)-this.paddingY}get sortedItems(){return this.items.sort((t,e)=>new Date(t.start_time).getTime()-new Date(e.start_time).getTime()).filter(t=>t.state_type!=="PENDING"&&t.start_time)}get nodeContainerStyle(){return{height:`${this.chartHeight}px`,width:`${this.chartWidth}px`}}get timelineAxisPosition(){return!this.container||this.axisPosition=="top"?{height:`${this.axisHeight}px`}:{height:`${this.axisHeight}px`,top:`${this.container.offsetHeight-this.axisHeight/2}px`}}resize(){this.update()}mounted(){this.createChart(),this.update(),this.handleScroll()}update(){var t;!((t=this.items)!=null&&t.length)||requestAnimationFrame(()=>{this.updateChart(),this.updateScales(),this.updateNodes(),this.updateGrid()})}updated(){(!this.svg||!this.gridSelection)&&this.createChart()}updateScales(){this.xScale.domain([new Date(this.start),new Date(this.end)]).range([0,this.chartWidth]).clamp(!0),this.xAxisGroup.call(this.xAxis)}createChart(){this.svg=H(`#${this.id}`),this.axisSvg=H(`#${this.id}-axis`),this.xAxisGroup=this.axisSvg.append("g"),this.backgroundRect=this.svg.append("g"),this.backgroundRect.append("rect").attr("fill",this.backgroundColor?`var(--${this.backgroundColor})`:"transparent").attr("rx",4).attr("width","100%").attr("height","100%"),this.gridSelection=this.svg.append("g")}updateChart(){this.svg.attr("viewbox",`0, 0, ${this.chartWidth}, ${this.chartHeight}`).style("width",`${this.chartWidth}px`).style("height",`${this.chartHeight}px`),this.axisSvg.attr("viewbox",`0, 0, ${this.chartWidth}, ${this.axisHeight}`).style("width",`${this.chartWidth}px`).style("height",`${this.axisHeight}px`)}updateNodes(){const t=[];this.computedItems=[...this.sortedItems].map(e=>{const i=new Date(e.start_time),a=e.end_time?new Date(e.end_time):new Date,s=this.xScale(i),n=Math.max(16,this.xScale(a)-this.xScale(i)),r=8,h=this.axisPosition=="top"?r+this.axisHeight:r;let c=0;for(;;){const f=t[c];if(f){const[,C]=f;if(s>C){t[c][1]=s+n;break}else{c++;continue}}else{t[c]=[s,s+n];break}}return S(w({},e),{style:{height:`${8}px`,left:`${s}px`,top:`${c*this.intervalHeight}px`,transform:`translate(0, ${h}px)`,width:`${n}px`}})}),this.rows=t}updateGrid(){this.gridSelection.selectAll(".grid-line.grid-x").data(Array.from({length:this.numberRows})).join(t=>t.append("line").attr("id",(e,i)=>`grid-line-x-${i}`).attr("class","grid-line grid-x").attr("stroke","var(--blue-20)").attr("x1",0).attr("x2",this.chartWidth).attr("y1",(e,i)=>i*this.intervalHeight).attr("y2",(e,i)=>i*this.intervalHeight),t=>t.attr("x1",0).attr("x2",this.chartWidth).attr("y1",(e,i)=>i*this.intervalHeight).attr("y2",(e,i)=>i*this.intervalHeight),t=>t.remove()),this.gridSelection.selectAll(".grid-line.grid-y").data(this.xScale.ticks(this.numberIntervals)).join(t=>t.append("line").attr("id",(e,i)=>`x-${i}`).attr("class","grid-line grid-y").attr("stroke","var(--blue-20)").attr("x1",(e,i)=>this.xScale(e)).attr("x2",(e,i)=>this.xScale(e)).attr("y1",0).attr("y2",this.chartHeight),t=>t.attr("x1",(e,i)=>this.xScale(e)).attr("x2",(e,i)=>this.xScale(e)).attr("y1",0).attr("y2",this.chartHeight),t=>t.remove())}handleScroll(){this.disableLeftScrollButton=this.scrollContainer.scrollLeft<=0,this.disableRightScrollButton=this.scrollContainer.scrollLeft>=this.scrollContainer.scrollWidth}panLeft(){this.scrollContainer.scroll({left:this.scrollContainer.scrollLeft-this.width,behavior:"smooth"})}panRight(){this.scrollContainer.scroll({left:this.scrollContainer.scrollLeft+this.width,behavior:"smooth"})}};x=U([F({watch:{items(){this.update()},interval(){this.update()}}})],x);const lt=x,dt=["id"],ct=["id"],ut=["id"];function gt(t,e,i,a,s,n){const r=V("m-icon-button");return l(),u("div",{ref:"container",class:m(["component-container timeline d-flex flex-column",{"header-hidden":t.hideHeader,"header-visible":!t.hideHeader,"axis-bottom":t.axisPosition=="bottom","axis-top":t.axisPosition=="top"}]),style:{"max-height":"inherit"}},[t.hideHeader?_("",!0):(l(),$(r,{key:0,class:"pan-button left bg--white",icon:"pi pi-arrow-left-s-line pi-lg",flat:"",disabled:t.disableLeftScrollButton,onClick:t.panLeft},null,8,["disabled","onClick"])),t.hideHeader?_("",!0):(l(),$(r,{key:1,class:"pan-button right bg--white",icon:"pi pi-arrow-right-s-line pi-lg",flat:"",disabled:t.disableRightScrollButton,onClick:t.panRight},null,8,["disabled","onClick"])),g("div",{ref:"scrollContainer",class:"scroll-container",onScroll:e[0]||(e[0]=(...h)=>t.handleScroll&&t.handleScroll(...h))},[g("div",{class:"node-container",style:p(t.nodeContainerStyle)},[(l(!0),u(X,null,J(t.computedItems,h=>(l(),u("div",{id:`node-${h.id}`,key:h.id,class:m(["node correct-text",[`${h.state.type.toLowerCase()}-bg`]]),style:p(h.style),tabindex:"0"},null,14,dt))),128)),g("div",{class:m(["timeline-axis",{"shadow-sm":t.axisPosition=="top"}]),style:p(t.timelineAxisPosition)},[(l(),u("svg",{id:`${t.id}-axis`,ref:"chart-axis"},null,8,ct))],6),(l(),u("svg",{id:t.id,class:"timeline-background"},null,8,ut))],4)],544),g("div",{class:m(["border-container",{top:t.axisPosition=="top",bottom:t.axisPosition=="bottom"}])},null,2)],2)}var xt=Y(lt,[["render",gt],["__scopeId","data-v-689e583e"]]);export{xt as T};
