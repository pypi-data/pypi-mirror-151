(()=>{var A,d,z,se,C,G,J,ie,P={},X=[],ue=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function k(t,e){for(var n in e)t[n]=e[n];return t}function K(t){var e=t.parentNode;e&&e.removeChild(t)}function m(t,e,n){var l,_,o,u={};for(o in e)o=="key"?l=e[o]:o=="ref"?_=e[o]:u[o]=e[o];if(arguments.length>2&&(u.children=arguments.length>3?A.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)u[o]===void 0&&(u[o]=t.defaultProps[o]);return I(t,u,l,_,null)}function I(t,e,n,l,_){var o={type:t,props:e,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:_??++z};return _==null&&d.vnode!=null&&d.vnode(o),o}function B(t){return t.children}function x(t,e){this.props=t,this.context=e}function S(t,e){if(e==null)return t.__?S(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?S(t):null}function Q(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Q(t)}}function $(t){(!t.__d&&(t.__d=!0)&&C.push(t)&&!D.__r++||J!==d.debounceRendering)&&((J=d.debounceRendering)||G)(D)}function D(){for(var t;D.__r=C.length;)t=C.sort(function(e,n){return e.__v.__b-n.__v.__b}),C=[],t.some(function(e){var n,l,_,o,u,i;e.__d&&(u=(o=(n=e).__v).__e,(i=n.__P)&&(l=[],(_=k({},o)).__v=o.__v+1,L(i,o,_,n.__n,i.ownerSVGElement!==void 0,o.__h!=null?[u]:null,l,u??S(o),o.__h),te(l,o),o.__e!=u&&Q(o)))})}function Y(t,e,n,l,_,o,u,i,a,f){var r,h,c,s,p,w,y,v=l&&l.__k||X,g=v.length;for(n.__k=[],r=0;r<e.length;r++)if((s=n.__k[r]=(s=e[r])==null||typeof s=="boolean"?null:typeof s=="string"||typeof s=="number"||typeof s=="bigint"?I(null,s,null,null,s):Array.isArray(s)?I(B,{children:s},null,null,null):s.__b>0?I(s.type,s.props,s.key,null,s.__v):s)!=null){if(s.__=n,s.__b=n.__b+1,(c=v[r])===null||c&&s.key==c.key&&s.type===c.type)v[r]=void 0;else for(h=0;h<g;h++){if((c=v[h])&&s.key==c.key&&s.type===c.type){v[h]=void 0;break}c=null}L(t,s,c=c||P,_,o,u,i,a,f),p=s.__e,(h=s.ref)&&c.ref!=h&&(y||(y=[]),c.ref&&y.push(c.ref,null,s),y.push(h,s.__c||p,s)),p!=null?(w==null&&(w=p),typeof s.type=="function"&&s.__k===c.__k?s.__d=a=Z(s,a,t):a=ee(t,s,c,v,p,a),typeof n.type=="function"&&(n.__d=a)):a&&c.__e==a&&a.parentNode!=t&&(a=S(c))}for(n.__e=w,r=g;r--;)v[r]!=null&&(typeof n.type=="function"&&v[r].__e!=null&&v[r].__e==n.__d&&(n.__d=S(l,r+1)),oe(v[r],v[r]));if(y)for(r=0;r<y.length;r++)ne(y[r],y[++r],y[++r])}function Z(t,e,n){for(var l,_=t.__k,o=0;_&&o<_.length;o++)(l=_[o])&&(l.__=t,e=typeof l.type=="function"?Z(l,e,n):ee(n,l,l,_,l.__e,e));return e}function ee(t,e,n,l,_,o){var u,i,a;if(e.__d!==void 0)u=e.__d,e.__d=void 0;else if(n==null||_!=o||_.parentNode==null)e:if(o==null||o.parentNode!==t)t.appendChild(_),u=null;else{for(i=o,a=0;(i=i.nextSibling)&&a<l.length;a+=2)if(i==_)break e;t.insertBefore(_,o),u=o}return u!==void 0?u:_.nextSibling}function ae(t,e,n,l,_){var o;for(o in n)o==="children"||o==="key"||o in e||T(t,o,null,n[o],l);for(o in e)_&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||n[o]===e[o]||T(t,o,e[o],n[o],l)}function q(t,e,n){e[0]==="-"?t.setProperty(e,n):t[e]=n==null?"":typeof n!="number"||ue.test(e)?n:n+"px"}function T(t,e,n,l,_){var o;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof l=="string"&&(t.style.cssText=l=""),l)for(e in l)n&&e in n||q(t.style,e,"");if(n)for(e in n)l&&n[e]===l[e]||q(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?l||t.addEventListener(e,o?j:V,o):t.removeEventListener(e,o?j:V,o);else if(e!=="dangerouslySetInnerHTML"){if(_)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,n):t.removeAttribute(e))}}function V(t){this.l[t.type+!1](d.event?d.event(t):t)}function j(t){this.l[t.type+!0](d.event?d.event(t):t)}function L(t,e,n,l,_,o,u,i,a){var f,r,h,c,s,p,w,y,v,g,N,b=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(a=n.__h,i=e.__e=n.__e,e.__h=null,o=[i]),(f=d.__b)&&f(e);try{e:if(typeof b=="function"){if(y=e.props,v=(f=b.contextType)&&l[f.__c],g=f?v?v.props.value:f.__:l,n.__c?w=(r=e.__c=n.__c).__=r.__E:("prototype"in b&&b.prototype.render?e.__c=r=new b(y,g):(e.__c=r=new x(y,g),r.constructor=b,r.render=pe),v&&v.sub(r),r.props=y,r.state||(r.state={}),r.context=g,r.__n=l,h=r.__d=!0,r.__h=[]),r.__s==null&&(r.__s=r.state),b.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=k({},r.__s)),k(r.__s,b.getDerivedStateFromProps(y,r.__s))),c=r.props,s=r.state,h)b.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(b.getDerivedStateFromProps==null&&y!==c&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(y,g),!r.__e&&r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(y,r.__s,g)===!1||e.__v===n.__v){r.props=y,r.state=r.__s,e.__v!==n.__v&&(r.__d=!1),r.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(E){E&&(E.__=e)}),r.__h.length&&u.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(y,r.__s,g),r.componentDidUpdate!=null&&r.__h.push(function(){r.componentDidUpdate(c,s,p)})}r.context=g,r.props=y,r.state=r.__s,(f=d.__r)&&f(e),r.__d=!1,r.__v=e,r.__P=t,f=r.render(r.props,r.state,r.context),r.state=r.__s,r.getChildContext!=null&&(l=k(k({},l),r.getChildContext())),h||r.getSnapshotBeforeUpdate==null||(p=r.getSnapshotBeforeUpdate(c,s)),N=f!=null&&f.type===B&&f.key==null?f.props.children:f,Y(t,Array.isArray(N)?N:[N],e,n,l,_,o,u,i,a),r.base=e.__e,e.__h=null,r.__h.length&&u.push(r),w&&(r.__E=r.__=null),r.__e=!1}else o==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=ce(n.__e,e,n,l,_,o,u,a);(f=d.diffed)&&f(e)}catch(E){e.__v=null,(a||o!=null)&&(e.__e=i,e.__h=!!a,o[o.indexOf(i)]=null),d.__e(E,e,n)}}function te(t,e){d.__c&&d.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(l){l.call(n)})}catch(l){d.__e(l,n.__v)}})}function ce(t,e,n,l,_,o,u,i){var a,f,r,h=n.props,c=e.props,s=e.type,p=0;if(s==="svg"&&(_=!0),o!=null){for(;p<o.length;p++)if((a=o[p])&&"setAttribute"in a==!!s&&(s?a.localName===s:a.nodeType===3)){t=a,o[p]=null;break}}if(t==null){if(s===null)return document.createTextNode(c);t=_?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s,c.is&&c),o=null,i=!1}if(s===null)h===c||i&&t.data===c||(t.data=c);else{if(o=o&&A.call(t.childNodes),f=(h=n.props||P).dangerouslySetInnerHTML,r=c.dangerouslySetInnerHTML,!i){if(o!=null)for(h={},p=0;p<t.attributes.length;p++)h[t.attributes[p].name]=t.attributes[p].value;(r||f)&&(r&&(f&&r.__html==f.__html||r.__html===t.innerHTML)||(t.innerHTML=r&&r.__html||""))}if(ae(t,c,h,_,i),r)e.__k=[];else if(p=e.props.children,Y(t,Array.isArray(p)?p:[p],e,n,l,_&&s!=="foreignObject",o,u,o?o[0]:n.__k&&S(n,0),i),o!=null)for(p=o.length;p--;)o[p]!=null&&K(o[p]);i||("value"in c&&(p=c.value)!==void 0&&(p!==t.value||s==="progress"&&!p||s==="option"&&p!==h.value)&&T(t,"value",p,h.value,!1),"checked"in c&&(p=c.checked)!==void 0&&p!==t.checked&&T(t,"checked",p,h.checked,!1))}return t}function ne(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(l){d.__e(l,n)}}function oe(t,e,n){var l,_;if(d.unmount&&d.unmount(t),(l=t.ref)&&(l.current&&l.current!==t.__e||ne(l,null,e)),(l=t.__c)!=null){if(l.componentWillUnmount)try{l.componentWillUnmount()}catch(o){d.__e(o,e)}l.base=l.__P=null}if(l=t.__k)for(_=0;_<l.length;_++)l[_]&&oe(l[_],e,typeof t.type!="function");n||t.__e==null||K(t.__e),t.__e=t.__d=void 0}function pe(t,e,n){return this.constructor(t,n)}function R(t,e,n){var l,_,o;d.__&&d.__(t,e),_=(l=typeof n=="function")?null:n&&n.__k||e.__k,o=[],L(e,t=(!l&&n||e).__k=m(B,null,[t]),_||P,P,e.ownerSVGElement!==void 0,!l&&n?[n]:_?null:e.firstChild?A.call(e.childNodes):null,o,!l&&n?n:_?_.__e:e.firstChild,l),te(o,t)}A=X.slice,d={__e:function(t,e,n,l){for(var _,o,u;e=e.__;)if((_=e.__c)&&!_.__)try{if((o=_.constructor)&&o.getDerivedStateFromError!=null&&(_.setState(o.getDerivedStateFromError(t)),u=_.__d),_.componentDidCatch!=null&&(_.componentDidCatch(t,l||{}),u=_.__d),u)return _.__E=_}catch(i){t=i}throw t}},z=0,se=function(t){return t!=null&&t.constructor===void 0},x.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=k({},this.state),typeof t=="function"&&(t=t(k({},n),this.props)),t&&k(n,t),t!=null&&this.__v&&(e&&this.__h.push(e),$(this))},x.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),$(this))},x.prototype.render=B,C=[],G=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,D.__r=0,ie=0;function U(){let t=localStorage.getItem("past-runs");return t?JSON.parse(t):{}}function H(t){let e=U();return e[t]?e[t]:[]}function fe(t,e,n){let l=H(),_=U();return _[t]||(_[t]=[]),_[t].push({inputs:e,output:n,run_at:new Date}),localStorage.setItem("past-runs",JSON.stringify(_)),_[t].length-1}function de(t,e,n,l){let _=U(),o=H(t);_[t][e]={inputs:n,output:l,run_at:o[e].run_at},localStorage.setItem("past-runs",JSON.stringify(_))}var me=document.getElementById("submit"),re=document.getElementById("form"),he=document.getElementById("response"),le=document.getElementById("loading"),ye=document.getElementById("last-output-box"),_e=document.getElementById("runtimeMsOutput"),M=null;me.addEventListener("click",async t=>{t.preventDefault();let e=new FormData(re),n={};for(let[i,a]of e.entries())a instanceof File?n[i]=await a.arrayBuffer():n[i]=a;for(let i of Array.from(re.querySelectorAll("input[type=checkbox")))n[i.name]=i.checked,e.append(i.name,i.checked);console.log(n),ye.style.display="block",R(m(F,{inputs:n}),document.body.querySelector("#input-pre")),he.querySelector("#output-pre").innerText="",M&&(console.log("Clear"),clearInterval(M));let l=25,_=0;M=setInterval(()=>{_e.innerText=parseFloat(_/1e3).toFixed(1),_+=l},l);let o=window.location.href.split("/").slice(-1)[0];le.style.display="inline-block";let u=fe(o,n);O(),console.log("starting ticker"),fetch(`/api/${o}`,{method:"POST",body:e}).then(i=>{clearInterval(M),i.text().then(a=>{le.style.display="none";let f=i.headers.get("X-Execution-Time-Ms");if(f){let r=JSON.parse(f);_e.innerText=parseFloat(r/1e3).toFixed(1)}document.body.querySelector("#output-pre").innerText=a,de(o,u,n,a),O()})})});function ve(t){try{return JSON.parse(t)}catch{return null}}function O(){let t=document.getElementById("past-runs");t.innerHTML="";let e=window.location.href.split("/").slice(-1)[0],n=H(e);R(m(W,{runs:n}),document.getElementById("past-runs"))}var F=class extends x{render(){console.log(this.props.inputs);let e=[];for(let n in this.props.inputs){let l=this.props.inputs[n];e.push(m("p",{className:"font-mono"},n,"=",JSON.stringify(l)))}return m("div",null,e)}},W=class extends x{constructor(e){super(e),this.state={hide:!0}}render(){let e=this.props.runs;if(e.length===0)return null;let n=[];for(let l of e.reverse()){let _=new Date(l.run_at),o=ve(l.output),u=!1;o&&o.message&&o.exception&&(u=!0);let i=m("div",null,"pending...");l.output&&(i=[m("div",{className:"uppercase text-sm font-semibold bg-blue-200 px-1 mt-1 rounded w-fit"},"output"),m("pre",{className:"max-w-md whitespace-pre-wrap max-h-96 overflow-y-auto"},l.output)]);let a=m("div",null,m(F,{inputs:l.inputs}));n.push(m("tr",{className:`even:bg-grey odd:bg-gray-200 ${u?"even:bg-red-200 odd:bg-red-300":""}`},m("td",{className:"px-4 py-3"},m("div",{className:"mb-2"},m("span",{className:"text-white text-sm font-semibold bg-blue-500 px-2 py-1 rounded-lg"},_.toLocaleString())),l.inputs?m("div",{className:"uppercase text-sm font-semibold bg-blue-200 px-1 rounded w-fit"},"Inputs"):null,a,i)))}return m("div",{className:"w-md mt-8"},m("div",{class:"grid grid-cols-6"},m("p",{class:"text-center col-span-5 font-bold uppercase"},"Past Runs"),m("button",{onClick:()=>{let l=U(),_=window.location.href.split("/").slice(-1)[0];delete l[_],localStorage.setItem("past-runs",JSON.stringify(l)),O()},class:"bg-gray-500 hover:bg-gray-400 active:bg-gray-900 text-white font-bold text-sm w-fit px-3 py-1 border-b-4 border-gray-700 hover:border-gray-500 active:border-gray-800 rounded"},"Clear")),m("table",{class:"mt-3 w-full"},m("tbody",null,n)))}};O();})();
