(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{257:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return u}));var n=a(28),l=a.n(n),r=function(e){if(e)return l.a.get("events?job_id=".concat(e))},c=function(e){if(e)return l.a.get("events?job_id=".concat(e,"&view=pipeline"))},o=function(e){if(e)return l.a.get("events/pipeline?query_id=".concat(e,"&view=actor"))},i=function(e,t){if(e)return l.a.get("events/pipeline?query_id=".concat(e,"&view=worker&query_type=").concat(t))},u=function(){return l.a.get("events")}},271:function(e,t,a){"use strict";var n=a(12),l=a(10),r=a(94),c=a(130),o=a(227),i=a(228),u=a(230),m=a(231),d=a(171),s=a(131),p=a(175),v=a(229),E=a(82),g=a(460),f=a(177),b=a(726),h=a(234),j=a(85),O=a.n(j),y=a(0),I=a.n(y),k=a(41),w=a(96),S=a(257),C=a(97),N=a(276),x=a(99),A=a(36),F=a(294),P=function(e){var t=e.actorId,a=Object(y.useState)({}),n=Object(l.a)(a,2),s=n[0],p=n[1],v=Object(y.useContext)(w.a),E=v.ipLogMap,f=v.nodeIpMap,b=Object(y.useState)(),j=Object(l.a)(b,2),x=j[0],P=j[1],M=Object(C.b)(),D=M.page,z=M.pageSize,L=M.setPage,H=M.setTotal,W=M.total,_=M.startIndex,R=M.endIndex;return Object(y.useEffect)((function(){var e;null===(e=Object(S.a)(t))||void 0===e||e.then((function(e){var t,a;(null==e||null===(t=e.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.events)&&p(e.data.data.events),P(e.data.data.slsUrl)}))}),[t]),Object(y.useEffect)((function(){H(Object.values(s).length)}),[s]),I.a.createElement(r.a,{container:!0,justify:"space-around",alignItems:"center"},x&&I.a.createElement(c.a,null,I.a.createElement("a",{href:x,target:"_blank",rel:"noopener noreferrer"},"History sls worker log")),I.a.createElement(h.a,{page:D,count:Math.round(W/z),onChange:function(e,t){return L(t)}}),I.a.createElement(o.a,null,I.a.createElement(i.a,null,["","Host Name","Job Name","Job Id","Language","Node","Pid","WorkerId","Log"].map((function(e){return I.a.createElement(u.a,{align:"center",key:e},e)}))),I.a.createElement(m.a,null,Object.values(s).slice(_,R).map((function(e,t){var a,n,l,o,i,m,s,p,v,b,h,j,y,w;return I.a.createElement(F.a,{length:1,expandComponent:I.a.createElement("div",null,(null===(a=e.info)||void 0===a?void 0:a.message)&&I.a.createElement("pre",{style:{whiteSpace:"pre-wrap"}},"Actor Message: ",e.info.message),I.a.createElement(r.a,{container:!0,alignItems:"center",justify:"space-around"},e.events.sort((function(e,t){return O()(e.timeStamp).valueOf()-O()(t.timeStamp).valueOf()})).map((function(t,a){var n=t.label,l=t.timeStamp,c=t.severity,o=t.message;return I.a.createElement(I.a.Fragment,null,I.a.createElement(r.a,{item:!0,style:{textAlign:"center"}},I.a.createElement(d.a,{title:o},I.a.createElement("p",null,I.a.createElement(A.a,{status:n,type:c}))),I.a.createElement("p",null,O()(l).format("YYYY/MM/DD")),I.a.createElement("p",null,O()(l).format("HH:mm:ss.SSS"))),a!==e.events.length-1&&I.a.createElement(r.a,{item:!0},I.a.createElement(g.a,null)))}))))},I.a.createElement(u.a,{align:"center"},(null===(n=e.info)||void 0===n?void 0:n.hostName)||"unknown"),I.a.createElement(u.a,{align:"center"},(null===(l=e.info)||void 0===l?void 0:l.jobName)||"unknown"),I.a.createElement(u.a,{align:"center"},I.a.createElement(k.b,{to:"/job/".concat(null===(o=e.info)||void 0===o?void 0:o.jobId)},null===(i=e.info)||void 0===i?void 0:i.jobId)),I.a.createElement(u.a,{align:"center"},null===(m=e.info)||void 0===m?void 0:m.language),I.a.createElement(u.a,{align:"center"},I.a.createElement(k.b,{to:"/node/".concat(null===(s=e.info)||void 0===s?void 0:s.nodeId)},null===(p=e.info)||void 0===p||null===(v=p.nodeId)||void 0===v?void 0:v.slice(0,5))),I.a.createElement(u.a,{align:"center"},null===(b=e.info)||void 0===b?void 0:b.pid),I.a.createElement(u.a,{align:"center"},I.a.createElement(N.a,{text:(null===(h=e.info)||void 0===h?void 0:h.workerId)||""})),I.a.createElement(u.a,{align:"center"},E[f[null==e||null===(j=e.info)||void 0===j?void 0:j.hostName]]&&I.a.createElement(c.a,null,I.a.createElement(k.b,{target:"_blank",to:"/log/".concat(encodeURIComponent(E[f[null==e||null===(y=e.info)||void 0===y?void 0:y.hostName]]),"?fileName=").concat(null==e||null===(w=e.info)||void 0===w?void 0:w.pid)},"Log"))))})))))};t.a=function(e){var t=e.actors,a=void 0===t?{}:t,l=e.workers,r=void 0===l?[]:l,d=e.isWorker,g=Object(C.a)(),j=g.changeFilter,O=g.filterFunc,S=Object(y.useContext)(w.a).ipLogMap,M=Object.values(a||{}).map((function(e){var t,a=(null===(t=e.taskSpec)||void 0===t?void 0:t.functionDescriptor)||e.functionDescriptor||{};return Object(n.a)(Object(n.a)({},e),{},{functionDesc:Object.values(a.javaFunctionDescriptor||a.pythonFunctionDescriptor||{}).join(" ")})})).filter(O),D=Object(C.b)(),z=D.page,L=D.pageSize,H=D.setPage,W=D.startIndex,_=D.endIndex,R=D.setPageSize,T=M.slice(W,_),Y=function(){j.apply(void 0,arguments),H(1)};return I.a.createElement(I.a.Fragment,null,I.a.createElement("div",{style:{flex:1,display:"flex",alignItems:"center"}},I.a.createElement(b.a,{style:{margin:8,width:120},options:Array.from(new Set(Object.values(a).map((function(e){return e.state})))),onInputChange:function(e,t){Y("state",t.trim())},renderInput:function(e){return I.a.createElement(s.a,Object.assign({},e,{label:"State"}))}}),I.a.createElement(b.a,{style:{margin:8,width:150},options:Array.from(new Set(Object.values(a).map((function(e){var t;return null===(t=e.address)||void 0===t?void 0:t.ipAddress})))),onInputChange:function(e,t){Y("address.ipAddress",t.trim())},renderInput:function(e){return I.a.createElement(s.a,Object.assign({},e,{label:"IP"}))}}),I.a.createElement(s.a,{style:{margin:8,width:120},label:"PID",size:"small",InputProps:{onChange:function(e){var t=e.target.value;Y("pid",t.trim())},endAdornment:I.a.createElement(p.a,{position:"end"},I.a.createElement(f.a,null))}}),I.a.createElement(s.a,{style:{margin:8,width:200},label:"Task Func Desc",size:"small",InputProps:{onChange:function(e){var t=e.target.value;Y("functionDesc",t.trim())},endAdornment:I.a.createElement(p.a,{position:"end"},I.a.createElement(f.a,null))}}),I.a.createElement(s.a,{style:{margin:8,width:120},label:"Name",size:"small",InputProps:{onChange:function(e){var t=e.target.value;Y("name",t.trim())},endAdornment:I.a.createElement(p.a,{position:"end"},I.a.createElement(f.a,null))}}),I.a.createElement(s.a,{style:{margin:8,width:120},label:"Actor ID",size:"small",InputProps:{onChange:function(e){var t=e.target.value;Y("actorId",t.trim())},endAdornment:I.a.createElement(p.a,{position:"end"},I.a.createElement(f.a,null))}}),I.a.createElement(s.a,{style:{margin:8,width:120},label:"Page Size",size:"small",InputProps:{onChange:function(e){var t=e.target.value;R(Math.min(Number(t),500)||10)}}})),I.a.createElement("div",{style:{display:"flex",alignItems:"center"}},I.a.createElement("div",null,I.a.createElement(h.a,{page:z,onChange:function(e,t){return H(t)},count:Math.ceil(M.length/L)})),I.a.createElement("div",null,I.a.createElement(x.a,{type:"actor",list:M}))),I.a.createElement(o.a,{size:"small"},I.a.createElement(i.a,null,I.a.createElement(v.a,null,["","ID","Restart Times","Name","Class","Function","Job Id","Pid","IP","Port","State","Log"].map((function(e){return I.a.createElement(u.a,{align:"center",key:e},e)})))),I.a.createElement(m.a,null,T.map((function(e){var t,a,n,l,o=e.actorId,i=e.functionDescriptor,m=e.jobId,s=e.pid,p=e.address,v=e.state,g=e.name,f=e.numRestarts;return I.a.createElement(F.a,{length:r.filter((function(e){return e.pid===s&&p.ipAddress===e.coreWorkerStats[0].ipAddress})).length,expandComponent:I.a.createElement("div",null,I.a.createElement("h5",null,"Pipeline"),I.a.createElement(P,{actorId:o}),!d&&I.a.createElement(I.a.Fragment,null,I.a.createElement("h5",null,"Related worker"),I.a.createElement(F.b,{actorMap:{},workers:r.filter((function(e){return e.pid===s&&p.ipAddress===e.coreWorkerStats[0].ipAddress})),mini:!0}))),key:o},I.a.createElement(u.a,{align:"center"},I.a.createElement(N.a,{text:o})),I.a.createElement(u.a,{align:"center",style:{color:Number(f)>0?E.a[500]:"inherit"}},f),I.a.createElement(u.a,{align:"center"},g),I.a.createElement(u.a,{align:"center"},null==i||null===(t=i.javaFunctionDescriptor)||void 0===t?void 0:t.className,null==i||null===(a=i.pythonFunctionDescriptor)||void 0===a?void 0:a.className),I.a.createElement(u.a,{align:"center"},null==i||null===(n=i.javaFunctionDescriptor)||void 0===n?void 0:n.functionName,null==i||null===(l=i.pythonFunctionDescriptor)||void 0===l?void 0:l.functionName),I.a.createElement(u.a,{align:"center"},m),I.a.createElement(u.a,{align:"center"},s),I.a.createElement(u.a,{align:"center"},null==p?void 0:p.ipAddress),I.a.createElement(u.a,{align:"center"},null==p?void 0:p.port),I.a.createElement(u.a,{align:"center"},I.a.createElement(A.a,{type:"actor",status:v})),I.a.createElement(u.a,{align:"center"},S[null==p?void 0:p.ipAddress]&&I.a.createElement(c.a,null,I.a.createElement(k.b,{target:"_blank",to:"/log/".concat(encodeURIComponent(S[null==p?void 0:p.ipAddress]),"?fileName=").concat(s)},"Log"))))})))))}},276:function(e,t,a){"use strict";var n=a(10),l=a(171),r=a(458),c=a(459),o=a(298),i=a.n(o),u=a(0),m=a.n(u);t.a=function(e){var t=e.text,a=e.length,o=void 0===a?5:a,d=e.noCollapse,s=t.length>o&&!d?"".concat(t.slice(0,o)):t,p=Object(u.useState)(!1),v=Object(n.a)(p,2),E=v[0],g=v[1],f=E?r.a:c.a;return m.a.createElement(l.a,{title:t},m.a.createElement("span",{style:{display:"flex",alignItems:"center"}},s," ",m.a.createElement(f,{style:{width:12,height:12,cursor:"pointer"},onClick:function(e){e.stopPropagation(),e.preventDefault(),i()(t),g(!0),setTimeout((function(){return g(!1)}),1e3)}})))}},294:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(12),l=a(10);function r(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var c=a(229),o=a(230),i=a(224),u=a(226),m=a(723),d=a(703),s=a(227),p=a(228),v=a(231),E=a(94),g=a(130),f=a(0),b=a.n(f),h=a(87),j=Object(h.a)(f.createElement("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown"),O=Object(h.a)(f.createElement("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight"),y=a(460),I=a(234),k=a(85),w=a.n(k),S=a(41),C=a(96),N=a(257),x=a(15),A=a(47),F=a(97),P=a(271),M=a(34),D=a(43),z=a(36),L=function(e){var t=e.children,a=e.expandComponent,n=e.length,u=e.stateKey,m=void 0===u?"":u,d=r(e,["children","expandComponent","length","stateKey"]),s=b.a.useState(!1),p=Object(l.a)(s,2),v=p[0],E=p[1];return Object(f.useEffect)((function(){m.startsWith("ON")?E(!0):m.startsWith("OFF")&&E(!1)}),[m]),b.a.createElement(b.a.Fragment,null,b.a.createElement(c.a,d,b.a.createElement(o.a,{padding:"checkbox"},b.a.createElement(i.a,{style:{color:"inherit"},onClick:function(){return E(!v)}},n>1&&n,v?b.a.createElement(j,null):b.a.createElement(O,null))),t),v&&b.a.createElement(c.a,null,b.a.createElement(o.a,{colSpan:24},a)))},H=function(e){var t=e.actorMap,a=e.coreWorkerStats,n={};return(a||[]).filter((function(e){return t[e.actorId]})).forEach((function(e){return n[e.actorId]=t[e.actorId]})),Object.values(n).length?b.a.createElement(u.a,null,b.a.createElement(P.a,{actors:n})):b.a.createElement("p",null,"The Worker Haven't Had Related Actor Yet.")};t.b=function(e){var t=e.workers,a=void 0===t?[]:t,r=e.actorMap,i=e.mini,u=e.entity,h=e.entityId,j=Object(F.a)(),O=j.changeFilter,k=j.filterFunc,W=Object(f.useState)({pageSize:10,pageNo:1}),_=Object(l.a)(W,2),R=_[0],T=_[1],Y=Object(f.useState)(""),J=Object(l.a)(Y,2),U=J[0],K=J[1],q=Object(f.useState)(!1),B=Object(l.a)(q,2),V=B[0],G=B[1],Q=Object(f.useState)(),X=Object(l.a)(Q,2),Z=X[0],$=X[1],ee=Object(f.useContext)(C.a),te=ee.nodeMap,ae=ee.ipLogMap,ne=ee.nodeIpMap;return Object(f.useEffect)((function(){var e;(T({pageSize:10,pageNo:1}),V&&u&&h)&&(null===(e=Object(N.e)(h,u))||void 0===e||e.then((function(e){e&&e.data&&$(e.data.data)})))}),[V,u,h]),b.a.createElement("div",null,b.a.createElement(m.a,{value:V?1:0,onChange:function(e,t){G(1===t)}},b.a.createElement(d.a,{label:"runtime"}),b.a.createElement(d.a,{label:"history"})),b.a.createElement("div",null,b.a.createElement("div",null,b.a.createElement(I.a,{page:R.pageNo,onChange:function(e,t){return T(Object(n.a)(Object(n.a)({},R),{},{pageNo:t}))},count:Math.ceil(a.filter(k).length/R.pageSize)})),V?b.a.createElement("div",null,b.a.createElement(s.a,null,b.a.createElement(p.a,null,b.a.createElement(c.a,null,["","Host Name","Job Name","Job Id","Node","Pid","WorkerId","Log"].map((function(e){return b.a.createElement(o.a,{align:"center",key:e},e)})))),b.a.createElement(v.a,null,Object.entries((null==Z?void 0:Z.events)||{}).filter(k).slice((R.pageNo-1)*R.pageSize,R.pageNo*R.pageSize).map((function(e){var t,a,n,c,i,u,m,d,s,p,v,f,h,j,O,I,k=Object(l.a)(e,2),C=k[0],N=k[1][1];return b.a.createElement(L,{length:1,key:C,expandComponent:b.a.createElement("div",null,b.a.createElement(E.a,{container:!0,alignItems:"center",justify:"space-around"},N&&N.sort((function(e,t){return w()(e.timeStamp).valueOf()-w()(t.timeStamp).valueOf()})).map((function(e,t){var a=e.label,n=e.timeStamp,l=e.severity;return b.a.createElement(b.a.Fragment,null,b.a.createElement(E.a,{item:!0,style:{textAlign:"center"}},b.a.createElement("p",null,b.a.createElement(z.a,{status:a,type:l})),b.a.createElement("p",null,w()(n).format("HH:mm:ss.SSS"))),t!==N.length-1&&b.a.createElement(E.a,{item:!0},b.a.createElement(y.a,null)))}))),b.a.createElement(P.a,{isWorker:!0,actors:Object.fromEntries(Object.entries(r).filter((function(e){var t,a,n,r,c,o,i=Object(l.a)(e,2),u=(i[0],i[1]);return(null==u||null===(t=u.address)||void 0===t?void 0:t.workerId)&&(null===(a=N[0])||void 0===a||null===(n=a.customFields)||void 0===n?void 0:n.workerId)&&(null==u||null===(r=u.address)||void 0===r?void 0:r.workerId)===(null===(c=N[0])||void 0===c||null===(o=c.customFields)||void 0===o?void 0:o.workerId)})))}))},b.a.createElement(o.a,{align:"center"},null===(t=N[0])||void 0===t||null===(a=t.customFields)||void 0===a?void 0:a.hostName),b.a.createElement(o.a,{align:"center"},null===(n=N[0])||void 0===n?void 0:n.jobName),b.a.createElement(o.a,{align:"center"},b.a.createElement(S.b,{to:"/job/".concat(null===(c=N[0])||void 0===c?void 0:c.jobId)},null===(i=N[0])||void 0===i?void 0:i.jobId)),b.a.createElement(o.a,{align:"center"},b.a.createElement(S.b,{to:"/node/".concat(null===(u=N[0])||void 0===u?void 0:u.nodeId)},null===(m=N[0])||void 0===m||null===(d=m.nodeId)||void 0===d?void 0:d.slice(0,5))),b.a.createElement(o.a,{align:"center"},null===(s=N[0])||void 0===s||null===(p=s.customFields)||void 0===p?void 0:p.pid),b.a.createElement(o.a,{align:"center"},C),b.a.createElement(o.a,{align:"center"},ae[ne[null===(v=N[0])||void 0===v||null===(f=v.customFields)||void 0===f?void 0:f.hostName]]&&b.a.createElement(g.a,null,b.a.createElement(S.b,{target:"_blank",to:"/log/".concat(encodeURIComponent(ae[ne[null===(h=N[0])||void 0===h||null===(j=h.customFields)||void 0===j?void 0:j.hostName]]),"?fileName=").concat(null===(O=N[0])||void 0===O||null===(I=O.customFields)||void 0===I?void 0:I.pid)},"Log"))))}))))):b.a.createElement("div",null,!i&&b.a.createElement("div",null,b.a.createElement("div",{style:{display:"flex",alignItems:"center"}},b.a.createElement(D.a,{label:"Pid",onChange:function(e){return function(){O.apply(void 0,arguments),T(Object(n.a)(Object(n.a)({},R),{},{pageNo:1}))}("pid",e)}}),b.a.createElement(g.a,{onClick:function(){return K("ON".concat(Math.random()))}},"Expand All"),b.a.createElement(g.a,{onClick:function(){return K("OFF".concat(Math.random()))}},"Collapse All"))),b.a.createElement(s.a,{size:"small"},b.a.createElement(p.a,null,b.a.createElement(c.a,null,["","Pid","CPU","CPU Times","Memory","CMD Line","Create Time","Log","Ops","IP/Hostname"].map((function(e){return b.a.createElement(o.a,{align:"center",key:e},e)})))),b.a.createElement(v.a,null,a.filter(k).slice((R.pageNo-1)*R.pageSize,R.pageNo*R.pageSize).sort((function(e,t){var a=(e.coreWorkerStats||[]).filter((function(e){return r[e.actorId]})).length||0;return((t.coreWorkerStats||[]).filter((function(e){return r[e.actorId]})).length||0)-a})).map((function(e){var t=e.pid,a=e.cpuPercent,n=e.cpuTimes,c=e.memoryInfo,i=e.cmdline,u=e.createTime,m=e.coreWorkerStats,d=void 0===m?[]:m,s=e.slsUrl,p=e.language,v=e.ip,E=e.hostname;return b.a.createElement(L,{expandComponent:b.a.createElement(H,{actorMap:r,coreWorkerStats:d}),length:(d||[]).filter((function(e){return r[e.actorId]})).length,key:t,stateKey:U},b.a.createElement(o.a,{align:"center"},t),b.a.createElement(o.a,{align:"center"},b.a.createElement(M.a,{num:Number(a),total:100},a,"%")),b.a.createElement(o.a,{align:"center"},b.a.createElement("div",{style:{maxHeight:55,overflow:"auto"}},Object.entries(n||{}).map((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return b.a.createElement("div",{style:{margin:4}},a,":",n)})))),b.a.createElement(o.a,{align:"center"},b.a.createElement("div",{style:{maxHeight:55,overflow:"auto"}},Object.entries(c||{}).map((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return b.a.createElement("div",{style:{margin:4}},a,":",Object(x.a)(n))})))),b.a.createElement(o.a,{align:"center",style:{lineBreak:"anywhere"}},i&&Object(A.d)(i.filter((function(e){return e})).join(" "))),b.a.createElement(o.a,{align:"center"},w()(1e3*u).format("YYYY/MM/DD HH:mm:ss")),b.a.createElement(o.a,{align:"center"},s&&b.a.createElement(g.a,null,Object(A.e)(s)),ae[v]&&b.a.createElement(g.a,null,b.a.createElement(S.b,{target:"_blank",to:"/log/".concat(encodeURIComponent(ae[v]),"?fileName=").concat(t)},"Log"))),b.a.createElement(o.a,{align:"center"},"JAVA"===p&&b.a.createElement("div",null,b.a.createElement(g.a,{onClick:function(){var e;window.open("#/cmd/jstack/".concat(null===(e=d[0])||void 0===e?void 0:e.ipAddress,"/").concat(t))}},"jstack")," ",b.a.createElement(g.a,{onClick:function(){window.open("#/cmd/jmap/".concat(v,"/").concat(t))}},"jmap"),b.a.createElement(g.a,{onClick:function(){window.open("#/cmd/jstat/".concat(v,"/").concat(t))}},"jstat")),"PYTHON"===p&&b.a.createElement("div",null,b.a.createElement(g.a,{onClick:function(){window.open("#/cmd/pystack/".concat(v,"/").concat(t))}},"pystack")),b.a.createElement(g.a,{onClick:function(){window.open("#/profiler/".concat(v,"/").concat(t))}},"profiler")),b.a.createElement(o.a,{align:"center"},v,b.a.createElement("br",null),te[E]?b.a.createElement(S.b,{target:"_blank",to:"/node/".concat(te[E])},E):E))})))))))}},460:function(e,t,a){"use strict";var n=a(0),l=a(87);t.a=Object(l.a)(n.createElement("path",{d:"M10 17l5-5-5-5v10z"}),"ArrowRight")}}]);