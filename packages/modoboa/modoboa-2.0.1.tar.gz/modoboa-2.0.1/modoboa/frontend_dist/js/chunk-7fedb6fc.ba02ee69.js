(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7fedb6fc"],{"07d7":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t.dialogMode?a("translate",{staticClass:"headline"},[t._v("Administrators of "+t._s(t.domain.name))]):a("translate",{staticClass:"headline"},[t._v("Administrators")])],1)]),a("v-card-text",[a("v-data-table",{attrs:{headers:t.headers,items:t.administrators,"hide-default-footer":""},scopedSlots:t._u([{key:"item.username",fn:function(e){var i=e.item;return[i.id?a("span",[t._v(t._s(i.username))]):a("v-autocomplete",{attrs:{label:t._f("translate")("Select an account"),items:t.accounts,"item-text":"username","return-object":""},scopedSlots:t._u([{key:"append-outer",fn:function(){return[t.selectedAccount?a("v-btn",{attrs:{icon:"",color:"primary"},on:{click:t.addAdministrator}},[a("v-icon",[t._v("mdi-content-save")])],1):t._e()]},proxy:!0}],null,!0),model:{value:t.selectedAccount,callback:function(e){t.selectedAccount=e},expression:"selectedAccount"}})]}},{key:"item.name",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.first_name)+" "+t._s(a.last_name)+" ")]}},{key:"item.actions",fn:function(e){var i=e.item;return[i.id?a("v-btn",{attrs:{icon:"",color:"red",title:t._f("translate")("Remove this administrator")},on:{click:function(e){return t.removeAdministrator(i)}}},[a("v-icon",[t._v("mdi-delete-outline")])],1):t._e()]}}])}),t.hideAddBtn?t._e():a("v-btn",{attrs:{small:"",color:"primary",outlined:""},on:{click:t.addRow}},[a("v-icon",{attrs:{small:""}},[t._v("mdi-plus")]),t._v(" "),a("translate",[t._v("Add administrator")])],1)],1),t.dialogMode?a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"grey darken-1",text:""},on:{click:t.close}},[a("translate",[t._v("Close")])],1)],1):t._e()],1)},n=[],s=(a("4de4"),a("7db0"),a("2801")),o=a("458e"),r=a("56d7"),l={props:{domain:Object,dialogMode:{type:Boolean,default:!1}},data:function(){return{accounts:[],administrators:[],headers:[{text:this.$gettext("Username"),value:"username"},{text:this.$gettext("Name"),value:"name"},{text:"",value:"actions",align:"right",sortable:!1}],hideAddBtn:!1,selectedAccount:null}},methods:{addRow:function(){this.administrators.push({}),this.hideAddBtn=!0},close:function(){this.$emit("close"),this.hideAddBtn=!1},fetchAdministrators:function(t){var e=this;o["a"].getDomainAdministrators(t.pk).then((function(t){e.administrators=t.data}))},fetchAccounts:function(){var t=this;s["a"].getAll({role:"DomainAdmins"}).then((function(e){t.accounts=e.data.filter((function(e){return void 0===t.administrators.find((function(t){return t.id===e.pk}))}))}))},addAdministrator:function(){var t=this;o["a"].addDomainAdministrator(this.domain.pk,this.selectedAccount.pk).then((function(e){t.fetchAdministrators(t.domain),t.accounts=t.accounts.filter((function(e){return e.pk!==t.selectedAccount.pk})),t.selectedAccount=null,t.hideAddBtn=!1,r["bus"].$emit("notification",{msg:t.$gettext("Administrator added")})}))},removeAdministrator:function(t){var e=this;o["a"].removeDomainAdministrator(this.domain.pk,t.id).then((function(t){e.fetchAdministrators(e.domain),e.fetchAccounts(),r["bus"].$emit("notification",{msg:e.$gettext("Administrator removed")})}))}},watch:{domain:{handler:function(t){this.fetchAdministrators(t),this.fetchAccounts()},immediate:!0}}},d=l,m=a("2877"),c=a("6544"),u=a.n(c),h=a("c6a6"),f=a("8336"),p=a("b0af"),v=a("99d9"),_=a("8fea"),b=a("132d"),x=a("2fa4"),g=Object(m["a"])(d,i,n,!1,null,null,null);e["a"]=g.exports;u()(g,{VAutocomplete:h["a"],VBtn:f["a"],VCard:p["a"],VCardActions:v["a"],VCardText:v["b"],VCardTitle:v["c"],VDataTable:_["a"],VIcon:b["a"],VSpacer:x["a"]})},1594:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("translate",[t._v("Domains")])],1),a("v-spacer"),a("v-btn",{staticClass:"mr-2",attrs:{title:t._f("translate")("Import domains and aliases from CSV file")},on:{click:function(e){t.showImportForm=!0}}},[a("v-icon",[t._v("mdi-file-import-outline")])],1),a("v-btn",{staticClass:"mr-2",attrs:{title:t._f("translate")("Export domains and aliases to CSV")},on:{click:t.exportDomains}},[a("v-icon",[t._v("mdi-file-export-outline")])],1),a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({attrs:{color:"primary"}},"v-btn",n,!1),i),[a("v-icon",{attrs:{left:""}},[t._v("mdi-plus")]),a("translate",[t._v("New")])],1)]}}])},[a("v-list",{attrs:{dense:""}},[a("v-list-item",{on:{click:function(e){t.showDomainWizard=!0}}},[a("v-list-item-title",[a("translate",[t._v("Domain")])],1)],1),a("v-list-item",{on:{click:function(e){t.showAliasForm=!0}}},[a("v-list-item-title",[a("translate",[t._v("Alias")])],1)],1)],1)],1)],1),a("domain-list"),a("v-dialog",{attrs:{fullscreen:"",scrollable:"",transition:"dialog-bottom-transition"},model:{value:t.showDomainWizard,callback:function(e){t.showDomainWizard=e},expression:"showDomainWizard"}},[a("domain-creation-form",{on:{close:function(e){t.showDomainWizard=!1}}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:t.showAliasForm,callback:function(e){t.showAliasForm=e},expression:"showAliasForm"}},[a("domain-alias-form",{on:{close:function(e){t.showAliasForm=!1}}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:t.showImportForm,callback:function(e){t.showImportForm=e},expression:"showImportForm"}},[a("import-form",{ref:"importForm",attrs:{title:t._f("translate")("Import domains")},on:{submit:t.importDomains,close:function(e){t.showImportForm=!1}},scopedSlots:t._u([{key:"help",fn:function(){return[a("ul",[a("li",[a("em",[t._v("domain; name; quota; default mailbox quota; enabled")])]),a("li",[a("em",[t._v("domainalias; name; targeted domain; enabled")])]),a("li",[a("em",[t._v("relaydomain; name; target host; target port; service; enabled; verify recipients")])])])]},proxy:!0}])})],1)],1)},n=[],s=a("458e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v(t._s(t.title))])]),a("v-card-text",[a("validation-observer",{ref:"observer"},[a("validation-provider",{attrs:{name:"name",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("label",{staticClass:"m-label"},[t._v(t._s(t.$gettext("Name")))]),a("v-text-field",{attrs:{dense:"",outlined:"","error-messages":i},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})]}}])}),a("validation-provider",{attrs:{name:"target",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("label",{staticClass:"m-label"},[t._v(t._s(t.$gettext("Choose a domain")))]),a("v-select",{attrs:{items:t.domains,"item-text":"name","item-value":"pk","error-messages":i,"single-line":"",dense:"",outlined:""},model:{value:t.form.target,callback:function(e){t.$set(t.form,"target",e)},expression:"form.target"}})]}}])}),a("v-switch",{attrs:{label:"Enabled",color:"primary"},model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:t.close}},[a("translate",[t._v("Close")])],1),t.domainAlias&&t.domainAlias.pk?a("v-btn",{attrs:{color:"error"},on:{click:t.deleteAlias}},[a("translate",[t._v("Delete")])],1):t._e(),a("v-btn",{attrs:{color:"primary"},on:{click:t.submit}},[t._v(" "+t._s(t.submitLabel)+" ")])],1)],1)},r=[],l=a("1da1"),d=a("5530"),m=(a("96cf"),a("2f62")),c=a("56d7"),u={props:{domainAlias:{type:Object,default:function(){return null}}},computed:Object(d["a"])(Object(d["a"])({},Object(m["b"])({domains:"domains/domains"})),{},{submitLabel:function(){return this.domainAlias?this.$gettext("Update"):this.$gettext("Add")},title:function(){return this.domainAlias?this.$gettext("Edit domain alias"):this.$gettext("Add a new domain alias")}}),data:function(){return{form:{enabled:!0}}},methods:{close:function(){this.$emit("close"),this.form={enabled:!0}},deleteAlias:function(){var t=this;s["a"].deleteDomainAlias(this.domainAlias.pk).then((function(e){t.$emit("alias-deleted"),c["bus"].$emit("notification",{msg:t.$gettext("Domain alias deleted")})}))},submit:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.observer.validate();case 2:if(a=e.sent,a){e.next=5;break}return e.abrupt("return");case 5:if(e.prev=5,t.form.pk){e.next=11;break}return e.next=9,s["a"].createDomainAlias(t.form).then((function(e){c["bus"].$emit("notification",{msg:t.$gettext("Domain alias created")}),t.$emit("alias-created",e.data),t.close()}));case 9:e.next=15;break;case 11:return i=JSON.parse(JSON.stringify(t.form)),i.target=i.target.pk,e.next=15,s["a"].updateDomainAlias(t.form.pk,i).then((function(e){c["bus"].$emit("notification",{msg:t.$gettext("Domain alias updated")}),t.close()}));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](5),t.$refs.observer.setErrors(e.t0.response.data);case 20:case"end":return e.stop()}}),e,null,[[5,17]])})))()}},mounted:function(){this.domainAlias&&(this.form=JSON.parse(JSON.stringify(this.domainAlias)))},watch:{domainAlias:function(t){t&&(this.form=JSON.parse(JSON.stringify(t)))}}},h=u,f=a("2877"),p=a("6544"),v=a.n(p),_=a("8336"),b=a("b0af"),x=a("99d9"),g=a("b974"),k=a("2fa4"),A=a("b73d"),y=a("8654"),w=Object(f["a"])(h,o,r,!1,null,null,null),$=w.exports;v()(w,{VBtn:_["a"],VCard:b["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VSelect:g["a"],VSpacer:k["a"],VSwitch:A["a"],VTextField:y["a"]});var D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("creation-form",{attrs:{title:t._f("translate")("New domain"),steps:t.steps,"form-observer-getter":t.getObserver,"validate-object":t.validateDomain,"summary-sections":t.summarySections},on:{close:t.close,create:t.submit},scopedSlots:t._u([{key:"form.general",fn:function(e){var i=e.step;return[a("domain-general-form",{ref:"form_"+i,attrs:{domain:t.domain}})]}},{key:"form.dns",fn:function(e){var i=e.step;return[a("domain-dns-form",{ref:"form_"+i,attrs:{domain:t.domain}})]}},{key:"form.limitations",fn:function(e){var i=e.step;return[a("domain-limitations-form",{ref:"form_"+i,attrs:{domain:t.domain}})]}},{key:"form.options",fn:function(e){var i=e.step;return[a("domain-options-form",{ref:"form_"+i,attrs:{domain:t.domain},on:{createAdmin:t.updateCreateAdmin}})]}},{key:"form.transport",fn:function(e){var i=e.step;return[a("domain-transport-form",{ref:"form_"+i,attrs:{domain:t.domain}})]}},{key:"item.with_random_password",fn:function(e){var i=e.item;return[i.value?[a("v-col",{staticClass:"highligth white--text",attrs:{cols:"12"}},[a("v-row",[a("v-col",[a("span",[t._v(t._s(i.key))])]),a("v-col",{staticClass:"text-right"},[t._v(t._s(t._f("yesno")(i.value)))])],1),a("v-row",[a("v-col",{staticClass:"text-right py-1"},[t._v(" "+t._s(t.domain.domain_admin.password)+" "),a("v-btn",{attrs:{icon:"",color:"white",title:t._f("translate")("Copy to clipboard")},on:{click:t.copyPassword}},[a("v-icon",[t._v("mdi-clipboard-multiple-outline")])],1)],1)],1)],1)]:[a("v-col",[a("span",{staticClass:"grey--text"},[t._v(t._s(i.key))])]),a("v-col",{staticClass:"text-right"},[t._v(t._s(t._f("yesno")(i.value)))])]]}}])})},C=[],V=a("b85c"),S=(a("b0c0"),a("99af"),a("415d")),F=a("ceb0"),O=a("2370"),L=a("c016"),N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("validation-observer",{ref:"observer"},[a("v-switch",{attrs:{label:t._f("translate")("Create a domain administrator")},on:{change:t.update},model:{value:t.createAdmin,callback:function(e){t.createAdmin=e},expression:"createAdmin"}}),a("validation-provider",{attrs:{rules:t.createAdmin?"required":""},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("v-text-field",{attrs:{label:t._f("translate")("Name"),hint:t._f("translate")("Name of the administrator"),"persistent-hint":"","error-messages":i,outlined:"",disabled:!t.createAdmin,suffix:"@"+t.domain.name},model:{value:t.domain.domain_admin.username,callback:function(e){t.$set(t.domain.domain_admin,"username",e)},expression:"domain.domain_admin.username"}})]}}])}),a("v-switch",{attrs:{label:t._f("translate")("Random password"),disabled:!t.createAdmin,hint:t._f("translate")("Generate a random password for the administrator."),"persistent-hint":""},on:{change:t.updatePassword},model:{value:t.domain.domain_admin.with_random_password,callback:function(e){t.$set(t.domain.domain_admin,"with_random_password",e)},expression:"domain.domain_admin.with_random_password"}}),a("v-switch",{attrs:{label:t._f("translate")("With a mailbox"),disabled:!t.createAdmin,hint:t._f("translate")("Create a mailbox for the administrator."),"persistent-hint":""},model:{value:t.domain.domain_admin.with_mailbox,callback:function(e){t.$set(t.domain.domain_admin,"with_mailbox",e)},expression:"domain.domain_admin.with_mailbox"}}),a("v-switch",{attrs:{label:t._f("translate")("Create aliases"),disabled:!t.createAdmin,hint:t._f("translate")("Create standard aliases for the domain."),"persistent-hint":""},model:{value:t.domain.domain_admin.with_aliases,callback:function(e){t.$set(t.domain.domain_admin,"with_aliases",e)},expression:"domain.domain_admin.with_aliases"}})],1)},I=[],T=a("2801"),j={props:["domain"],data:function(){return{createAdmin:!1}},methods:{updatePassword:function(t){var e=this;t?T["a"].getRandomPassword().then((function(t){e.$set(e.domain.domain_admin,"password",t.data.password)})):delete this.domain.domain_admin.password},update:function(t){this.$emit("createAdmin",t)}}},E=j,q=Object(f["a"])(E,N,I,!1,null,null,null),M=q.exports;v()(q,{VSwitch:A["a"],VTextField:y["a"]});var R=a("6130"),B={props:["value"],components:{CreationForm:S["a"],"domain-dns-form":F["a"],DomainGeneralForm:O["a"],DomainLimitationsForm:L["a"],DomainOptionsForm:M,DomainTransportForm:R["a"]},computed:{summarySections:function(){var t=[{title:this.$gettext("General"),items:[{key:this.$gettext("Name"),value:this.domain.name},{key:this.$gettext("Type"),value:this.domain.type},{key:this.$gettext("Enabled"),value:this.domain.enabled,type:"yesno"}]},{title:this.$gettext("DNS"),items:[{key:this.$gettext("Enable DNS checks"),value:this.domain.enable_dns_checks,type:"yesno"},{key:this.$gettext("Enable DKIM signing"),value:this.domain.enable_dkim,type:"yesno"}]},{title:this.$gettext("Limitations"),items:[{key:this.$gettext("Quota"),value:this.domain.quota},{key:this.$gettext("Default mailbox quota"),value:this.domain.default_mailbox_quota},{key:this.$gettext("Message sending limit"),value:this.domain.message_sending_limit}]}];if(this.domain.enable_dkim&&(t[1].items.push({key:this.$gettext("DKIM key selector"),value:this.domain.dkim_key_selector}),t[1].items.push({key:this.$gettext("DKIM key length"),value:this.domain.dkim_key_length})),this.createAdmin&&t.push({title:this.$gettext("Options"),items:[{key:this.$gettext("Create a domain administrator"),value:this.createAdmin,type:"yesno"},{key:this.$gettext("Administrator name"),value:this.domain.domain_admin.username},{name:"with_random_password",key:this.$gettext("Random password"),value:this.domain.domain_admin.with_random_password,type:"yesno"},{key:this.$gettext("With mailbox"),value:this.domain.domain_admin.with_mailbox,type:"yesno"},{key:this.$gettext("Create aliases"),value:this.domain.domain_admin.with_aliases,type:"yesno"}]}),"relaydomain"===this.domain.type){var e={title:this.$gettext("Transport"),items:[{key:this.$gettext("Service"),value:this.domain.transport.service}]};if(this.$refs.form_4.service){var a,i=this.$refs.form_4.service,n=Object(V["a"])(i.settings);try{for(n.s();!(a=n.n()).done;){var s=a.value,o={key:s.label,value:this.domain.transport.settings["".concat(i.name,"_").concat(s.name)]};"boolean"===s.type&&(o.type="yesno"),e.items.push(o)}}catch(r){n.e(r)}finally{n.f()}}t.push(e)}return t},steps:function(){return"domain"===this.domain.type?this.domainSteps:this.relaySteps}},data:function(){return{createAdmin:!1,domain:{domain_admin:{}},formErrors:{},domainSteps:[{name:"general",title:this.$gettext("General")},{name:"dns",title:this.$gettext("DNS")},{name:"limitations",title:this.$gettext("Limitations")},{name:"options",title:this.$gettext("Options")}],relaySteps:[{name:"general",title:this.$gettext("General")},{name:"dns",title:this.$gettext("DNS")},{name:"limitations",title:this.$gettext("Limitations")},{name:"transport",title:this.$gettext("Transport")}]}},mounted:function(){this.initDomain()},methods:{copyPassword:function(){var t=this;navigator.clipboard.writeText(this.domain.domain_admin.password).then((function(){c["bus"].$emit("notification",{msg:t.$gettext("Password copied to clipboard")})}))},initDomain:function(){this.domain={name:"",type:"domain",enabled:!0,enable_dns_checks:!0,enable_dkim:!1,dkim_key_selector:"modoboa",quota:0,default_mailbox_quota:0,domain_admin:{username:"admin",with_random_password:!1,with_mailbox:!1,with_aliases:!1},transport:{}}},close:function(){this.initDomain(),this.$emit("close")},getObserver:function(t){return this.$refs["form_".concat(t)].$refs.observer},validateDomain:function(){},updateCreateAdmin:function(t){this.createAdmin=t},submit:function(){var t=this,e=JSON.parse(JSON.stringify(this.domain));this.createAdmin||delete e.domain_admin,"relaydomain"===e.type?this.$refs.form_4.checkSettingTypes(e):delete e.transport,this.$store.dispatch("domains/createDomain",e).then((function(e){t.$router.push({name:"DomainDetail",params:{id:e.data.pk}}),c["bus"].$emit("notification",{msg:t.$gettext("Domain created")}),t.close()}))}}},J=B,P=(a("e299"),a("62ad")),W=a("132d"),z=a("0fd9"),G=Object(f["a"])(J,D,C,!1,null,null,null),K=G.exports;v()(G,{VBtn:_["a"],VCol:P["a"],VIcon:W["a"],VRow:z["a"]});var U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"mt-6"},[a("v-toolbar",{attrs:{flat:""}},[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({attrs:{small:""}},"v-btn",n,!1),i),[t._v(" Actions "),a("v-icon",{attrs:{right:""}},[t._v("mdi-chevron-down")])],1)]}}])},[a("v-list",{attrs:{dense:""}})],1),a("v-spacer"),a("v-text-field",{attrs:{"prepend-inner-icon":"mdi-magnify",placeholder:"Search",filled:"",outlined:"",dense:"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.domains,search:t.search,"item-key":"name","show-select":"","single-expand":"",expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e},"item-expanded":t.loadAliases,"click:row":t.showAliases},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item,n=e.isExpanded,s=e.expand;return[a("tr",[a("td",[a("v-checkbox")],1),a("td",[a("router-link",{attrs:{to:{name:"DomainDetail",params:{id:i.pk}}}},[t._v(" "+t._s(i.name)+" ")]),"relaydomain"===i.type?a("v-chip",{staticClass:"ml-2",attrs:{small:"",color:"primary"}},[a("translate",[t._v("Relay")])],1):t._e(),i.enabled?t._e():a("translate",{staticClass:"ml-2 grey--text"},[t._v("(disabled)")])],1),a("td",[t._v(" "+t._s(i.domainalias_count)+" aliases "),i.domainalias_count?a("v-btn",{attrs:{icon:""},on:{click:function(t){return s(!n)}}},[a("v-icon",n?[t._v("mdi-chevron-up")]:[t._v("mdi-chevron-down")])],1):t._e()],1),a("td",[a("dns-status-chip",{attrs:{status:i.dns_global_status}})],1),a("td",[a("v-progress-linear",{model:{value:i.allocated_quota_in_percent,callback:function(e){t.$set(i,"allocated_quota_in_percent",e)},expression:"item.allocated_quota_in_percent"}})],1),a("td",[a("v-progress-linear",{model:{value:i.allocated_quota_in_percent,callback:function(e){t.$set(i,"allocated_quota_in_percent",e)},expression:"item.allocated_quota_in_percent"}})],1),a("td",[a("div",{staticClass:"text-right"},[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",n,!1),i),[a("v-icon",[t._v("mdi-dots-horizontal")])],1)]}}],null,!0)},[a("menu-items",{attrs:{items:t.domainMenuItems,object:i}})],1)],1)])])]}},{key:"expanded-item",fn:function(e){var i=e.headers,n=e.item;return[a("tr",{staticClass:"grey lighten-4"},[a("td",{attrs:{colspan:i.length}},t._l(t.aliases[n.name],(function(e){return a("span",{key:e.name,staticClass:"mr-4"},[a("a",{staticClass:"mr-2",attrs:{href:"#"},on:{click:function(a){return t.editDomainAlias(n,e)}}},[t._v(t._s(e.name))]),a("v-chip",{attrs:{"x-small":"",color:"success"}},[t._v("DNS OK")])],1)})),0)])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),a("confirm-dialog",{ref:"confirm"},[a("v-checkbox",{attrs:{label:t._f("translate")("Do not delete domain folder"),"hide-details":""},model:{value:t.keepDomainFolder,callback:function(e){t.keepDomainFolder=e},expression:"keepDomainFolder"}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:t.showAliasForm,callback:function(e){t.showAliasForm=e},expression:"showAliasForm"}},[a("domain-alias-form",{attrs:{"domain-alias":t.selectedDomainAlias},on:{close:t.closeDomainAliasForm,"alias-created":t.domainAliasCreated,"alias-deleted":t.domainAliasDeleted}})],1),a("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:t.showAdminList,callback:function(e){t.showAdminList=e},expression:"showAdminList"}},[a("administrator-list",{attrs:{domain:t.selectedDomain,"dialog-mode":""},on:{close:function(e){t.showAdminList=!1}}})],1)],1)},Q=[],Y=(a("4de4"),a("07d7")),H=a("448e"),X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-chip",{attrs:{color:t.chipType,small:""}},[t._v(" "+t._s(t.label)+" ")])},Z=[],tt={props:["status"],computed:{label:function(){return"disabled"===this.status?this.$gettext("Disabled"):"pending"===this.status?this.$gettext("Pending"):"critical"===this.status?this.$gettext("Problem"):"ok"===this.status?this.$gettext("Valid"):this.$gettext("Unknown")},chipType:function(){return"disabled"===this.status?"":"pending"===this.status?"info":"critical"===this.status?"error":"ok"===this.status?"success":"warning"}}},et=tt,at=a("cc20"),it=Object(f["a"])(et,X,Z,!1,null,null,null),nt=it.exports;v()(it,{VChip:at["a"]});var st=a("bc77"),ot={components:{AdministratorList:Y["a"],ConfirmDialog:H["a"],"dns-status-chip":nt,DomainAliasForm:$,MenuItems:st["a"]},computed:Object(m["b"])({domains:"domains/domains"}),data:function(){return{domainMenuItems:[{label:this.$gettext("Administrators"),icon:"mdi-account-supervisor",onClick:this.openAdminList},{label:this.$gettext("Edit"),icon:"mdi-circle-edit-outline",onClick:this.editDomain},{label:this.$gettext("Delete"),icon:"mdi-delete-outline",onClick:this.deleteDomain,color:"red"}],headers:[{text:this.$gettext("Name"),value:"name"},{text:this.$gettext("Aliases"),value:"domainalias_count"},{text:this.$gettext("DNS status"),value:"dns_global_status",sortable:!1,align:"center"},{text:this.$gettext("Sending limit"),value:"message_limit"},{text:this.$gettext("Quota"),value:"allocated_quota_in_percent"},{text:this.$gettext("Actions"),value:"actions",sortable:!1,align:"right"}],keepDomainFolder:!1,selectedDomain:null,selectedDomainAlias:null,showAdminList:!1,showConfirmDialog:!1,showAliasForm:!1,search:"",selected:[],expanded:[],aliases:{}}},created:function(){this.$store.dispatch("domains/getDomains")},methods:{closeDomainAliasForm:function(){this.showAliasForm=!1,this.selectedDomain=null,this.selectedDomainAlias=null},deleteDomain:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$refs.confirm.open(e.$gettext("Warning"),e.$gettextInterpolate("Do you really want to delete the domain %{ domain }?",{domain:t.name}),{color:"error",cancelLabel:e.$gettext("No"),agreeLabel:e.$gettext("Yes")});case 2:if(i=a.sent,i){a.next=5;break}return a.abrupt("return");case 5:n={keep_folder:e.keepDomainFolder},e.$store.dispatch("domains/deleteDomain",{id:t.pk,data:n}).then((function(t){c["bus"].$emit("notification",{msg:e.$gettext("Domain deleted")}),e.keepDomainFolder=!1}));case 7:case"end":return a.stop()}}),a)})))()},domainAliasCreated:function(t){this.$store.dispatch("domains/getDomains")},domainAliasDeleted:function(){var t=this,e=this.aliases[this.selectedDomain.name].filter((function(e){return e.pk!==t.selectedDomainAlias.pk}));this.$set(this.aliases,this.selectedDomain.name,e),e.length||(this.expanded=[]),this.$store.dispatch("domains/getDomains"),this.closeDomainAliasForm()},editDomain:function(t){this.$router.push({name:"DomainEdit",params:{id:t.pk}})},editDomainAlias:function(t,e){this.selectedDomain=t,this.selectedDomainAlias=e,this.showAliasForm=!0},loadAliases:function(t){var e=this,a=t.item,i=t.value;i&&s["a"].getDomainAliases(a.name).then((function(t){e.$set(e.aliases,a.name,t.data)}))},openAdminList:function(t){this.selectedDomain=t,this.showAdminList=!0},showAliases:function(t){this.expanded=[{item:t}]}}},rt=ot,lt=(a("7d38"),a("ac7c")),dt=a("8fea"),mt=a("169a"),ct=a("8860"),ut=a("e449"),ht=a("8e36"),ft=a("71d9"),pt=Object(f["a"])(rt,U,Q,!1,null,"a8cd6aa0",null),vt=pt.exports;v()(pt,{VBtn:_["a"],VCard:b["a"],VCheckbox:lt["a"],VChip:at["a"],VDataTable:dt["a"],VDialog:mt["a"],VIcon:W["a"],VList:ct["a"],VMenu:ut["a"],VProgressLinear:ht["a"],VSpacer:k["a"],VTextField:y["a"],VToolbar:ft["a"]});var _t=a("2d4e"),bt=a("89a2"),xt={mixins:[_t["a"]],components:{DomainAliasForm:$,DomainCreationForm:K,DomainList:vt,ImportForm:bt["a"]},data:function(){return{showAliasForm:!1,showDomainWizard:!1,showImportForm:!1}},methods:{exportDomains:function(){var t=this;s["a"].exportAll().then((function(e){t.exportContent(e.data,"domains")}))},importDomains:function(t){this.importContent(s["a"],t)}}},gt=xt,kt=(a("8d16"),a("da13")),At=a("5d23"),yt=a("2a7f"),wt=Object(f["a"])(gt,i,n,!1,null,"eaa2cca2",null);e["default"]=wt.exports;v()(wt,{VBtn:_["a"],VDialog:mt["a"],VIcon:W["a"],VList:ct["a"],VListItem:kt["a"],VListItemTitle:At["b"],VMenu:ut["a"],VSpacer:k["a"],VToolbar:ft["a"],VToolbarTitle:yt["a"]})},3011:function(t,e,a){},3873:function(t,e,a){},"7d38":function(t,e,a){"use strict";a("e141")},"8d16":function(t,e,a){"use strict";a("3011")},e141:function(t,e,a){},e299:function(t,e,a){"use strict";a("3873")}}]);
//# sourceMappingURL=chunk-7fedb6fc.ba02ee69.js.map