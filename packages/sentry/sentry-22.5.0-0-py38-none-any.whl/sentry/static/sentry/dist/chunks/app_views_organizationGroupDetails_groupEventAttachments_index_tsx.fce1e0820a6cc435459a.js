(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationGroupDetails_groupEventAttachments_index_tsx"],{"./app/components/acl/role.tsx":(e,t,s)=>{"use strict";s.d(t,{u:()=>i});var n=s("../node_modules/react/index.js"),o=s("./app/stores/configStore.tsx"),a=s("./app/utils/isActiveSuperuser.tsx"),r=s("./app/utils/isRenderFunc.tsx");const i=(0,s("./app/utils/withOrganization.tsx").Z)((function(e){let{role:t,organization:s,children:i}=e;const l=o.Z.get("user"),d=(0,n.useMemo)((()=>function(e,t,s){var n,o;if(!e)return!1;if((0,a.M)())return!0;if(!Array.isArray(t.availableRoles))return!1;const r=t.availableRoles.map((e=>e.id));if(!r.includes(s)||!r.includes(null!==(n=t.role)&&void 0!==n?n:""))return!1;const i=r.indexOf(s);return r.indexOf(null!==(o=t.role)&&void 0!==o?o:"")>=i}(l,s,t)),[s,t,l]);return(0,r.l)(i)?i({hasRole:d}):d?i:null}))},"./app/components/events/eventAttachmentActions.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react/index.js"),a=s("./app/components/button.tsx"),r=s("./app/components/buttonBar.tsx"),i=s("./app/components/confirm.tsx"),l=s("./app/icons/index.tsx"),d=s("./app/locale.tsx"),c=s("./app/styles/space.tsx"),p=s("./app/utils/withApi.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class u extends o.Component{handlePreview(){const{onPreview:e,attachmentId:t}=this.props;e&&e(t)}render(){const{url:e,withPreviewButton:t,hasPreview:s,previewIsOpen:n,onDelete:o,attachmentId:c}=this.props;return(0,m.BX)(r.ZP,{gap:1,children:[(0,m.tZ)(i.Z,{confirmText:(0,d.t)("Delete"),message:(0,d.t)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:()=>o(c),disabled:!e,children:(0,m.tZ)(a.ZP,{size:"xsmall",icon:(0,m.tZ)(l.Fz,{size:"xs"}),"aria-label":(0,d.t)("Delete"),disabled:!e,title:e?void 0:(0,d.t)("Insufficient permissions to delete attachments")})}),(0,m.tZ)(h,{size:"xsmall",icon:(0,m.tZ)(l.Dj,{size:"xs"}),href:e?`${e}?download=1`:"",disabled:!e,title:e?void 0:(0,d.t)("Insufficient permissions to download attachments"),"aria-label":(0,d.t)("Download")}),t&&(0,m.tZ)(h,{size:"xsmall",disabled:!e||!s,priority:n?"primary":"default",icon:(0,m.tZ)(l.fn,{size:"xs"}),onClick:()=>this.handlePreview(),title:e?s?void 0:(0,d.t)("This attachment cannot be previewed"):(0,d.t)("Insufficient permissions to preview attachments"),children:(0,d.t)("Preview")})]})}}u.displayName="EventAttachmentActions";const h=(0,n.Z)(a.ZP,{target:"erg6n450"})("margin-right:",(0,c.Z)(.5),";"),v=(0,p.Z)(u)},"./app/components/fileSize.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("./app/utils.tsx"),a=s("./app/utils/getDynamicText.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){const{className:t,bytes:s}=e;return(0,r.tZ)(l,{className:t,children:(0,a.Z)({value:(0,o.F)(s),fixed:"xx KB"})})}i.displayName="FileSize";const l=(0,n.Z)("span",{target:"e1xn0mc30"})({name:"kow0uz",styles:"font-variant-numeric:tabular-nums"}),d=i},"./app/utils/attachmentUrl.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s("../node_modules/react/index.js"),o=s("./app/components/acl/role.tsx"),a=s("./app/utils/withOrganization.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{attachment:t,organization:s,eventId:n,projectId:a,children:i}=e;return(0,r.tZ)(o.u,{role:s.attachmentsRole,children:e=>{let{hasRole:o}=e;return i(o?`/api/0/projects/${s.slug}/${a}/events/${n}/attachments/${t.id}/`:null)}})}i.displayName="AttachmentUrl";const l=(0,a.Z)((0,n.memo)(i))},"./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx":(e,t,s)=>{"use strict";s.d(t,{M:()=>h,Z:()=>Z});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react-router/es/index.js"),a=s("../node_modules/lodash/omit.js"),r=s.n(a),i=s("../node_modules/lodash/xor.js"),l=s.n(i),d=s("./app/components/button.tsx"),c=s("./app/components/buttonBar.tsx"),p=s("./app/locale.tsx"),m=s("./app/styles/space.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h=["event.minidump","event.applecrashreport"],v=e=>{const{query:t,pathname:s}=e.location,{types:n}=t,o=r()(t,"types"),a={...t,types:h};let i="";return void 0===n?i="all":0===l()(h,n).length&&(i="onlyCrash"),(0,u.tZ)(x,{children:(0,u.BX)(c.ZP,{merged:!0,active:i,children:[(0,u.tZ)(d.ZP,{barId:"all",size:"small",to:{pathname:s,query:o},children:(0,p.t)("All Attachments")}),(0,u.tZ)(d.ZP,{barId:"onlyCrash",size:"small",to:{pathname:s,query:a},children:(0,p.t)("Only Crash Reports")})]})})};v.displayName="GroupEventAttachmentsFilter";const x=(0,n.Z)("div",{target:"eftnont0"})("display:flex;justify-content:flex-end;margin-bottom:",(0,m.Z)(3),";"),Z=(0,o.withRouter)(v)},"./app/views/organizationGroupDetails/groupEventAttachments/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var n=s("./app/components/acl/feature.tsx"),o=s("./app/components/acl/featureDisabled.tsx"),a=s("./app/utils/withOrganization.tsx"),r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react-router/es/index.js")),l=s("../node_modules/lodash/pick.js"),d=s.n(l),c=s("./app/actionCreators/indicator.tsx"),p=s("./app/components/asyncComponent.tsx"),m=s("./app/components/emptyStateWarning.tsx"),u=s("./app/components/layouts/thirds.tsx"),h=s("./app/components/loadingIndicator.tsx"),v=s("./app/components/pagination.tsx"),x=s("./app/components/panels/index.tsx"),Z=s("./app/locale.tsx"),y=s("./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx"),g=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),b=s("./app/components/dateTime.tsx"),j=s("./app/components/events/eventAttachmentActions.tsx"),f=s("./app/components/fileSize.tsx"),_=s("./app/components/links/link.tsx"),w=s("./app/utils/attachmentUrl.tsx");const A={"event.minidump":(0,Z.t)("Minidump"),"event.applecrashreport":(0,Z.t)("Apple Crash Report"),"event.attachment":(0,Z.t)("Other")};var I=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const D=e=>{let{attachment:t,projectId:s,onDelete:n,isDeleted:o,orgId:a,groupId:r}=e;return(0,I.BX)(z,{isDeleted:o,children:[(0,I.tZ)("td",{children:(0,I.BX)("h5",{children:[t.name,(0,I.tZ)("br",{}),(0,I.BX)("small",{children:[(0,I.tZ)(b.Z,{date:t.dateCreated})," Â·"," ",(0,I.tZ)(_.Z,{to:`/organizations/${a}/issues/${r}/events/${t.event_id}/`,children:t.event_id})]})]})}),(0,I.tZ)("td",{children:A[t.type]||(0,Z.t)("Other")}),(0,I.tZ)("td",{children:(0,I.tZ)(f.Z,{bytes:t.size})}),(0,I.tZ)("td",{children:(0,I.tZ)(E,{children:(0,I.tZ)(w.Z,{projectId:s,eventId:t.event_id,attachment:t,children:e=>o?null:(0,I.tZ)(j.Z,{url:e,onDelete:n,attachmentId:t.id})})})})]})};D.displayName="GroupEventAttachmentsTableRow";const z=(0,g.Z)("tr",{target:"egfj2n61"})("opacity:",(e=>e.isDeleted?.3:1),";td{text-decoration:",(e=>e.isDeleted?"line-through":"normal"),";}"),E=(0,g.Z)("div",{target:"egfj2n60"})({name:"1r5gb7q",styles:"display:inline-block"}),N=D,B=e=>{let{attachments:t,orgId:s,projectId:n,groupId:o,onDelete:a,deletedAttachments:r}=e;const i=[(0,Z.t)("Name"),(0,Z.t)("Type"),(0,Z.t)("Size"),(0,Z.t)("Actions")];return(0,I.BX)("table",{className:"table events-table",children:[(0,I.tZ)("thead",{children:(0,I.tZ)("tr",{children:i.map((e=>(0,I.tZ)("th",{children:e},e)))})}),(0,I.tZ)("tbody",{children:t.map((e=>(0,I.tZ)(N,{attachment:e,orgId:s,projectId:n,groupId:o,onDelete:a,isDeleted:r.some((t=>e.id===t))},e.id)))})]})};B.displayName="GroupEventAttachmentsTable";const P=B;class S extends p.Z{constructor(){super(...arguments),(0,r.Z)(this,"handleDelete",(async e=>{var t,s;const{params:n,projectSlug:o}=this.props,a=null===(t=this.state)||void 0===t||null===(s=t.eventAttachments)||void 0===s?void 0:s.find((t=>t.id===e));if(a){this.setState((t=>({deletedAttachments:[...t.deletedAttachments,e]})));try{await this.api.requestPromise(`/projects/${n.orgId}/${o}/events/${a.event_id}/attachments/${a.id}/`,{method:"DELETE"})}catch(e){(0,c.Iw)("An error occurred while deleteting the attachment")}}}))}getDefaultState(){return{...super.getDefaultState(),deletedAttachments:[]}}getEndpoints(){const{params:e,location:t}=this.props;return[["eventAttachments",`/issues/${e.groupId}/attachments/`,{query:{...d()(t.query,["cursor","environment","types"]),limit:50}}]]}renderNoQueryResults(){return(0,I.tZ)(m.Z,{children:(0,I.tZ)("p",{children:(0,Z.t)("Sorry, no event attachments match your search query.")})})}renderEmpty(){return(0,I.tZ)(m.Z,{children:(0,I.tZ)("p",{children:(0,Z.t)("There don't seem to be any event attachments yet.")})})}renderLoading(){return this.renderBody()}renderInnerBody(){const{projectSlug:e,params:t,location:s}=this.props,{loading:n,eventAttachments:o,deletedAttachments:a}=this.state;return n?(0,I.tZ)(h.Z,{}):o&&o.length>0?(0,I.tZ)(P,{attachments:o,orgId:t.orgId,projectId:e,groupId:t.groupId,onDelete:this.handleDelete,deletedAttachments:a}):s.query.types?this.renderNoQueryResults():this.renderEmpty()}renderBody(){return(0,I.tZ)(u.uT,{children:(0,I.BX)(u.or,{fullWidth:!0,children:[(0,I.tZ)(y.Z,{}),(0,I.tZ)(x.s_,{className:"event-list",children:(0,I.tZ)(x.N,{children:this.renderInnerBody()})}),(0,I.tZ)(v.Z,{pageLinks:this.state.eventAttachmentsPageLinks})]})})}}const C=(0,i.withRouter)(S),R=e=>{let{organization:t,group:s}=e;return(0,I.tZ)(n.Z,{features:["event-attachments"],organization:t,renderDisabled:e=>(0,I.tZ)(o.Z,{...e,featureName:"Event Attachments"}),children:(0,I.tZ)(C,{projectSlug:s.project.slug})})};R.displayName="GroupEventAttachmentsContainer";const k=(0,a.Z)(R)},"../node_modules/lodash/_baseDifference.js":(e,t,s)=>{var n=s("../node_modules/lodash/_SetCache.js"),o=s("../node_modules/lodash/_arrayIncludes.js"),a=s("../node_modules/lodash/_arrayIncludesWith.js"),r=s("../node_modules/lodash/_arrayMap.js"),i=s("../node_modules/lodash/_baseUnary.js"),l=s("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,s,d){var c=-1,p=o,m=!0,u=e.length,h=[],v=t.length;if(!u)return h;s&&(t=r(t,i(s))),d?(p=a,m=!1):t.length>=200&&(p=l,m=!1,t=new n(t));e:for(;++c<u;){var x=e[c],Z=null==s?x:s(x);if(x=d||0!==x?x:0,m&&Z==Z){for(var y=v;y--;)if(t[y]===Z)continue e;h.push(x)}else p(t,Z,d)||h.push(x)}return h}},"../node_modules/lodash/_baseXor.js":(e,t,s)=>{var n=s("../node_modules/lodash/_baseDifference.js"),o=s("../node_modules/lodash/_baseFlatten.js"),a=s("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,s){var r=e.length;if(r<2)return r?a(e[0]):[];for(var i=-1,l=Array(r);++i<r;)for(var d=e[i],c=-1;++c<r;)c!=i&&(l[i]=n(l[i]||d,e[c],t,s));return a(o(l,1),t,s)}},"../node_modules/lodash/xor.js":(e,t,s)=>{var n=s("../node_modules/lodash/_arrayFilter.js"),o=s("../node_modules/lodash/_baseRest.js"),a=s("../node_modules/lodash/_baseXor.js"),r=s("../node_modules/lodash/isArrayLikeObject.js"),i=o((function(e){return a(n(e,r))}));e.exports=i}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationGroupDetails_groupEventAttachments_index_tsx.d1fd8bef0edb95fa9fd76f9c8adb9ee9.js.map