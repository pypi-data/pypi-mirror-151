"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/debounce.js"),n=s.n(o),m=s("./app/actionCreators/indicator.tsx"),d=s("./app/actionCreators/modal.tsx"),p=s("./app/actionCreators/teams.tsx"),l=s("./app/components/avatar/userAvatar.tsx"),c=s("./app/components/button.tsx"),h=s("./app/components/dropdownAutoComplete/index.tsx"),u=s("./app/components/dropdownButton.tsx"),b=s("./app/components/idBadge/index.tsx"),g=s("./app/components/links/link.tsx"),Z=s("./app/components/loadingError.tsx"),M=s("./app/components/loadingIndicator.tsx"),w=s("./app/components/panels/index.tsx"),x=s("./app/icons/index.tsx"),y=s("./app/locale.tsx"),v=s("./app/styles/overflowEllipsis.tsx"),f=s("./app/styles/space.tsx"),I=s("./app/utils/withApi.tsx"),S=s("./app/utils/withConfig.tsx"),z=s("./app/utils/withOrganization.tsx"),k=s("./app/views/settings/components/emptyMessage.tsx"),B=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class C extends i.Component{constructor(){super(...arguments),(0,a.Z)(this,"state",{loading:!0,error:!1,dropdownBusy:!1,teamMemberList:[],orgMemberList:[]}),(0,a.Z)(this,"debouncedFetchMembersRequest",n()((e=>this.setState({dropdownBusy:!0},(()=>this.fetchMembersRequest(e)))),200)),(0,a.Z)(this,"fetchMembersRequest",(async e=>{const{params:t,api:s}=this.props,{orgId:a}=t;try{const t=await s.requestPromise(`/organizations/${a}/members/`,{query:{query:e}});this.setState({orgMemberList:t,dropdownBusy:!1})}catch(e){(0,m.Iw)((0,y.t)("Unable to load organization members."),{duration:2e3}),this.setState({dropdownBusy:!1})}})),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,params:t}=this.props;try{const s=await e.requestPromise(`/teams/${t.orgId}/${t.teamId}/members/`);this.setState({teamMemberList:s,loading:!1,error:!1})}catch(e){this.setState({loading:!1,error:!0})}this.fetchMembersRequest("")})),(0,a.Z)(this,"addTeamMember",(e=>{const{params:t}=this.props;this.setState({loading:!0}),this.debouncedFetchMembersRequest(""),(0,p.um)(this.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.value},{success:()=>{const t=this.state.orgMemberList.find((t=>t.id===e.value));void 0!==t&&(this.setState({loading:!1,error:!1,teamMemberList:this.state.teamMemberList.concat([t])}),(0,m.S9)((0,y.t)("Successfully added member to team.")))},error:()=>{this.setState({loading:!1}),(0,m.Iw)((0,y.t)("Unable to add team member."))}})})),(0,a.Z)(this,"handleMemberFilterChange",(e=>{this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)}))}componentDidMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){const t=this.props.params;e.params.teamId===t.teamId&&e.params.orgId===t.orgId||this.setState({loading:!0,error:!1},this.fetchData)}removeMember(e){const{params:t}=this.props;(0,p.s)(this.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.id},{success:()=>{this.setState({teamMemberList:this.state.teamMemberList.filter((t=>t.id!==e.id))}),(0,m.S9)((0,y.t)("Successfully removed member from team."))},error:()=>(0,m.Iw)((0,y.t)("There was an error while trying to remove a member from the team."))})}renderDropdown(e){const{organization:t,params:s}=this.props,a=new Set(this.state.teamMemberList.map((e=>e.id))),r=!(null==t||!t.openMembership)||e,i=(this.state.orgMemberList||[]).filter((e=>!a.has(e.id))).map((e=>({searchKey:`${e.name} ${e.email}`,value:e.id,label:(0,B.BX)(q,{children:[(0,B.tZ)(R,{user:e,size:24,className:"avatar"}),(0,B.tZ)(_,{children:e.name||e.email})]})}))),o=(0,B.BX)(T,{children:[(0,y.t)("Members"),(0,B.tZ)(j,{to:"",onClick:()=>(0,d.openInviteMembersModal)({source:"teams"}),"data-test-id":"invite-member",children:(0,y.t)("Invite Member")})]});return(0,B.tZ)(h.Z,{items:i,alignMenu:"right",onSelect:r?this.addTeamMember:e=>(0,d.openTeamAccessRequestModal)({teamId:s.teamId,orgId:s.orgId,memberId:e.value}),menuHeader:o,emptyMessage:(0,y.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:()=>this.debouncedFetchMembersRequest(""),children:e=>{let{isOpen:t}=e;return(0,B.tZ)(u.Z,{isOpen:t,size:"xsmall","data-test-id":"add-member",children:(0,y.t)("Add Member")})}})}removeButton(e){return(0,B.tZ)(c.ZP,{size:"small",icon:(0,B.tZ)(x.JZ,{size:"xs",isCircled:!0}),onClick:()=>this.removeMember(e),"aria-label":(0,y.t)("Remove"),children:(0,y.t)("Remove")})}render(){if(this.state.loading)return(0,B.tZ)(M.Z,{});if(this.state.error)return(0,B.tZ)(Z.Z,{onRetry:this.fetchData});const{params:e,organization:t,config:s}=this.props,{access:a}=t,r=a.includes("org:write")||a.includes("team:admin");return(0,B.BX)(w.s_,{children:[(0,B.BX)(w.V9,{hasButtons:!0,children:[(0,B.tZ)("div",{children:(0,y.t)("Members")}),(0,B.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(r)})]}),this.state.teamMemberList.length?this.state.teamMemberList.map((t=>{const a=t.email===s.user.email,i=r||a;return(0,B.BX)(L,{children:[(0,B.tZ)(b.Z,{avatarSize:36,member:t,useLink:!0,orgId:e.orgId}),i&&this.removeButton(t)]},t.id)})):(0,B.tZ)(k.Z,{icon:(0,B.tZ)(x.qO,{size:"xl"}),size:"large",children:(0,y.t)("This team has no members")})]})}}C.displayName="TeamMembers";const L=(0,r.Z)(w.Lv,{target:"ekipw4c5"})({name:"zanomh",styles:"justify-content:space-between;align-items:center"}),q=(0,r.Z)("div",{target:"ekipw4c4"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,f.Z)(.5),";align-items:center;"),_=(0,r.Z)("div",{target:"ekipw4c3"})("font-size:",(e=>e.theme.fontSizeSmall),";",v.Z,";"),R=(0,r.Z)((e=>(0,B.tZ)(l.Z,{...e})),{target:"ekipw4c2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),T=(0,r.Z)("div",{target:"ekipw4c1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,f.Z)(1)," 0;font-size:",(e=>e.theme.fontSizeExtraSmall),";text-transform:uppercase;"),j=(0,r.Z)(g.Z,{target:"ekipw4c0"})({name:"kxbue8",styles:"text-transform:none"}),D=(0,S.Z)((0,I.Z)((0,z.Z)(C)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.cab0dae1d9c939bef9929d58cdb383b5.js.map