"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_traceDetails_traceView_tsx"],{"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{r.d(t,{Z:()=>l});var n=r("./app/utils/withApi.tsx"),s=r("./app/utils/discover/genericDiscoverQuery.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){return(0,i.tZ)(s.ZP,{route:"eventsv2",shouldRefetchData:o,...e})}a.displayName="DiscoverQuery";const l=(0,n.Z)(a)},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,r)=>{r.d(t,{o:()=>d,AA:()=>h,ZP:()=>m});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),i=r("./app/locale.tsx"),o=r("./app/utils/discover/eventView.tsx"),a=r("./app/utils/performance/contexts/performanceEventViewContext.tsx"),l=r("./app/views/organizationContext.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class d{constructor(e,t){(0,n.Z)(this,"message",void 0),(0,n.Z)(this,"originalError",void 0),this.message=e,this.originalError=t}getOriginalError(){return this.originalError}}class p extends s.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null}),(0,n.Z)(this,"_shouldRefetchData",(e=>{const t=this.getPayload(this.props),r=this.getPayload(e);return!(0,o.ze)(t,r)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,n.Z)(this,"_parseError",(e=>{var t;if(this.props.parseError)return this.props.parseError(e);if(!e)return null;const r=null===(t=e.responseJSON)||void 0===t?void 0:t.detail;if("string"==typeof r)return new d(r,e);const n=null==r?void 0:r.message;return new d("string"==typeof n?n:(0,i.t)("An unknown error occurred."),e)})),(0,n.Z)(this,"fetchData",(async()=>{const{api:e,beforeFetch:t,afterFetch:r,didFetch:n,eventView:s,orgSlug:i,route:o,setError:a}=this.props;if(!s.isValid())return;const l=`/organizations/${i}/${o}/`,c=Symbol("tableFetchID"),d=this.getPayload(this.props);this.setState({isLoading:!0,tableFetchID:c}),null==a||a(void 0),null==t||t(e),e.clear();try{const[t,,s]=await h(e,l,d);if(this.state.tableFetchID!==c)return;const i=r?r(t,this.props):t;null==n||n(i),this.setState((e=>{var t;return{isLoading:!1,tableFetchID:void 0,error:null,pageLinks:null!==(t=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==t?t:e.pageLinks,tableData:i}}))}catch(e){const t=this._parseError(e);this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),a&&a(null!=t?t:void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),r=!1===e.eventView.isValid()&&this.props.eventView.isValid(),n=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||r||n)&&this.fetchData()}getPayload(e){var t;const{cursor:r,limit:n,noPagination:s,referrer:i}=e,o=this.props.getRequestPayload?this.props.getRequestPayload(e):e.eventView.getEventsAPIPayload(e.location);return r&&(o.cursor=r),n&&(o.per_page=n),s&&(o.noPagination=s),i&&(o.referrer=i),Object.assign(o,null!==(t=e.queryExtras)&&void 0!==t?t:{}),o}render(){const{isLoading:e,error:t,tableData:r,pageLinks:n}=this.state,s={isLoading:e,error:t,tableData:r,pageLinks:n},i=this.props.children;return null==i?void 0:i(s)}}function u(e){var t,r,n,i;const o=null===(t=(0,s.useContext)(l.g))||void 0===t?void 0:t.slug,d=null===(r=(0,s.useContext)(a.uL))||void 0===r?void 0:r.eventView,u=null!==(n=e.orgSlug)&&void 0!==n?n:o,h=null!==(i=e.eventView)&&void 0!==i?i:d;if(void 0===u||void 0===h)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const m={...e,orgSlug:u,eventView:h};return(0,c.tZ)(p,{...m})}async function h(e,t,r){return e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...r}})}p.displayName="_GenericDiscoverQuery",u.displayName="GenericDiscoverQuery";const m=u},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,r)=>{r.d(t,{bq:()=>s,uL:()=>o}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("./app/utils/performance/contexts/utils.tsx");const[s,i,o]=(0,n.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(e,t,r)=>{r.d(t,{n:()=>s});var n=r("../node_modules/react/index.js");function s(e){const{strict:t=!0,errorMessage:r=`useContext for "${e.name}" must be inside a Provider with a value`,name:s}=e,i=(0,n.createContext)(void 0);return i.displayName=s,[i.Provider,function(){const e=(0,n.useContext)(i);if(!e&&t)throw new Error(r);return e},i]}},"./app/views/performance/traceDetails/styles.tsx":(e,t,r)=>{r.d(t,{X2:()=>m.X2,qD:()=>m.iF,CB:()=>m.wh,pH:()=>g,Iq:()=>v,cC:()=>f,Z9:()=>x,W3:()=>Z,uI:()=>w,LA:()=>b,RB:()=>y,$G:()=>T});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=r("./app/components/events/eventTags/eventTagsPill.tsx"),i=r("./app/components/events/interfaces/spans/header.tsx"),o=r("./app/components/panels/index.tsx"),a=r("./app/components/pills.tsx"),l=r("./app/components/searchBar.tsx"),c=r("./app/styles/space.tsx"),d=r("./app/utils.tsx"),p=r("./app/utils/queryString.tsx"),u=r("./app/views/performance/transactionSummary/utils.tsx"),h=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),m=r("./app/components/events/interfaces/spans/spanDetail.tsx");const g=(0,n.Z)("div",{target:"euzgho58"})({name:"7whenc",styles:"display:flex;width:100%"}),v=(0,n.Z)(l.Z,{target:"euzgho57"})({name:"1ff36h2",styles:"flex-grow:1"}),f=(0,n.Z)(i.i,{target:"euzgho56"})("position:static;top:auto;border-top:none;border-bottom:1px solid ",(e=>e.theme.border),";"),x=(0,n.Z)("div",{target:"euzgho55"})("display:grid;grid-template-columns:1fr;gap:",(0,c.Z)(3),";margin-bottom:",(0,c.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[1]),"){grid-template-columns:max-content max-content;grid-row-gap:0;}"),Z=(0,n.Z)("div",{target:"euzgho54"})("margin-top:",(0,c.Z)(2),";"),w=(0,n.Z)("div",{target:"euzgho53"})({name:"1wr20zt",styles:"overflow-x:hidden;border-bottom-left-radius:3px;border-bottom-right-radius:3px"}),b=(0,n.Z)(o.s_,{target:"euzgho52"})({name:"d3v9zr",styles:"overflow:hidden"}),y=(0,n.Z)("span",{target:"euzgho51"})("margin-right:",(0,c.Z)(.75),";display:flex;flex-direction:column;justify-content:center;"),D=(0,n.Z)(a.Z,{target:"euzgho50"})("padding-top:",(0,c.Z)(1.5),";");function T(e){let{location:t,organization:r,transaction:n}=e;const{tags:i}=n;if(!i||i.length<=0)return null;const o=r.slug;return(0,h.BX)("tr",{children:[(0,h.tZ)("td",{className:"key",children:"Tags"}),(0,h.tZ)("td",{className:"value",children:(0,h.tZ)(D,{children:i.map(((e,i)=>{const{pathname:a,query:l}=(0,u.e1)({orgSlug:o,transaction:n.transaction,projectID:String(n.project_id),query:{...t.query,query:(0,p.os)(t.query.query,e.key,e.value)}});return(0,h.tZ)(s.Z,{tag:e,projectId:n.project_slug,organization:r,query:l,streamPath:a},(0,d.ri)(e.key)?e.key:`tag-pill-${i}`)}))})})]})}T.displayName="Tags"},"./app/views/performance/traceDetails/traceNotFound.tsx":(e,t,r)=>{r.d(t,{Z:()=>v});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=r("../node_modules/react/index.js"),i=r("./app/components/alert.tsx"),o=r("./app/components/links/link.tsx"),a=r("./app/components/loadingError.tsx"),l=r("./app/components/loadingIndicator.tsx"),c=r("./app/components/performance/waterfall/rowDetails.tsx"),d=r("./app/locale.tsx"),p=r("./app/styles/space.tsx"),u=r("./app/utils/discover/discoverQuery.tsx"),h=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){var t,r;let{meta:n,traceEventView:p,traceSlug:m,organization:v,location:f}=e;const x=null!==(t=null==n?void 0:n.transactions)&&void 0!==t?t:0,Z=null!==(r=null==n?void 0:n.errors)&&void 0!==r?r:0;if(0===x&&Z>0){const e=p.withColumns([{kind:"field",field:"project"},{kind:"field",field:"title"},{kind:"field",field:"issue.id"},{kind:"field",field:"level"}]);return e.query=`trace:${m} !event.type:transaction `,(0,h.tZ)(u.Z,{eventView:e,orgSlug:v.slug,location:f,referrer:"api.trace-view.errors-view",children:e=>{let{isLoading:t,tableData:r,error:n}=e;return t?(0,h.tZ)(l.Z,{}):n?(0,h.tZ)(i.Z,{type:"error",showIcon:!0,children:(0,h.tZ)(g,{children:(0,d._N)("The trace cannot be shown when all events are errors. An error occurred when attempting to fetch these error events: [error]",{error:n.message})})}):(0,h.BX)(i.Z,{type:"error",showIcon:!0,children:[(0,h.tZ)(g,{children:(0,d.t)("The trace cannot be shown when all events are errors.")}),(0,h.tZ)(c.TV,{"data-test-id":"trace-view-errors",children:null==r?void 0:r.data.map((e=>(0,h.BX)(s.Fragment,{children:[(0,h.tZ)(c._U,{level:e.level}),(0,h.tZ)(c.wE,{children:e.level}),(0,h.tZ)(c.St,{children:(0,h.tZ)(o.Z,{to:`/organizations/${v.slug}/issues/${e["issue.id"]}/events/${e.id}`,children:e.title})})]},e.id)))})]})}})}return(0,h.tZ)(a.Z,{message:(0,d.t)("The trace you are looking for was not found.")})}m.displayName="TraceNotFound";const g=(0,n.Z)("div",{target:"etqb06g0"})("margin-bottom:",(0,p.Z)(1),";"),v=m},"./app/views/performance/traceDetails/traceView.tsx":(e,t,r)=>{r.d(t,{Z:()=>le}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("../node_modules/react/index.js"),s=r("../node_modules/@sentry/hub/esm/hub.js"),i=r("./app/components/events/interfaces/spans/anchorLinkManager.tsx"),o=r("./app/components/events/interfaces/spans/dividerHandlerManager.tsx"),a=r("./app/components/events/interfaces/spans/scrollbarManager.tsx"),l=r("./app/components/performance/waterfall/messageRow.tsx"),c=r("./app/components/performance/waterfall/miniHeader.tsx"),d=r("./app/components/performance/waterfall/utils.tsx"),p=r("./app/locale.tsx"),u=r("./app/views/performance/traceDetails/styles.tsx"),h=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),m=r("./app/components/assistant/guideAnchor.tsx"),g=r("./app/components/count.tsx"),v=r("./app/components/idBadge/projectBadge.tsx"),f=r("./app/components/performance/waterfall/constants.tsx"),x=r("./app/components/performance/waterfall/row.tsx"),Z=r("./app/components/performance/waterfall/rowBar.tsx"),w=r("./app/components/performance/waterfall/rowDivider.tsx"),b=r("./app/components/performance/waterfall/rowTitle.tsx"),y=r("./app/components/performance/waterfall/treeConnector.tsx"),D=r("./app/components/tooltip.tsx"),T=r("./app/utils/performance/quickTrace/utils.tsx"),_=r("./app/utils/projects.tsx"),C=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),j=r("../node_modules/react-router/es/index.js"),S=r("../node_modules/lodash/omit.js"),B=r.n(S),I=r("./app/components/alert.tsx"),E=r("./app/components/button.tsx"),V=r("./app/components/dateTime.tsx"),O=r("./app/components/links/link.tsx"),k=r("./app/components/performance/waterfall/rowDetails.tsx"),z=r("./app/components/quickTrace/utils.tsx"),A=r("./app/constants/pageFilters.tsx"),X=r("./app/icons/index.tsx"),L=r("./app/styles/space.tsx"),P=r("./app/utils/discover/urls.tsx"),$=r("./app/utils/getDynamicText.tsx"),H=r("./app/utils/performance/urls.ts"),R=r("./app/utils/performance/vitals/constants.tsx"),M=r("./app/utils/performanceForSentry.tsx"),N=r("./app/views/performance/transactionSummary/utils.tsx"),G=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class q extends n.Component{constructor(){super(...arguments),(0,h.Z)(this,"scrollBarIntoView",(e=>t=>{t.preventDefault();const r=`#txn-${e}`;this.props.scrollToHash(r),j.browserHistory.push({...this.props.location,hash:r})}))}renderTransactionErrors(){const{organization:e,transaction:t}=this.props,{errors:r}=t;return 0===r.length?null:(0,G.tZ)(I.Z,{system:!0,showIcon:!0,type:"error",expand:r.map((t=>(0,G.BX)(k.TV,{children:[(0,G.tZ)(k._U,{level:t.level}),(0,G.tZ)(k.wE,{children:t.level}),(0,G.tZ)(k.St,{children:(0,G.tZ)(O.Z,{to:(0,z.F7)(t,e),children:t.title})})]},t.event_id))),children:(0,G.tZ)(k.CM,{children:(0,p.tn)("An error event occurred in this transaction.","%s error events occurred in this transaction.",r.length)})})}renderGoToTransactionButton(){const{location:e,organization:t,transaction:r}=this.props,n=(0,P.JE)({id:r.event_id,project:r.project_slug}),s=(0,H.D)(t.slug,n,r.transaction,B()(e.query,Object.values(A.V)));return(0,G.tZ)(U,{size:"xsmall",to:s,children:(0,p.t)("View Transaction")})}renderGoToSummaryButton(){const{location:e,organization:t,transaction:r}=this.props,n=(0,N.e1)({orgSlug:t.slug,transaction:r.transaction,query:B()(e.query,Object.values(A.V)),projectID:String(r.project_id)});return(0,G.tZ)(U,{size:"xsmall",to:n,children:(0,p.t)("View Summary")})}renderMeasurements(){const{transaction:e}=this.props,{measurements:t={}}=e,r=Object.keys(t).filter((e=>Boolean(R.r9[`measurements.${e}`]))).sort();return r.length<=0?null:(0,G.tZ)(n.Fragment,{children:r.map((e=>{var r;return(0,G.tZ)(u.X2,{title:null===(r=R.r9[`measurements.${e}`])||void 0===r?void 0:r.name,children:`${Number(t[e].value.toFixed(3)).toLocaleString()}ms`},e)}))})}renderTransactionDetail(){const{location:e,organization:t,transaction:r}=this.props,s=Math.min(r.start_timestamp,r.timestamp),i=Math.max(r.start_timestamp,r.timestamp),o=`${Number((1e3*(i-s)).toFixed(3)).toLocaleString()}ms`;return(0,G.tZ)(u.qD,{children:(0,G.tZ)("table",{className:"table key-value",children:(0,G.BX)("tbody",{children:[(0,G.tZ)(u.X2,{title:(0,G.BX)(F,{onClick:this.scrollBarIntoView(r.event_id),children:["Transaction ID",(0,G.tZ)(Q,{})]}),extra:this.renderGoToTransactionButton(),children:r.event_id}),(0,G.tZ)(u.X2,{title:"Transaction",extra:this.renderGoToSummaryButton(),children:r.transaction}),(0,G.tZ)(u.X2,{title:"Transaction Status",children:r["transaction.status"]}),(0,G.tZ)(u.X2,{title:"Span ID",children:r.span_id}),(0,G.tZ)(u.X2,{title:"Project",children:r.project_slug}),(0,G.tZ)(u.X2,{title:"Start Date",children:(0,$.Z)({fixed:"Mar 19, 2021 11:06:27 AM UTC",value:(0,G.BX)(n.Fragment,{children:[(0,G.tZ)(V.Z,{date:1e3*s}),` (${s})`]})})}),(0,G.tZ)(u.X2,{title:"End Date",children:(0,$.Z)({fixed:"Mar 19, 2021 11:06:28 AM UTC",value:(0,G.BX)(n.Fragment,{children:[(0,G.tZ)(V.Z,{date:1e3*i}),` (${i})`]})})}),(0,G.tZ)(u.X2,{title:"Duration",children:o}),(0,G.tZ)(u.X2,{title:"Operation",children:r["transaction.op"]||""}),this.renderMeasurements(),(0,G.tZ)(u.$G,{location:e,organization:t,transaction:r})]})})})}render(){return(0,G.tZ)(M.BZ,{id:"TransactionDetail",children:(0,G.BX)(u.CB,{onClick:e=>{e.stopPropagation()},children:[this.renderTransactionErrors(),this.renderTransactionDetail()]})})}}q.displayName="TransactionDetail";const F=(0,C.Z)("a",{target:"eykqe522"})("display:flex;color:",(e=>e.theme.textColor),";:hover{color:",(e=>e.theme.textColor),";}"),Q=(0,C.Z)(X.rS,{target:"eykqe521"})("display:block;color:",(e=>e.theme.gray300),";margin-left:",(0,L.Z)(1),";"),U=(0,C.Z)(E.ZP,{target:"eykqe520"})("position:absolute;top:",(0,L.Z)(.75),";right:",(0,L.Z)(.5),";"),W=q;class J extends n.Component{constructor(){super(...arguments),(0,h.Z)(this,"state",{showDetail:!1}),(0,h.Z)(this,"transactionRowDOMRef",(0,n.createRef)()),(0,h.Z)(this,"toggleDisplayDetail",(()=>{const{transaction:e}=this.props;(0,T.Ci)(e)&&this.setState((e=>({showDetail:!e.showDetail})))})),(0,h.Z)(this,"scrollIntoView",(()=>{const e=this.transactionRowDOMRef.current;if(!e)return;const t=e.getBoundingClientRect().top+window.scrollY;this.setState({showDetail:!0},(()=>window.scrollTo(0,t)))}))}getCurrentOffset(){const{transaction:e}=this.props,{generation:t}=e;return Y(t)}renderConnector(e){const{continuingDepths:t,isExpanded:r,isOrphan:n,isLast:s,transaction:i}=this.props,{generation:o}=i,a=(0,T.Ci)(i)?i.event_id:i.traceSlug;if(0===o)return e?(0,G.tZ)(y.UV,{style:{right:"15px",height:"10px",bottom:"-5px",top:"auto"},orphanBranch:!1}):null;const l=t.map((e=>{let{depth:t,isOrphanDepth:r}=e;if(o-t<=1)return null;const n=-1*Y(o-t-1)-2;return(0,G.tZ)(y.UV,{style:{left:n},orphanBranch:r},`${a}-${t}`)}));return e&&r&&l.push((0,G.tZ)(y.UV,{style:{right:"15px",height:"10px",bottom:s?`-${f.d/2+1}px`:"0",top:"auto"},orphanBranch:!1},`${a}-last`)),(0,G.tZ)(y.DN,{isLast:s,hasToggler:e,orphanBranch:n,children:l})}renderToggle(e){const{isExpanded:t,transaction:r,toggleExpandedState:n}=this.props,{children:s,generation:i}=r,o=this.getCurrentOffset();if(s.length<=0)return(0,G.tZ)(y.rw,{style:{left:`${o}px`},children:this.renderConnector(!1)});const a=0===i;return(0,G.BX)(y.rw,{style:{left:`${o}px`},hasToggler:!0,children:[this.renderConnector(!0),(0,G.BX)(y.U1,{disabled:a,isExpanded:t,errored:e,onClick:e=>{e.stopPropagation(),a||n()},children:[(0,G.tZ)(g.Z,{value:s.length}),!a&&(0,G.tZ)("div",{children:(0,G.tZ)(y.jd,{direction:t?"up":"down"})})]})]})}renderTitle(e){const{generateContentSpanBarRef:t}=e,{organization:r,transaction:s}=this.props,i=this.getCurrentOffset(),o=!!(0,T.Ci)(s)&&s.errors.length>0,a=(0,T.Ci)(s)?(0,G.BX)(n.Fragment,{children:[(0,G.tZ)(_.Z,{orgId:r.slug,slugs:[s.project_slug],children:e=>{let{projects:t}=e;const r=t.find((e=>e.slug===s.project_slug));return(0,G.tZ)(u.RB,{children:(0,G.tZ)(D.ZP,{title:s.project_slug,children:(0,G.tZ)(v.Z,{project:r||{slug:s.project_slug},avatarSize:16,hideName:!0})})})}}),(0,G.BX)(b.rv,{errored:o,children:[(0,G.BX)("strong",{children:[s["transaction.op"]," — "]}),s.transaction]})]}):(0,G.BX)(b.rv,{errored:!1,children:[(0,G.tZ)("strong",{children:"Trace — "}),s.traceSlug]});return(0,G.BX)(b.mw,{ref:t(),children:[this.renderToggle(o),(0,G.tZ)(b.Wh,{style:{left:`${i}px`,width:"100%"},children:a})]})}renderDivider(e){if(this.state.showDetail)return(0,G.tZ)(w.xN,{showDetail:!0,style:{position:"absolute"}});const{addDividerLineRef:t}=e;return(0,G.tZ)(w.xN,{ref:t(),style:{position:"absolute"},onMouseEnter:()=>{e.setHover(!0)},onMouseLeave:()=>{e.setHover(!1)},onMouseOver:()=>{e.setHover(!0)},onMouseDown:e.onDragStart,onClick:e=>{e.stopPropagation()}})}renderGhostDivider(e){const{dividerPosition:t,addGhostDividerLineRef:r}=e;return(0,G.tZ)(w.Hr,{style:{width:`calc(${(0,d.yI)(t)} + 0.5px)`,display:"none"},children:(0,G.tZ)(w.xN,{ref:r(),style:{right:0},className:"hovering",onClick:e=>{e.stopPropagation()}})})}renderErrorBadge(){const{transaction:e}=this.props;return(0,T.Ci)(e)&&e.errors.length?(0,G.tZ)(w.cS,{}):null}renderRectangle(){const{transaction:e,traceInfo:t,barColor:r}=this.props,{showDetail:n}=this.state,s=Math.abs(t.endTimestamp-t.startTimestamp)||1,i=Math.abs(e.start_timestamp-t.startTimestamp)/s,o=Math.abs(e.timestamp-e.start_timestamp),a=o/s;return(0,G.tZ)(Z.e,{spanBarHatch:!1,style:{backgroundColor:r,left:`min(${(0,d.yI)(i||0)}, calc(100% - 1px))`,width:(0,d.yI)(a||0)},children:(0,G.tZ)(Z.R,{durationDisplay:(0,d.ud)({left:i,width:a}),showDetail:n,spanBarHatch:!1,children:(0,d.bQ)(o)})})}renderHeader(e){let{dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:r}=e;const{hasGuideAnchor:n,index:s}=this.props,{showDetail:i}=this.state,{dividerPosition:o}=t;return(0,G.BX)(x.Qc,{showDetail:i,children:[(0,G.tZ)(x.E5,{"data-test-id":"transaction-row-title","data-type":"span-row-cell",style:{width:`calc(${(0,d.yI)(o)} - 0.5px)`,paddingTop:0},showDetail:i,onClick:this.toggleDisplayDetail,children:(0,G.tZ)(m.Z,{target:"trace_view_guide_row",disabled:!n,children:this.renderTitle(r)})}),(0,G.BX)(w.kP,{children:[this.renderDivider(t),this.renderErrorBadge()]}),(0,G.tZ)(x.E5,{"data-test-id":"transaction-row-duration","data-type":"span-row-cell",showStriping:s%2!=0,style:{width:`calc(${(0,d.yI)(1-o)} - 0.5px)`,paddingTop:0},showDetail:i,onClick:this.toggleDisplayDetail,children:(0,G.tZ)(m.Z,{target:"trace_view_guide_row_details",disabled:!n,children:this.renderRectangle()})}),!i&&this.renderGhostDivider(t)]})}renderDetail(){const{location:e,organization:t,isVisible:r,transaction:n}=this.props,{showDetail:s}=this.state;return(0,G.tZ)(i.$,{children:i=>{let{registerScrollFn:o,scrollToHash:a}=i;return(0,T.Ci)(n)?(o(`#txn-${n.event_id}`,this.scrollIntoView,!1),r&&s?(0,G.tZ)(W,{location:e,organization:t,transaction:n,scrollToHash:a}):null):null}})}render(){const{isVisible:e,transaction:t}=this.props,{showDetail:r}=this.state;return(0,G.BX)(x.X2,{ref:this.transactionRowDOMRef,visible:e,showBorder:r,cursor:(0,T.Ci)(t)?"pointer":"default",children:[(0,G.tZ)(a.$6,{children:e=>(0,G.tZ)(o.$,{children:t=>this.renderHeader({dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:e})})}),this.renderDetail()]})}}function Y(e){return e*(y.Ll/2)+0}J.displayName="TransactionBar";const K=J;class ee extends n.Component{constructor(){super(...arguments),(0,h.Z)(this,"state",{isExpanded:!0}),(0,h.Z)(this,"toggleExpandedState",(()=>{this.setState((e=>{let{isExpanded:t}=e;return{isExpanded:!t}}))}))}componentDidUpdate(e,t){t.isExpanded!==this.state.isExpanded&&this.props.updateScrollState()}render(){const{location:e,organization:t,transaction:r,traceInfo:s,continuingDepths:i,isOrphan:o,isLast:a,index:l,isVisible:c,hasGuideAnchor:d,renderedChildren:p,barColor:u}=this.props,{isExpanded:h}=this.state;return(0,G.BX)(n.Fragment,{children:[(0,G.tZ)(K,{location:e,organization:t,index:l,transaction:r,traceInfo:s,continuingDepths:i,isOrphan:o,isLast:a,isExpanded:h,toggleExpandedState:this.toggleExpandedState,isVisible:c,hasGuideAnchor:d,barColor:u}),h&&p]})}}ee.displayName="TransactionGroup";const te=(0,a.Iw)(ee);var re=r("./app/views/performance/traceDetails/utils.tsx"),ne=r("./app/components/discover/discoverFeature.tsx");function se(e){var t;let{traceInfo:r,traceEventView:n,organization:s,meta:i}=e;const o=r.transactions.size,a=null!==(t=null==i?void 0:i.transactions)&&void 0!==t?t:o;if(null===a||o>=a)return null;const c=n.getResultsViewUrlTarget(s.slug);return(0,G.tZ)(l.V,{children:(0,p._N)("Limited to a view of [count] transactions. To view the full list, [discover].",{count:o,discover:(0,G.tZ)(ne.Z,{children:e=>{let{hasFeature:t}=e;return(0,G.tZ)(O.Z,{disabled:!t,to:c,children:(0,p.t)("Open in Discover")})}})})})}se.displayName="LimitExceededMessage";const ie=se;var oe=r("./app/views/performance/traceDetails/traceNotFound.tsx");function ae(e){let{isVisible:t,numberOfHiddenTransactionsAbove:r}=e;return!t||r<1?null:(0,G.tZ)(l.V,{children:(0,G.tZ)("span",{children:1===r?(0,p._N)("[numOfTransaction] hidden transaction",{numOfTransaction:(0,G.tZ)("strong",{children:r})}):(0,p._N)("[numOfTransaction] hidden transactions",{numOfTransaction:(0,G.tZ)("strong",{children:r})})},"trace-info-message")})}function le(e){var t;let{location:r,meta:l,organization:p,traces:h,traceSlug:m,traceEventView:g,filteredTransactionIds:v,...f}=e;const x=null===(t=s.Gd().getScope())||void 0===t?void 0:t.getTransaction(),Z=null==x?void 0:x.startChild({op:"trace.render",description:"trace-view-content"});function w(e,t){let{continuingDepths:s,isOrphan:i,isLast:o,index:a,numberOfHiddenTransactionsAbove:l,traceInfo:c,hasGuideAnchor:u}=t;const{children:h,event_id:m}=e,g=e.generation+1,f=function(e,t){return!t||t.has(e.event_id)}(e,v),x=h.reduce(((e,t,r)=>{const n=r===h.length-1,o=t.children.length>0,a=w(t,{continuingDepths:!n&&o?[...s,{depth:g,isOrphanDepth:i}]:s,isOrphan:i,isLast:n,index:e.lastIndex+1,numberOfHiddenTransactionsAbove:e.numberOfHiddenTransactionsAbove,traceInfo:c,hasGuideAnchor:!1});return e.lastIndex=a.lastIndex,e.numberOfHiddenTransactionsAbove=a.numberOfHiddenTransactionsAbove,e.renderedChildren.push(a.transactionGroup),e}),{renderedChildren:[],lastIndex:a,numberOfHiddenTransactionsAbove:f?0:l+1});return{transactionGroup:(0,G.BX)(n.Fragment,{children:[(0,G.tZ)(ae,{isVisible:f,numberOfHiddenTransactionsAbove:l}),(0,G.tZ)(te,{location:r,organization:p,traceInfo:c,transaction:{...e,generation:g},continuingDepths:s,isOrphan:i,isLast:o,index:a,isVisible:f,hasGuideAnchor:u,renderedChildren:x.renderedChildren,barColor:(0,d.hd)(e["transaction.op"])})]},m),lastIndex:x.lastIndex,numberOfHiddenTransactionsAbove:x.numberOfHiddenTransactionsAbove}}const b=(0,n.createRef)(),y=(0,n.createRef)();if(null===h||h.length<=0)return(0,G.tZ)(oe.Z,{meta:l,traceEventView:g,traceSlug:m,location:r,organization:p});const D=f.traceInfo||(0,re.Rg)(h),T={index:1,numberOfHiddenTransactionsAbove:0,traceInfo:D,transactionGroups:[]},{transactionGroups:_,numberOfHiddenTransactionsAbove:C}=h.reduce(((e,t,r)=>{const n=r===h.length-1,s=t.children.length>0,i=!n&&null!==h[r+1].parent_span_id,o=w(t,{...e,isOrphan:!(0,re.uM)(t),isLast:n,continuingDepths:!n&&s?[{depth:0,isOrphanDepth:i}]:[],hasGuideAnchor:0===r});return e.index=o.lastIndex+1,e.numberOfHiddenTransactionsAbove=o.numberOfHiddenTransactionsAbove,e.transactionGroups.push(o.transactionGroup),e}),T),j=(0,G.tZ)(u.W3,{children:(0,G.tZ)(o.z,{interactiveLayerRef:b,children:(0,G.tZ)(o.$,{children:e=>{let{dividerPosition:t}=e;return(0,G.tZ)(a.zt,{dividerPosition:t,interactiveLayerRef:y,children:(0,G.BX)(u.LA,{children:[(0,G.BX)(u.cC,{children:[(0,G.tZ)(a.$6,{children:e=>{let{virtualScrollbarRef:r,scrollBarAreaRef:n,onDragStart:s,onScroll:i}=e;return(0,G.BX)(c.cs,{ref:y,style:{width:`calc(${(0,d.yI)(t)} - 0.5px)`},onScroll:i,children:[(0,G.tZ)("div",{style:{width:0,height:"1px"},ref:n}),(0,G.tZ)(c.Qk,{"data-type":"virtual-scrollbar",ref:r,onMouseDown:s,children:(0,G.tZ)(c.v6,{})})]})}}),(0,G.tZ)(c._i,{})]}),(0,G.BX)(u.uI,{ref:b,children:[(0,G.tZ)(i.z,{children:(0,G.tZ)(te,{location:r,organization:p,traceInfo:D,transaction:{traceSlug:m,generation:0,"transaction.duration":D.endTimestamp-D.startTimestamp,children:h,start_timestamp:D.startTimestamp,timestamp:D.endTimestamp},continuingDepths:[],isOrphan:!1,isLast:!1,index:0,isVisible:!0,hasGuideAnchor:!1,renderedChildren:_,barColor:(0,d.hd)("")})}),(0,G.tZ)(ae,{isVisible:!0,numberOfHiddenTransactionsAbove:C}),(0,G.tZ)(ie,{traceInfo:D,organization:p,traceEventView:g,meta:l})]})]})})}})})});return null==Z||Z.finish(),j}ae.displayName="TraceHiddenMessage"}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_traceView_tsx.d4105c8694c08592999beb712cfdaca5.js.map