"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_checkbox_tsx-app_components_forms_controls_radioGroup_tsx-app_components_smart-ed2d6d"],{"./app/actionCreators/savedSearches.tsx":(e,t,s)=>{s.d(t,{bG:()=>c,C2:()=>d,VH:()=>p,cB:()=>h,YO:()=>m,k0:()=>f,g_:()=>v,k9:()=>y});var r=s("./app/actionCreators/indicator.tsx"),o=s("./app/actions/savedSearchesActions.tsx"),n=s("./app/constants/index.tsx"),a=s("./app/locale.tsx"),i=s("./app/types/index.tsx"),l=s("./app/utils/handleXhrErrorResponse.tsx");function c(){o.Z.resetSavedSearches()}function d(e,t){const s=`/organizations/${t}/searches/`;o.Z.startFetchSavedSearches();const n=e.requestPromise(s,{method:"GET"});return n.then((e=>{o.Z.fetchSavedSearchesSuccess(e)})).catch((e=>{o.Z.fetchSavedSearchesError(e),(0,r.Iw)((0,a.t)("Unable to load saved searches"))})),n}const u=e=>`/organizations/${e}/recent-searches/`;function p(e,t,s,r){const o=u(t),n=e.requestPromise(o,{method:"POST",data:{query:r,type:s}});return n.catch((0,l.Z)("Unable to save a recent search")),n}function h(e,t,s,r,n){const a=e.requestPromise(`/organizations/${t}/searches/`,{method:"POST",data:{type:i.L4.ISSUE,query:r,name:s,sort:n}});return a.then((e=>{o.Z.createSavedSearchSuccess(e)})),a}function m(e,t,s,r){const o=u(t),a=e.requestPromise(o,{query:{query:r,type:s,limit:n.x}});return a.catch((e=>{401!==e.status&&403!==e.status&&(0,l.Z)("Unable to fetch recent searches")(e)})),a}const g=e=>`/organizations/${e}/pinned-searches/`;function f(e,t,s,r,n){const a=g(t);o.Z.pinSearch(s,r,n);const i=e.requestPromise(a,{method:"PUT",data:{query:r,type:s,sort:n}});return i.then(o.Z.pinSearchSuccess),i.catch((0,l.Z)("Unable to pin search")),i.catch((()=>{o.Z.unpinSearch(s)})),i}function v(e,t,s,r){const n=g(t);o.Z.unpinSearch(s);const a=e.requestPromise(n,{method:"DELETE",data:{type:s}});return a.catch((0,l.Z)("Unable to un-pin search")),a.catch((()=>{const{type:e,query:t}=r;o.Z.pinSearch(e,t)})),a}function y(e,t,s){const r=`/organizations/${t}/searches/${s.id}/`;return e.requestPromise(r,{method:"DELETE"}).then((()=>o.Z.deleteSavedSearchSuccess(s))).catch((0,l.Z)("Unable to delete a saved search"))}},"./app/actions/savedSearchesActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/reflux/src/index.js").createActions)(["resetSavedSearches","startFetchSavedSearches","fetchSavedSearchesSuccess","fetchSavedSearchesError","createSavedSearchSuccess","deleteSavedSearchSuccess","pinSearch","pinSearchSuccess","unpinSearch"])},"./app/components/checkbox.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=e=>(0,r.tZ)("input",{type:"checkbox",...e});o.displayName="Checkbox",o.defaultProps={checked:!1};const n=o},"./app/components/dropdownLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var r=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),o=s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),n=s("../node_modules/classnames/index.js"),a=s.n(n),i=s("./app/components/dropdownMenu.tsx"),l=s("./app/icons/index.tsx"),c=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=e=>(0,r.iv)(".dropdown-menu{&>li>a{color:",e.textColor,";&:hover,&:focus{color:inherit;background-color:",e.hover,";}}& .disabled{cursor:not-allowed;&:hover{background:inherit;color:inherit;}}}.dropdown-submenu:hover>span{color:",e.textColor,";background:",e.hover,";}","");function u(e){let{anchorMiddle:t,title:s,customTitle:r,children:n,menuClasses:u,className:p,topLevelClasses:h,anchorRight:m=!1,disabled:g=!1,caret:f=!0,alwaysRenderMenu:v=!0,...y}=e;const x=(0,o.u)();return(0,c.tZ)(i.Z,{alwaysRenderMenu:v,...y,children:e=>{let{isOpen:o,getRootProps:i,getActorProps:y,getMenuProps:S}=e;const b=v||o,Z=a()("dropdown-actor",p,{"dropdown-menu-right":m,"dropdown-toggle":!0,hover:o,disabled:g}),T=a()("dropdown",h,{"pull-right":m,"anchor-right":m,"anchor-middle":t,open:o}),{onClick:w,...A}=y({className:Z});return(0,c.BX)("span",{css:d(x),...i({className:T}),"data-test-id":"dropdown-link",children:[(0,c.tZ)("a",{onClick:g?void 0:w,...A,children:r||(0,c.BX)("div",{className:"dropdown-actor-title",children:[s,f&&(0,c.tZ)(l.g6,{direction:o?"up":"down",size:"xs"})]})}),b&&(0,c.tZ)("ul",{...S({className:a()(u,"dropdown-menu")}),children:n})]})}})}u.displayName="DropdownLink";const p=u},"./app/components/forms/controls/radioBoolean.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var r=s("../node_modules/react/index.js"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,r.forwardRef)((function(e,t){let{name:s,disabled:r,label:n,value:a,checked:i,onChange:l}=e;return(0,o.tZ)("div",{className:"radio",children:(0,o.BX)("label",{style:{fontWeight:"normal"},children:[(0,o.tZ)("input",{ref:t,type:"radio",value:a,name:s,checked:i,onChange:function(e){const t="true"===e.target.value;null==l||l(t,e)},disabled:r})," ",n]})})})),a=(0,r.forwardRef)((function(e,t){let{disabled:s,name:r,onChange:a,value:i,yesFirst:l=!0,yesLabel:c="Yes",noLabel:d="No"}=e;const u=(0,o.tZ)(n,{ref:t,value:"true",checked:!0===i,name:r,disabled:s,label:c,onChange:a}),p=(0,o.tZ)(n,{value:"false",checked:!1===i,name:r,disabled:s,label:d,onChange:a});return(0,o.BX)("div",{children:[l?u:p,l?p:u]})}))},"./app/components/forms/controls/radioGroup.tsx":(e,t,s)=>{s.d(t,{V:()=>m,Z:()=>v});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),a=s("./app/components/radio.tsx"),i=s("./app/components/tooltip.tsx"),l=s("./app/locale.tsx"),c=s("./app/styles/space.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u=(0,r.Z)("div",{target:"ec3iq7v3"})("display:grid;gap:",(e=>(0,c.Z)(e.orientInline?3:1)),";grid-auto-flow:",(e=>e.orientInline?"column":"row"),";grid-auto-rows:max-content;grid-auto-columns:max-content;"),p=e=>{let{value:t,disabled:s,disabledChoices:r=[],choices:n=[],label:c,onChange:p,orientInline:h,...v}=e;return(0,d.tZ)(u,{orientInline:h,...v,role:"radiogroup","aria-labelledby":c,children:n.map(((e,n)=>{let[c,u,h]=e;const v=r.find((e=>{let[t]=e;return t===c})),y=null==v?void 0:v[1],x=!!v||s,S=(0,d.tZ)(o.Fragment,{children:(0,d.BX)(m,{role:"radio",index:n,"aria-checked":t===c,disabled:x,children:[(0,d.tZ)(a.Z,{"aria-label":(0,l.t)("Select %s",u),disabled:x,checked:t===c,onChange:e=>!x&&p(c,e)}),(0,d.tZ)(g,{disabled:x,children:u}),h&&(0,d.BX)(o.Fragment,{children:[(0,d.tZ)("div",{}),(0,d.tZ)(f,{children:h})]})]})});return y?(0,d.tZ)(i.ZP,{title:y,children:S},n):(0,d.tZ)(o.Fragment,{children:S},n)}))})};p.displayName="RadioGroup";const h=e=>"string"==typeof e&&!["disabled","animate"].includes(e)&&(0,n.Z)(e),m=(0,r.Z)("label",{shouldForwardProp:h,target:"ec3iq7v2"})("display:grid;gap:0.25em 0.5em;grid-template-columns:max-content auto;align-items:center;cursor:",(e=>e.disabled?"default":"pointer"),";outline:none;font-weight:normal;margin:0;"),g=(0,r.Z)("div",{shouldForwardProp:h,target:"ec3iq7v1"})("opacity:",(e=>e.disabled?.4:null),";"),f=(0,r.Z)("div",{target:"ec3iq7v0"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeRelativeSmall),";line-height:1.4em;"),v=p},"./app/components/forms/formPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>u});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("./app/components/forms/fieldFromConfig.tsx"),i=s("./app/components/panels/index.tsx"),l=s("./app/icons/index.tsx"),c=s("./app/utils/sanitizeQuerySelector.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class u extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{collapsed:!1}),(0,r.Z)(this,"handleToggleEvents",(()=>{const{collapsed:e}=this.state;this.setState({collapsed:!e})}))}render(){const{title:e,fields:t,access:s,disabled:r,additionalFieldProps:o,renderFooter:n,renderHeader:u,collapsible:h,...m}=this.props,{collapsed:g}=this.state;return(0,d.BX)(i.s_,{id:"string"==typeof e?(0,c.m)(e):void 0,children:[e&&(0,d.BX)(i.V9,{children:[e,h&&(0,d.tZ)(p,{onClick:this.handleToggleEvents,children:(0,d.tZ)(l.g6,{direction:g?"down":"up",size:"xs"})})]}),!g&&(0,d.BX)(i.N,{children:["function"==typeof u&&u({title:e,fields:t}),t.map((e=>{if("function"==typeof e)return e();const{defaultValue:t,...n}=e;return!0===r&&(n.disabled=!0,n.disabledReason=void 0),(0,d.tZ)(a.Z,{access:s,disabled:r,...m,...o,field:n,highlighted:this.props.highlighted===`#${e.name}`},e.name)})),"function"==typeof n&&n({title:e,fields:t})]})]})}}u.displayName="FormPanel",(0,r.Z)(u,"defaultProps",{additionalFieldProps:{}});const p=(0,o.Z)("span",{target:"el0ys6l0"})({name:"e0dnmk",styles:"cursor:pointer"})},"./app/components/forms/index.tsx":(e,t,s)=>{s.d(t,{sB:()=>r.Z,Ig:()=>o.Z,ji:()=>n.Z,s8:()=>d.Z,Ff:()=>u.Z,l0:()=>p.Z,UP:()=>l.Z,eM:()=>f,mg:()=>v.Z,nv:()=>y.Z});var r=s("./app/components/forms/apiForm.tsx"),o=s("./app/components/forms/booleanField.tsx"),n=s("./app/components/forms/checkboxField.tsx"),a=(s("./app/components/forms/choiceMapperField.tsx"),s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js"),s("../node_modules/moment/moment.js"),s("./app/components/dropdownMenu.tsx"),s("./app/components/loadingIndicator.tsx"),s("./app/components/placeholder.tsx"),s("./app/icons/index.tsx"),s("./app/styles/input.tsx")),i=s("./app/styles/space.tsx"),l=s("./app/components/forms/inputField.tsx"),c=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");a.T,(0,i.Z)(1),s("./app/components/forms/dateTimeField.tsx");var d=s("./app/components/forms/emailField.tsx"),u=s("./app/components/forms/fieldFromConfig.tsx"),p=(s("./app/components/forms/fieldSeparator.tsx"),s("./app/components/forms/form.tsx")),h=(s("./app/components/forms/formPanel.tsx"),s("./app/components/forms/hiddenField.tsx"),s("./app/components/forms/jsonForm.tsx"),s("./app/components/forms/numberField.tsx"),s("../node_modules/lodash/omit.js")),m=s.n(h),g=s("./app/components/forms/controls/radioBoolean.tsx");function f(e){return(0,c.tZ)(l.Z,{...e,field:e=>(0,c.tZ)(g.Z,{...m()(e,["onKeyDown","children"])})})}f.displayName="RadioBooleanField",s("./app/components/forms/rangeField.tsx");var v=s("./app/components/forms/selectField.tsx"),y=(s("./app/components/forms/textareaField.tsx"),s("./app/components/forms/textCopyInput.tsx"),s("./app/components/forms/textField.tsx"))},"./app/components/forms/jsonForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/react-router/es/index.js"),a=s("../node_modules/@sentry/minimal/esm/index.js"),i=s("../node_modules/scroll-to-element/index.js"),l=s.n(i),c=s("./app/utils.tsx"),d=s("./app/utils/sanitizeQuerySelector.tsx"),u=s("./app/components/forms/formPanel.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class h extends o.Component{constructor(){var e;super(...arguments),(0,r.Z)(this,"state",{highlighted:null===(e=this.props.location)||void 0===e?void 0:e.hash})}componentDidMount(){this.scrollToHash()}UNSAFE_componentWillReceiveProps(e){if(e.location&&this.props.location.hash!==e.location.hash){const t=e.location.hash;this.scrollToHash(t),this.setState({highlighted:t})}}scrollToHash(e){var t;const s=e||(null===(t=this.props.location)||void 0===t?void 0:t.hash);if(s)try{l()((0,d.m)(decodeURIComponent(s)),{align:"middle",offset:-100})}catch(e){a.Tb(e)}}shouldDisplayForm(e){const t=e.filter((e=>"function"!=typeof e&&(0,c.ri)(null==e?void 0:e.visible)));if(e.length===t.length){const{additionalFieldProps:e,...s}=this.props;return!t.every((t=>"function"==typeof t.visible?!t.visible({...s,...e}):!t.visible))}return!0}renderForm(e){let{fields:t,formPanelProps:s,title:r}=e;return this.shouldDisplayForm(t)||null!=s&&s.renderFooter||null!=s&&s.renderHeader?(0,p.tZ)(u.Z,{title:r,fields:t,...s}):null}render(){const{access:e,collapsible:t,fields:s,title:r,forms:n,disabled:a,features:i,additionalFieldProps:l,renderFooter:c,renderHeader:d,location:u,...h}=this.props,m={access:e,disabled:a,features:i,additionalFieldProps:l,renderFooter:c,renderHeader:d,highlighted:this.state.highlighted,collapsible:t};return(0,p.BX)("div",{...h,children:[void 0!==n&&n.map(((e,t)=>(0,p.tZ)(o.Fragment,{children:this.renderForm({formPanelProps:m,...e})},t))),void 0===n&&void 0!==s&&this.renderForm({fields:s,formPanelProps:m,title:r})]})}}h.displayName="JsonForm";const m=(0,n.withRouter)(h)},"./app/components/smartSearchBar/actions.tsx":(e,t,s)=>{s.d(t,{Kk:()=>C,DL:()=>_,lZ:()=>k,b9:()=>q});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react-router/es/index.js"),n=s("./app/actionCreators/modal.tsx"),a=s("./app/actionCreators/savedSearches.tsx"),i=s("./app/components/acl/access.tsx"),l=s("./app/components/button.tsx"),c=s("./app/components/menuItem.tsx"),d=s("./app/icons/index.tsx"),u=s("./app/locale.tsx"),p=s("./app/types/index.tsx"),h=s("./app/utils/analytics.tsx"),m=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),g=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),f=s("./app/actionCreators/indicator.tsx"),v=s("./app/components/alert.tsx"),y=s("./app/components/forms/index.tsx"),x=s("./app/utils/withApi.tsx"),S=s("./app/views/issueList/utils.tsx"),b=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Z=[S.qh.DATE,S.qh.NEW,S.qh.FREQ,S.qh.PRIORITY,S.qh.USER];class T extends g.Component{constructor(){super(...arguments),(0,m.Z)(this,"state",{isSaving:!1,error:null}),(0,m.Z)(this,"handleSubmit",((e,t,s,r)=>{const{api:o,organization:n}=this.props,i=this.validateSortOption(e.sort);r.preventDefault(),this.setState({isSaving:!0}),(0,f.E3)((0,u.t)("Saving Changes")),(0,a.cB)(o,n.slug,e.name,e.query,i).then((s=>{this.props.closeModal(),this.setState({error:null,isSaving:!1}),(0,f.B8)(),t(e)})).catch((e=>{let t=(0,u.t)("Unable to save your changes.");e.responseJSON&&e.responseJSON.detail&&(t=e.responseJSON.detail),this.setState({error:t,isSaving:!1}),(0,f.B8)(),s(t)}))}))}validateSortOption(e){return this.sortOptions().find((t=>t===e))?e:S.qh.DATE}sortOptions(){var e;const{organization:t}=this.props,s=[...Z];return null!=t&&null!==(e=t.features)&&void 0!==e&&e.includes("issue-list-trend-sort")&&s.push(S.qh.TREND),s}render(){const{error:e}=this.state,{Header:t,Body:s,closeModal:r,query:o,sort:n}=this.props,a=this.sortOptions().map((e=>({value:e,label:(0,S._k)(e)}))),i={name:"",query:o,sort:this.validateSortOption(n)};return(0,b.BX)(y.l0,{onSubmit:this.handleSubmit,onCancel:r,saveOnBlur:!1,initialData:i,submitLabel:(0,u.t)("Save"),children:[(0,b.tZ)(t,{children:(0,b.tZ)("h4",{children:(0,u.t)("Save Current Search")})}),(0,b.BX)(s,{children:[this.state.error&&(0,b.tZ)(v.Z,{type:"error",children:e}),(0,b.tZ)("p",{children:(0,u.t)("All team members will now have access to this search.")}),(0,b.tZ)(y.nv,{name:"name",label:(0,u.t)("Name"),placeholder:"e.g. My Search Results",inline:!1,stacked:!0,flexibleControlStateSize:!0,required:!0},"name"),(0,b.tZ)(y.nv,{name:"query",label:(0,u.t)("Query"),inline:!1,stacked:!0,flexibleControlStateSize:!0,required:!0},"query"),(0,b.tZ)(y.mg,{name:"sort",label:(0,u.t)("Sort By"),options:a,required:!0,clearable:!1,inline:!1,stacked:!0,flexibleControlStateSize:!0},"sort")]})]})}}T.displayName="CreateSavedSearchModal";const w=(0,x.Z)(T);var A=s("./app/components/smartSearchBar/utils.tsx");function _(e){let{pinnedSearch:t,sort:s}=e;return{key:"pinSearch",Action:(0,o.withRouter)((e=>{let{menuItemVariant:r,savedSearchType:n,organization:i,api:l,query:m,location:g}=e;const f=async e=>{var r;if(e.preventDefault(),e.stopPropagation(),void 0===n)return;const{cursor:c,page:d,...u}=g.query;if((0,h.ec)({eventKey:"search.pin",eventName:"Search: Pin",organization_id:i.id,action:t?"unpin":"pin",search_type:n===p.L4.ISSUE?"issues":"events",query:null!==(r=null==t?void 0:t.query)&&void 0!==r?r:m}),t)return void(0,a.g_)(l,i.slug,n,t).then((()=>{o.browserHistory.push({...g,pathname:`/organizations/${i.slug}/issues/`,query:{...u,query:t.query,sort:t.sort}})}));const f=await(0,a.k0)(l,i.slug,n,(0,A.WF)(m),s);f&&f.id&&o.browserHistory.push({...g,pathname:`/organizations/${i.slug}/issues/searches/${f.id}/`,query:u})},v=t?(0,u.t)("Unpin this search"):(0,u.t)("Pin this search");return r?(0,b.tZ)(c.Z,{withBorder:!0,"data-test-id":"pin-icon",icon:(0,b.tZ)(d.Dg,{isSolid:!!t,size:"xs"}),onClick:f,children:t?(0,u.t)("Unpin Search"):(0,u.t)("Pin Search")}):(0,b.tZ)(C,{title:v,disabled:!m,"aria-label":v,onClick:f,isActive:!!t,"data-test-id":"pin-icon",icon:(0,b.tZ)(d.Dg,{isSolid:!!t,size:"xs"})})}))}}function k(e){let{sort:t}=e;return{key:"saveSearch",Action:e=>{let{menuItemVariant:s,query:r,organization:o}=e;const a=()=>(0,n.openModal)((e=>(0,b.tZ)(w,{...e,organization:o,query:r,sort:t})));return(0,b.tZ)(i.Z,{organization:o,access:["org:write"],children:s?(0,b.tZ)(c.Z,{withBorder:!0,icon:(0,b.tZ)(d.N_,{size:"xs"}),onClick:a,children:(0,u.t)("Create Saved Search")}):(0,b.tZ)(C,{onClick:a,"data-test-id":"save-current-search",icon:(0,b.tZ)(d.N_,{size:"xs"}),title:(0,u.t)("Add to organization saved searches"),"aria-label":(0,u.t)("Add to organization saved searches")})})}}}function q(e){let{onSidebarToggle:t}=e;return{key:"searchBuilder",Action:e=>{let{menuItemVariant:s}=e;return s?(0,b.tZ)(c.Z,{withBorder:!0,icon:(0,b.tZ)(d.OP,{size:"xs"}),onClick:t,children:(0,u.t)("Toggle sidebar")}):(0,b.tZ)(C,{title:(0,u.t)("Toggle search builder"),tooltipProps:{containerDisplayMode:"inline-flex"},"aria-label":(0,u.t)("Toggle search builder"),onClick:t,icon:(0,b.tZ)(d.OP,{size:"xs"})})}}}const C=(0,r.Z)(l.ZP,{target:"e491rhv0"})("color:",(e=>e.isActive?e.theme.blue300:e.theme.gray300),";width:18px;&,&:hover,&:focus{background:transparent;}&:hover{color:",(e=>e.theme.gray400),";}");C.defaultProps={type:"button",borderless:!0,size:"zero"}},"./app/components/smartSearchBar/index.tsx":(e,t,s)=>{s.d(t,{Z:()=>te});var r=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/react/index.js")),i=s("../node_modules/react-autosize-textarea/lib/index.js"),l=s("../node_modules/react-router/es/index.js"),c=s("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),d=s("../node_modules/@sentry/minimal/esm/index.js"),u=s("../node_modules/lodash/debounce.js"),p=s.n(u),h=s("./app/actionCreators/indicator.tsx"),m=s("./app/actionCreators/savedSearches.tsx"),g=s("./app/components/buttonBar.tsx"),f=s("./app/components/dropdownLink.tsx"),v=s("./app/components/organizations/pageFilters/parse.tsx"),y=s("./app/components/searchSyntax/parser.tsx"),x=s("./app/components/searchSyntax/renderer.tsx"),S=s("./app/components/searchSyntax/utils.tsx"),b=s("./app/constants/index.tsx"),Z=s("./app/icons/index.tsx"),T=s("./app/locale.tsx"),w=s("./app/stores/memberListStore.tsx"),A=s("./app/styles/space.tsx"),_=s("./app/types/index.tsx"),k=s("./app/utils.tsx"),q=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),C=s("./app/utils/callIfFunction.tsx"),R=s("./app/utils/withApi.tsx"),I=s("./app/utils/withOrganization.tsx"),j=s("./app/components/smartSearchBar/actions.tsx"),E=s("./app/components/loadingIndicator.tsx"),P=s("./app/styles/overflowEllipsis.tsx"),F=s("./app/components/smartSearchBar/types.tsx"),z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class O extends a.PureComponent{constructor(){super(...arguments),(0,o.Z)(this,"renderDescription",(e=>{const t=this.props.searchSubstring;if(!t)return e.desc;const s=e.desc;if(!s)return null;const r=s.toLowerCase().indexOf(t.toLowerCase());return-1===r?e.desc:(0,z.BX)("span",{children:[s.substr(0,r),(0,z.tZ)("strong",{children:s.substr(r,t.length)}),s.substr(r+t.length)]})})),(0,o.Z)(this,"renderHeaderItem",(e=>(0,z.tZ)(U,{children:(0,z.BX)($,{children:[e.icon,e.title&&e.title,e.desc&&(0,z.tZ)("span",{children:e.desc})]})},e.title))),(0,o.Z)(this,"renderItem",(e=>(0,z.tZ)(H,{className:e.active?"active":void 0,"data-test-id":"search-autocomplete-item",onClick:this.props.onClick.bind(this,e.value,e),ref:t=>{var s;return e.active&&(null==t||null===(s=t.scrollIntoView)||void 0===s?void 0:s.call(t,{block:"nearest"}))},children:(0,z.BX)(M,{children:[e.title&&e.title+" Â· ",(0,z.tZ)(Q,{children:this.renderDescription(e)}),(0,z.tZ)(W,{children:e.documentation})]})},e.value||e.desc)))}render(){const{className:e,loading:t,items:s}=this.props;return(0,z.tZ)(B,{className:e,children:t?(0,z.tZ)(G,{"data-test-id":"search-autocomplete-loading",children:(0,z.tZ)(E.Z,{mini:!0})},"loading"):(0,z.tZ)(L,{children:s.map((e=>{const t=e.children&&!e.children.length,s=e.type===F.q.INVALID_TAG;return(0,z.BX)(a.Fragment,{children:[s&&(0,z.tZ)(N,{children:(0,T.t)("Invalid tag")}),"header"===e.type&&this.renderHeaderItem(e),e.children&&e.children.map(this.renderItem),t&&!s&&(0,z.tZ)(N,{children:(0,T.t)("No items found")})]},e.title)}))})})}}O.displayName="SearchDropdown",(0,o.Z)(O,"defaultProps",{searchSubstring:"",onClick:function(){}});const V=O,B=(0,n.Z)("div",{target:"e7s74sr10"})("position:absolute;top:100%;left:-1px;right:-1px;z-index:",(e=>e.theme.zIndex.dropdown),";overflow:hidden;margin-top:",(0,A.Z)(1),";background:",(e=>e.theme.background),";box-shadow:",(e=>e.theme.dropShadowHeavy),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";"),G=(0,n.Z)("div",{target:"e7s74sr9"})("display:flex;justify-content:center;padding:",(0,A.Z)(1),";"),N=(0,n.Z)("div",{target:"e7s74sr8"})("display:flex;padding:",(0,A.Z)(1)," ",(0,A.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray300),";&:not(:last-child){border-bottom:1px solid ",(e=>e.theme.innerBorder),";}"),D=(0,n.Z)("li",{target:"e7s74sr7"})("&:not(:last-child){border-bottom:1px solid ",(e=>e.theme.innerBorder),";}"),U=(0,n.Z)(D,{target:"e7s74sr6"})(""),$=(0,n.Z)("header",{target:"e7s74sr5"})("display:flex;align-items:center;background-color:",(e=>e.theme.backgroundSecondary),";color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";margin:0;padding:",(0,A.Z)(1)," ",(0,A.Z)(2),";&>svg{margin-right:",(0,A.Z)(1),";}"),L=(0,n.Z)("ul",{target:"e7s74sr4"})({name:"nfj5ll",styles:"padding-left:0;list-style:none;margin-bottom:0"}),H=(0,n.Z)(D,{target:"e7s74sr3"})("scroll-margin:40px 0;font-size:",(e=>e.theme.fontSizeLarge),";padding:",(0,A.Z)(1)," ",(0,A.Z)(2),";cursor:pointer;&:hover,&.active{background:",(e=>e.theme.hover),";}"),M=(0,n.Z)("div",{target:"e7s74sr2"})("color:",(e=>e.theme.textColor),";font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";margin:0;line-height:",(e=>e.theme.text.lineHeightHeading),";",P.Z,";"),Q=(0,n.Z)("span",{target:"e7s74sr1"})("font-size:",(e=>e.theme.fontSizeSmall),";font-family:",(e=>e.theme.text.familyMono),";"),W=(0,n.Z)("span",{target:"e7s74sr0"})("font-size:",(e=>e.theme.fontSizeSmall),";font-family:",(e=>e.theme.text.familyMono),";float:right;color:",(e=>e.theme.gray300),";");var X=s("./app/components/smartSearchBar/utils.tsx");const K=e=>({query:e,parsedQuery:(0,y.UG)(e)}),Y=(e,t)=>{const s=(0,X.th)(t);return{searchItems:e.map((e=>s[e])),recentSearchItems:void 0,tagName:"",type:F.q.TAG_OPERATOR}};class J extends a.Component{constructor(){var e,t;super(...arguments),(0,o.Z)(this,"state",{query:this.initialQuery,parsedQuery:(0,y.UG)(this.initialQuery),searchTerm:"",searchGroups:[],flatSearchItems:[],activeSearchItem:-1,tags:{},inputHasFocus:!1,loading:!1,numActionsVisible:null!==(e=null===(t=this.props.actionBarItems)||void 0===t?void 0:t.length)&&void 0!==e?e:0}),(0,o.Z)(this,"blurTimeout",void 0),(0,o.Z)(this,"searchInput",(0,a.createRef)()),(0,o.Z)(this,"containerRef",(0,a.createRef)()),(0,o.Z)(this,"inputResizeObserver",null),(0,o.Z)(this,"updateActionsVisible",(e=>{var t,s;if(0===e.length)return;const r=e[0],{width:o}=r.contentRect,n=null!==(t=null===(s=this.props.actionBarItems)||void 0===s?void 0:s.length)&&void 0!==t?t:0,a=Math.min(n,Math.floor(Math.max(0,o-400)/75));this.state.numActionsVisible!==a&&this.setState({numActionsVisible:a})})),(0,o.Z)(this,"onSubmit",(e=>{e.preventDefault(),this.doSearch()})),(0,o.Z)(this,"clearSearch",(()=>this.setState(K(""),(()=>(0,C.g)(this.props.onSearch,this.state.query))))),(0,o.Z)(this,"onQueryFocus",(()=>this.setState({inputHasFocus:!0}))),(0,o.Z)(this,"onQueryBlur",(e=>{window.clearTimeout(this.blurTimeout),this.blurTimeout=window.setTimeout((()=>{this.blurTimeout=void 0,this.setState({inputHasFocus:!1}),(0,C.g)(this.props.onBlur,e.target.value)}),200)})),(0,o.Z)(this,"onQueryChange",(e=>{const t=e.target.value.replace("\n","");this.setState(K(t),this.updateAutoCompleteItems),(0,C.g)(this.props.onChange,e.target.value,e)})),(0,o.Z)(this,"onPaste",(e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain").replace("\n","").trim(),s=this.state.query,r=this.searchInput.current.selectionStart,o=this.searchInput.current.selectionEnd,n=s.substring(0,r),a=s.substring(o,s.length),i=`${n}${t}${a}`;this.setState(K(i),(()=>{this.updateAutoCompleteItems();const e=r+t.length;this.searchInput.current.selectionStart=e,this.searchInput.current.selectionEnd=e})),(0,C.g)(this.props.onChange,i,e)})),(0,o.Z)(this,"onInputClick",(()=>this.updateAutoCompleteItems())),(0,o.Z)(this,"onKeyDown",(e=>{const{onKeyDown:t}=this.props,{key:s}=e;(0,C.g)(t,e);const r=this.state.searchGroups.length>0,o=-1!==this.state.activeSearchItem;if(("ArrowDown"===s||"ArrowUp"===s)&&r){var n;e.preventDefault();const{flatSearchItems:t,activeSearchItem:r}=this.state,l=[...this.state.searchGroups],[c,d]=o?(0,X.iO)(l,r):[];var a,i;void 0!==c&&void 0!==d&&null!==(a=l[c])&&void 0!==a&&null!==(i=a.children)&&void 0!==i&&i[d]&&delete l[c].children[d].active;const u=o?r:0,p=t.length,h="ArrowUp"===s?(u-1+p)%p:o?(u+1)%p:0,[m,g]=(0,X.iO)(l,h);void 0!==m&&void 0!==g&&null!==(n=l[m])&&void 0!==n&&n.children&&(l[m].children[g]={...l[m].children[g],active:!0}),this.setState({searchGroups:l,activeSearchItem:h})}if(("Tab"===s||"Enter"===s)&&o&&r){e.preventDefault();const{activeSearchItem:t,searchGroups:s}=this.state,[r,o]=(0,X.iO)(s,t),n=void 0!==r&&void 0!==o&&s[r].children[o];return void(n&&this.onAutoComplete(n.value,n))}if("Enter"===s&&!o)return void this.doSearch();const l=this.cursorToken;if("["===s&&(null==l?void 0:l.type)===y.WU.Filter&&0===l.value.text.length&&(0,S._R)(l.value,this.cursorPosition)){const{query:t}=this.state;e.preventDefault();let s=null,r=null;const o="[]",n=l.value.location;s=l.key.location.end.offset+1,r=n.end.offset+1;const a=t.substring(0,s);let i=t.substring(r);i&&(i=` ${i}`);const c=`${a}${o}${i}`;this.updateQuery(c,a.length+o.length-1)}})),(0,o.Z)(this,"onKeyUp",(e=>{if("ArrowLeft"!==e.key&&"ArrowRight"!==e.key||this.updateAutoCompleteItems(),"Escape"!==e.key)return;e.preventDefault();const t=this.state.activeSearchItem>-1;if(!t)return void this.blur();const{searchGroups:s,activeSearchItem:r}=this.state,[o,n]=t?(0,X.iO)(s,r):[];void 0!==o&&void 0!==n&&delete s[o].children[n].active,this.setState({activeSearchItem:-1,searchGroups:[...this.state.searchGroups]})})),(0,o.Z)(this,"getTagValues",p()((async(e,t)=>{if(t=t.replace(/"/g,"").trim(),!this.props.onGetTagValues)return[];if(void 0!==this.state.noValueQuery&&t.startsWith(this.state.noValueQuery))return[];const{location:s}=this.props,r=(0,v.fK)(s.query);this.setState({loading:!0});let o=[];try{o=await this.props.onGetTagValues(e,t,r),this.setState({loading:!1})}catch(e){return this.setState({loading:!1}),d.Tb(e),[]}"release:"!==e.key||o.includes("latest")||o.unshift("latest");const n=0===o.length&&t.length>0?t:void 0;return this.setState({noValueQuery:n}),o.map((e=>{const t=e.includes(" ")||e.includes('"')?`"${e.replace(/"/g,'\\"')}"`:e;return{value:t,desc:t,type:F.q.TAG_VALUE}}))}),b.Dk,{leading:!0})),(0,o.Z)(this,"getPredefinedTagValues",((e,t)=>{var s;return(null!==(s=e.values)&&void 0!==s?s:[]).filter((e=>e.indexOf(t)>-1)).map(((t,s)=>({value:t,desc:t,type:F.q.TAG_VALUE,ignoreMaxSearchItems:!!e.maxSuggestedValues&&s<e.maxSuggestedValues})))})),(0,o.Z)(this,"getRecentSearches",p()((async()=>{const{savedSearchType:e,hasRecentSearches:t,onGetRecentSearches:s}=this.props;if(!(0,k.ri)(e)||!t)return[];const r=s||this.fetchRecentSearches;return await r(this.state.query)}),b.Dk,{leading:!0})),(0,o.Z)(this,"fetchRecentSearches",(async e=>{const{api:t,organization:s,savedSearchType:r}=this.props;if(void 0===r)return[];try{return(await(0,m.YO)(t,s.slug,r,e)).map((e=>({desc:e.query,value:e.query,type:F.q.RECENT_SEARCH})))}catch(e){d.Tb(e)}return[]})),(0,o.Z)(this,"getReleases",p()((async(e,t)=>{const s=this.fetchReleases(t);return[...this.getPredefinedTagValues(e,t).map((e=>({...e,type:F.q.FIRST_RELEASE}))),...(await s).map((e=>({value:e.shortVersion,desc:e.shortVersion,type:F.q.FIRST_RELEASE})))]}),b.Dk,{leading:!0})),(0,o.Z)(this,"fetchReleases",(async e=>{const{api:t,location:s,organization:r}=this.props,o=s&&s.query?s.query.projectId:void 0,n=`/organizations/${r.slug}/releases/`,a={per_page:b.vK};e&&(a.query=e),o&&(a.project=o);try{return await t.requestPromise(n,{method:"GET",query:a})}catch(e){(0,h.Iw)((0,T.t)("Unable to fetch releases")),d.Tb(e)}return[]})),(0,o.Z)(this,"generateValueAutocompleteGroup",(async(e,t)=>{var s;const{prepareQuery:r,excludeEnvironment:o}=this.props,n=null!==(s=this.props.supportedTags)&&void 0!==s?s:{},a="function"==typeof r?r(t):t,i=a?this.state.searchGroups.filter((e=>e.value&&-1!==e.value.indexOf(a))):this.state.searchGroups;this.setState({searchTerm:t,searchGroups:i});const l=n[e];if(!l)return{searchItems:[],recentSearchItems:[],tagName:e,type:F.q.INVALID_TAG};if(o&&"environment"===e)return null;const c="firstRelease"===l.key?this.getReleases:l.predefined?this.getPredefinedTagValues:this.getTagValues,[d,u]=await Promise.all([c(l,a),this.getRecentSearches()]);return{searchItems:null!=d?d:[],recentSearchItems:null!=u?u:[],tagName:l.key,type:F.q.TAG_VALUE}})),(0,o.Z)(this,"showDefaultSearches",(async()=>{const{query:e}=this.state,[t,s]=this.props.defaultSearchItems;if(t.length)this.setState({searchTerm:""}),this.updateAutoCompleteState(t,s,"",F.q.DEFAULT);else{this.setState({searchTerm:e});const[t,s]=this.getTagKeys(""),r=await this.getRecentSearches();this.updateAutoCompleteState(t,null!=r?r:[],"",s)}})),(0,o.Z)(this,"updateAutoCompleteFromAst",(async()=>{const e=this.cursorPosition,t=this.cursorToken;if(t)if(t.type!==y.WU.Filter){if(t.type===y.WU.FreeText){var s;const e=(null!==(s=t.text.trim().split(" ").pop())&&void 0!==s?s:"").replace(new RegExp(`^${b.c$}`),""),r=[await this.generateTagAutocompleteGroup(e)];return this.setState({searchTerm:e}),void this.updateAutoCompleteStateMultiHeader(r)}}else{const s=(0,S.Ck)(t.key,{aggregateWithArgs:!0});if((0,S._R)(t.value,e)){var r;const o=t.value,n=this.cursorValue;let a=null!==(r=null==n?void 0:n.text)&&void 0!==r?r:o.text;"[]"!==a&&null!==n||(a="");const i=await this.generateValueAutocompleteGroup(s,a),l=i?[i]:[];if(e===o.location.start.offset){const e=Y((0,X.Um)(t),s);l.unshift(e)}return void this.updateAutoCompleteStateMultiHeader(l)}if((0,S._R)(t.key,e)){const r=t.key,o=[await this.generateTagAutocompleteGroup(s)];if(e===r.location.end.offset){const e=Y((0,X.Um)(t),s);o.unshift(e)}return this.setState({searchTerm:s}),void this.updateAutoCompleteStateMultiHeader(o)}const o=Y((0,X.Um)(t),s);this.updateAutoCompleteStateMultiHeader([o])}else this.showDefaultSearches()})),(0,o.Z)(this,"updateAutoCompleteItems",(async()=>{window.clearTimeout(this.blurTimeout),this.blurTimeout=void 0,this.updateAutoCompleteFromAst()})),(0,o.Z)(this,"updateAutoCompleteStateMultiHeader",(e=>{const{hasRecentSearches:t,maxSearchItems:s,maxQueryLength:r}=this.props,{query:o}=this.state,n=r&&o?r-o.length:void 0,a=e.map((e=>{let{searchItems:r,recentSearchItems:o,tagName:a,type:i}=e;return(0,X.oe)(r,t?o:void 0,a,i,s,n)})).reduce(((e,t)=>({searchGroups:[...e.searchGroups,...t.searchGroups],flatSearchItems:[...e.flatSearchItems,...t.flatSearchItems],activeSearchItem:-1})),{searchGroups:[],flatSearchItems:[],activeSearchItem:-1});this.setState(a)})),(0,o.Z)(this,"updateQuery",((e,t)=>this.setState(K(e),(()=>{var s,r;this.searchInput.current&&(this.searchInput.current.focus(),t&&(this.searchInput.current.selectionStart=t,this.searchInput.current.selectionEnd=t)),this.updateAutoCompleteItems(),null===(s=(r=this.props).onChange)||void 0===s||s.call(r,e,new MouseEvent("click"))})))),(0,o.Z)(this,"onAutoCompleteFromAst",((e,t)=>{const s=this.cursorPosition,{query:r}=this.state,o=this.cursorToken;if(!o)return void this.updateQuery(`${r}${e}`);let n=null,a=null,i=e;if(o.type===y.WU.Filter)if(t.type===F.q.TAG_OPERATOR){(0,q.Z)("search.operator_autocompleted",{organization:this.props.organization,query:(0,X.WF)(r),search_operator:e,search_type:0===this.props.savedSearchType?"issues":"events"});const t=o.value.location;n=o.location.start.offset,a=t.start.offset,i="!:"===e?`!${o.key.text}:`:`${o.key.text}${e}`}else if((0,S._R)(o.value,s)){var l;const t=null!==(l=this.cursorValue)&&void 0!==l?l:o.value,s=t.location;if(o.filter===y.vA.TextIn){const e=null===this.cursorValue;n=e?this.cursorPosition:t.location.start.offset,a=e?this.cursorPosition:t.location.end.offset}else n=o.key.location.end.offset+1,a=s.end.offset+1,"user"===(0,S.Ck)(o.key)&&(i=`"${e.trim()}"`),"[]"===t.text?(n+=1,a-=2):i+=" "}else if((0,S._R)(o.key,s)){const e=o.key.location;n=e.start.offset,a=e.end.offset+1}if(o.type===y.WU.FreeText){const e=o.location.start.offset;n=o.text.startsWith(b.c$)?e+1:e,a=o.location.end.offset}if(null!==n&&null!==a){const e=r.substring(0,n),t=`${e}${i}${r.substring(a)}`;this.updateQuery(t,e.length+i.length)}})),(0,o.Z)(this,"onAutoComplete",((e,t)=>{if(t.type===F.q.RECENT_SEARCH)return(0,q.Z)("search.searched",{organization:this.props.organization,query:e,search_type:0===this.props.savedSearchType?"issues":"events",search_source:"recent_search"}),void this.setState(K(e),(()=>{this.doSearch()}));this.onAutoCompleteFromAst(e,t)}))}componentDidMount(){window.ResizeObserver&&null!==this.containerRef.current&&(this.inputResizeObserver=new ResizeObserver(this.updateActionsVisible),this.inputResizeObserver.observe(this.containerRef.current))}componentDidUpdate(e){const{query:t}=this.props,{query:s}=e;t!==s&&((0,k.ri)(t)||(0,k.ri)(s))&&this.setState(K((0,X.be)(null!=t?t:void 0)))}componentWillUnmount(){var e;null===(e=this.inputResizeObserver)||void 0===e||e.disconnect(),window.clearTimeout(this.blurTimeout)}get initialQuery(){const{query:e,defaultQuery:t}=this.props;return null!==e?(0,X.be)(e):null!=t?t:""}blur(){this.searchInput.current&&this.searchInput.current.blur()}async doSearch(){if(this.blur(),!this.hasValidSearch)return;const e=(0,X.WF)(this.state.query),{onSearch:t,onSavedRecentSearch:s,api:r,organization:o,savedSearchType:n,searchSource:a}=this.props;if((0,q.Z)("search.searched",{organization:o,query:e,search_type:0===n?"issues":"events",search_source:a}),(0,C.g)(t,e),void 0!==n&&e)try{await(0,m.VH)(r,o.slug,n,e),s&&s(e)}catch(e){d.Tb(e)}}get hasValidSearch(){const{parsedQuery:e}=this.state;return null===e||(0,S.ly)({tree:e,noResultValue:!0,visitorTest:e=>{let{token:t,returnResult:s,skipToken:r}=e;return t.type!==y.WU.Filter?null:t.invalid?s(!1):r}})}get cursorToken(){const e=[y.WU.Filter,y.WU.FreeText];return this.findTokensAtCursor(e)}get cursorValue(){const e=[y.WU.ValueText];return this.findTokensAtCursor(e)}get cursorPosition(){var e;return this.searchInput.current&&this.state.inputHasFocus&&null!==(e=this.searchInput.current.selectionStart)&&void 0!==e?e:-1}findTokensAtCursor(e){const{parsedQuery:t}=this.state;if(null===t)return null;const s=this.cursorPosition;return(0,S.ly)({tree:t,noResultValue:null,visitorTest:t=>{let{token:r,returnResult:o,skipToken:n}=t;return e.includes(r.type)?(0,S._R)(r,s)?o(r):n:null}})}getTagKeys(e){var t;const{prepareQuery:s,supportedTagType:r,getFieldDoc:o}=this.props,n=null!==(t=this.props.supportedTags)&&void 0!==t?t:{};let a=Object.keys(n).map((e=>`${e}:`));if(e){const t="function"==typeof s?s(e):e;a=a.filter((e=>e.indexOf(t)>-1))}return this.props.excludeEnvironment&&(a=a.filter((e=>"environment:"!==e))),[a.map((e=>{var t;return{value:e,desc:e,documentation:null!==(t=null==o?void 0:o(e.slice(0,-1)))&&void 0!==t?t:""}})).sort(((e,t)=>e.value.localeCompare(t.value))),null!=r?r:F.q.TAG_KEY]}async generateTagAutocompleteGroup(e){const[t,s]=this.getTagKeys(e),r=await this.getRecentSearches();return{searchItems:t,recentSearchItems:null!=r?r:[],tagName:e,type:s}}updateAutoCompleteState(e,t,s,r){const{hasRecentSearches:o,maxSearchItems:n,maxQueryLength:a}=this.props,{query:i}=this.state,l=a&&i?a-i.length:void 0;this.setState((0,X.oe)(e,o?t:void 0,s,r,n,l))}render(){const{api:e,className:t,savedSearchType:s,dropdownClassName:o,actionBarItems:n,organization:a,placeholder:i,disabled:l,useFormWrapper:c,inlineLabel:d,maxQueryLength:u}=this.props,{query:p,parsedQuery:h,searchGroups:m,searchTerm:g,inputHasFocus:v,numActionsVisible:y,loading:S}=this.state,b=(0,z.tZ)(ae,{type:"text",placeholder:i,id:"smart-search-input","data-test-id":"smart-search-input",name:"query",ref:this.searchInput,autoComplete:"off",value:p,onFocus:this.onQueryFocus,onBlur:this.onQueryBlur,onKeyUp:this.onKeyUp,onKeyDown:this.onKeyDown,onChange:this.onQueryChange,onClick:this.onInputClick,onPaste:this.onPaste,disabled:l,maxLength:u,spellCheck:!1}),w=null!=n?n:[],A={api:e,organization:a,query:p,savedSearchType:s},_=w.slice(0,y).map((e=>{let{key:t,Action:s}=e;return(0,z.tZ)(s,{...A},t)})),k=w.slice(y).map((e=>{let{key:t,Action:s}=e;return(0,z.tZ)(s,{...A,menuItemVariant:!0},t)})),q=this.cursorPosition;return(0,z.BX)(se,{ref:this.containerRef,className:t,inputHasFocus:v,children:[(0,z.BX)(re,{htmlFor:"smart-search-input","aria-label":(0,T.t)("Search events"),children:[(0,z.tZ)(Z.jV,{}),d]}),(0,z.BX)(oe,{children:[(0,z.tZ)(ne,{children:null!==h?(0,z.tZ)(x.Z,{parsedQuery:h,cursorPosition:-1===q?void 0:q}):p}),c?(0,z.tZ)("form",{onSubmit:this.onSubmit,children:b}):b]}),(0,z.BX)(ie,{gap:.5,children:[""!==p&&(0,z.tZ)(j.Kk,{onClick:this.clearSearch,icon:(0,z.tZ)(Z.bM,{size:"xs"}),title:(0,T.t)("Clear search"),"aria-label":(0,T.t)("Clear search")}),_,k.length>0&&(0,z.tZ)(f.Z,{anchorRight:!0,caret:!1,title:(0,z.tZ)(j.Kk,{"aria-label":(0,T.t)("Show more"),icon:(0,z.tZ)(le,{size:"xs"})}),children:k})]}),(S||m.length>0)&&(0,z.tZ)(V,{css:(0,r.iv)({display:v?"block":"none"},"",""),className:o,items:m,onClick:this.onAutoComplete,loading:S,searchSubstring:g})]})}}J.displayName="SmartSearchBar",(0,o.Z)(J,"defaultProps",{defaultQuery:"",query:null,onSearch:function(){},excludeEnvironment:!1,placeholder:(0,T.t)("Search for events, users, tags, and more"),supportedTags:{},defaultSearchItems:[[],[]],useFormWrapper:!0,savedSearchType:_.L4.ISSUE});class ee extends a.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",{members:w.Z.getAll()}),(0,o.Z)(this,"unsubscribe",w.Z.listen((e=>this.setState({members:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){return(0,z.tZ)(J,{...this.props,members:this.state.members})}}ee.displayName="SmartSearchBarContainer";const te=(0,R.Z)((0,l.withRouter)((0,I.Z)(ee))),se=(0,n.Z)("div",{target:"e1e683cn6"})("border:1px solid ",(e=>e.theme.border),";box-shadow:inset ",(e=>e.theme.dropShadowLight),";background:",(e=>e.theme.background),";padding:7px ",(0,A.Z)(1),";position:relative;display:grid;grid-template-columns:max-content 1fr max-content;gap:",(0,A.Z)(1),";align-items:start;border-radius:",(e=>e.theme.borderRadius),";.show-sidebar &{background:",(e=>e.theme.backgroundSecondary),";}",(e=>e.inputHasFocus&&`\n    border-color: ${e.theme.focusBorder};\n    box-shadow: 0 0 0 1px ${e.theme.focusBorder};\n  `),";"),re=(0,n.Z)("label",{target:"e1e683cn5"})("display:flex;padding:",(0,A.Z)(.5)," 0;margin:0;color:",(e=>e.theme.gray300),";"),oe=(0,n.Z)("div",{target:"e1e683cn4"})({name:"bjn8wh",styles:"position:relative"}),ne=(0,n.Z)("div",{target:"e1e683cn3"})("position:absolute;top:0;left:0;right:0;bottom:0;user-select:none;white-space:pre-wrap;word-break:break-word;line-height:25px;font-size:",(e=>e.theme.fontSizeSmall),";font-family:",(e=>e.theme.text.familyMono),";"),ae=(0,n.Z)(function(e){let{value:t}=e;return t}({value:i.Z,fixed:"textarea"}),{shouldForwardProp:e=>"string"==typeof e&&(0,c.Z)(e),target:"e1e683cn2"})("position:relative;display:flex;resize:none;outline:none;border:0;width:100%;padding:0;line-height:25px;margin-bottom:-1px;background:transparent;font-size:",(e=>e.theme.fontSizeSmall),";font-family:",(e=>e.theme.text.familyMono),";caret-color:",(e=>e.theme.subText),";color:transparent;&::selection{background:rgba(0, 0, 0, 0.2);}&::placeholder{color:",(e=>e.theme.formPlaceholder),";}[disabled]{color:",(e=>e.theme.disabled),";}"),ie=(0,n.Z)(g.ZP,{target:"e1e683cn1"})("height:",(0,A.Z)(2),";margin:",(0,A.Z)(.5)," 0;"),le=(0,n.Z)(Z.YR,{target:"e1e683cn0"})({name:"jbgpyq",styles:"transform:rotate(90deg)"})},"./app/components/smartSearchBar/types.tsx":(e,t,s)=>{let r;s.d(t,{q:()=>r}),function(e){e.DEFAULT="default",e.TAG_KEY="tag-key",e.TAG_VALUE="tag-value",e.TAG_OPERATOR="tag-operator",e.FIRST_RELEASE="first-release",e.INVALID_TAG="invalid-tag",e.RECENT_SEARCH="recent-search",e.PROPERTY="property"}(r||(r={}))},"./app/components/smartSearchBar/utils.tsx":(e,t,s)=>{s.d(t,{be:()=>l,WF:()=>c,oe:()=>p,iO:()=>h,th:()=>m,Um:()=>g}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("./app/components/searchSyntax/parser.tsx"),o=s("./app/icons/index.tsx"),n=s("./app/locale.tsx"),a=s("./app/components/smartSearchBar/types.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return 0!==e.length&&" "!==e[e.length-1]?e+" ":e}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return" "===e[e.length-1]?e.slice(0,e.length-1):e}function d(e){return e===a.q.TAG_VALUE?(0,n.t)("Tag Values"):e===a.q.RECENT_SEARCH?(0,n.t)("Recent Searches"):e===a.q.DEFAULT?(0,n.t)("Common Search Terms"):e===a.q.TAG_OPERATOR?(0,n.t)("Operator Helpers"):e===a.q.PROPERTY?(0,n.t)("Properties"):(0,n.t)("Tags")}function u(e,t){if(e===a.q.RECENT_SEARCH)return(0,i.tZ)(o.jo,{size:"xs"});if(e===a.q.DEFAULT)return(0,i.tZ)(o.GK,{size:"xs"});switch(t){case"is":return(0,i.tZ)(o.oe,{size:"xs"});case"assigned":case"bookmarks":return(0,i.tZ)(o.qO,{size:"xs"});case"firstSeen":case"lastSeen":case"event.timestamp":return(0,i.tZ)(o.jo,{size:"xs"});default:return(0,i.tZ)(o.Ah,{size:"xs"})}}function p(e,t,s,r,l,c){l&&l>0&&(e=e.filter(((e,t)=>t<l||e.ignoreMaxSearchItems))),(c||0===c)&&(e=e.filter((e=>e.value.length<=c)),t&&(t=t.filter((e=>e.value.length<=c))));const p={title:d(r),type:r===a.q.INVALID_TAG?r:"header",icon:u(r,s),children:[...e]},h=t&&{title:(0,n.t)("Recent Searches"),type:"header",icon:(0,i.tZ)(o.jo,{size:"xs"}),children:[...t]};return p.children&&p.children.length&&(p.children[0]={...p.children[0]}),{searchGroups:[p,...h?[h]:[]],flatSearchItems:[...e,...t||[]],activeSearchItem:-1}}function h(e,t){let s=t,r=[void 0,void 0];return e.find(((e,t)=>{let{children:o}=e;return!(!o||!o.length||(s<o.length?(r=[t,s],0):(s-=o.length,1)))})),r}function m(e){return{[r.oV.Default]:{type:a.q.TAG_OPERATOR,value:":",desc:`${e}:${(0,n.t)("[value] is equal to")}`},[r.oV.GreaterThanEqual]:{type:a.q.TAG_OPERATOR,value:":>=",desc:`${e}:${(0,n.t)(">=[value] is greater than or equal to")}`},[r.oV.LessThanEqual]:{type:a.q.TAG_OPERATOR,value:":<=",desc:`${e}:${(0,n.t)("<=[value] is less than or equal to")}`},[r.oV.GreaterThan]:{type:a.q.TAG_OPERATOR,value:":>",desc:`${e}:${(0,n.t)(">[value] is greater than")}`},[r.oV.LessThan]:{type:a.q.TAG_OPERATOR,value:":<",desc:`${e}:${(0,n.t)("<[value] is less than")}`},[r.oV.Equal]:{type:a.q.TAG_OPERATOR,value:":=",desc:`${e}:${(0,n.t)("=[value] is equal to")}`},[r.oV.NotEqual]:{type:a.q.TAG_OPERATOR,value:"!:",desc:`!${e}:${(0,n.t)("[value] is not equal to")}`}}}function g(e){var t,s;const o=null!==(t=null===(s=e.invalid)||void 0===s?void 0:s.expectedType)&&void 0!==t?t:[e.filter],n=o.map((e=>{var t;return null!==(t=r.J$[e])&&void 0!==t?t:[]})),a=[...new Set([...o,...n.flat()])];return[...new Set(a.map((e=>r.iq[e].validOps)).flat())]}}}]);
//# sourceMappingURL=../sourcemaps/app_components_checkbox_tsx-app_components_forms_controls_radioGroup_tsx-app_components_smart-ed2d6d.7baf768fb9dda66e5f6bd7d6a7e28a9f.js.map