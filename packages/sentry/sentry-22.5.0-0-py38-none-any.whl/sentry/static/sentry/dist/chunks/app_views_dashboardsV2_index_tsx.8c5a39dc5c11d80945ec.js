"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboardsV2_index_tsx","app_views_dashboardsV2_view_tsx"],{"./app/views/dashboardsV2/index.tsx":(a,s,e)=>{e.r(s),e.d(s,{default:()=>m});var o=e("../node_modules/react/index.js"),t=e("./app/components/errorBoundary.tsx"),r=e("./app/components/errors/notFound.tsx"),d=e("./app/components/loadingIndicator.tsx"),n=e("./app/utils/withApi.tsx"),i=e("./app/utils/withOrganization.tsx"),p=e("./app/views/dashboardsV2/detail.tsx"),l=e("./app/views/dashboardsV2/orgDashboards.tsx"),h=e("./app/views/dashboardsV2/types.tsx"),c=e("./app/views/dashboardsV2/view.tsx"),u=e("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function b(a){const{organization:s,params:e,api:n,location:i,children:b}=a;return s.features.includes("dashboards-edit")?(0,u.tZ)(o.Fragment,{children:b}):(0,u.tZ)(c.DashboardBasicFeature,{organization:s,children:(0,u.tZ)(l.Z,{api:n,location:i,params:e,organization:s,children:s=>{let{dashboard:e,dashboards:o,error:n,onDashboardUpdate:i}=s;return n?(0,u.tZ)(r.Z,{}):e?(0,u.tZ)(t.Z,{children:(0,u.tZ)(p.Z,{...a,initialState:h.n3.VIEW,dashboard:e,dashboards:o,onDashboardUpdate:i})}):(0,u.tZ)(d.Z,{})}})})}b.displayName="DashboardsV2Container";const m=(0,n.Z)((0,i.Z)(b))},"./app/views/dashboardsV2/orgDashboards.tsx":(a,s,e)=>{e.d(s,{Z:()=>x});var o=e("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),t=(e("../node_modules/core-js/modules/web.dom-collections.iterator.js"),e("../node_modules/core-js/modules/es.string.replace.js"),e("../node_modules/react-router/es/index.js")),r=e("../node_modules/lodash/isEqual.js"),d=e.n(r),n=e("./app/components/asyncComponent.tsx"),i=e("./app/components/errors/notFound.tsx"),p=e("./app/components/loadingIndicator.tsx"),l=e("./app/components/sentryDocumentTitle.tsx"),h=e("./app/locale.tsx"),c=e("./app/styles/organization.tsx"),u=e("./app/utils/analytics.tsx"),b=e("./app/views/dashboardsV2/layoutUtils.tsx"),m=e("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends n.Z{constructor(){super(...arguments),(0,o.Z)(this,"state",{loading:!0,reloading:!1,error:!1,errors:{},dashboards:[],selectedDashboard:null})}componentDidUpdate(a){d()(a.params.dashboardId,this.props.params.dashboardId)||this.remountComponent()}getEndpoints(){const{organization:a,params:s}=this.props,e=`/organizations/${a.slug}/dashboards/`,o=[["dashboards",e]];return s.dashboardId&&(o.push(["selectedDashboard",`${e}${s.dashboardId}/`]),(0,u.ec)({eventKey:"dashboards2.view",eventName:"Dashboards2: View dashboard",organization_id:parseInt(this.props.organization.id,10),dashboard_id:s.dashboardId})),o}onDashboardUpdate(a){this.setState({selectedDashboard:a})}getDashboards(){const{dashboards:a}=this.state;return Array.isArray(a)?a:[]}onRequestSuccess(a){let{stateKey:s,data:e}=a;const{params:o,organization:r,location:d}=this.props;if(o.dashboardId||"selectedDashboard"===s)return;const n=e.length?e[0].id:"default-overview",i=`/organizations/${r.slug}/dashboard/${n}/`;t.browserHistory.replace({pathname:i,query:{...d.query}})}renderLoading(){return(0,m.tZ)(c.JH,{children:(0,m.tZ)(p.Z,{})})}renderBody(){const{children:a,organization:s}=this.props,{selectedDashboard:e,error:o}=this.state;let t=e;return s.features.includes("dashboard-grid-layout")&&(t=e?{...e,widgets:e.widgets.map(b.TE)}:null),a({error:o,dashboard:t,dashboards:this.getDashboards(),onDashboardUpdate:a=>this.onDashboardUpdate(a)})}renderError(a){return Object.values(this.state.errors).find((a=>a&&404===a.status))?(0,m.tZ)(i.Z,{}):super.renderError(a,!0)}renderComponent(){const{organization:a,location:s}=this.props;return a.features.includes("dashboards-basic")?(0,m.tZ)(l.Z,{title:(0,h.t)("Dashboards"),orgSlug:a.slug,children:super.renderComponent()}):(t.browserHistory.replace({pathname:`/organizations/${a.slug}/dashboards/`,query:{...s.query}}),null)}}const x=g},"./app/views/dashboardsV2/view.tsx":(a,s,e)=>{e.r(s),e.d(s,{default:()=>_,DashboardBasicFeature:()=>z}),e("../node_modules/core-js/modules/web.dom-collections.iterator.js"),e("../node_modules/core-js/modules/es.string.replace.js");var o=e("../node_modules/react/index.js"),t=e("../node_modules/react-router/es/index.js"),r=e("../node_modules/lodash/pick.js"),d=e.n(r),n=e("./app/actionCreators/dashboards.tsx"),i=e("./app/components/acl/feature.tsx"),p=e("./app/components/alert.tsx"),l=e("./app/components/errorBoundary.tsx"),h=e("./app/components/errors/notFound.tsx"),c=e("./app/components/loadingIndicator.tsx"),u=e("./app/locale.tsx"),b=e("./app/styles/organization.tsx"),m=e("./app/utils/useApi.tsx"),g=e("./app/utils/withOrganization.tsx"),x=e("./app/views/dashboardsV2/detail.tsx"),Z=e("./app/views/dashboardsV2/orgDashboards.tsx"),w=e("./app/views/dashboardsV2/types.tsx"),y=e("./app/views/dashboardsV2/utils.tsx"),v=e("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const D=["start","end","utc","period","project","environment"];function j(a){const s=(0,m.Z)(),{organization:e,params:r,location:i}=a,p=r.dashboardId,u=e.slug,[b,g]=(0,o.useState)(),[j,_]=(0,o.useState)(w.n3.VIEW);return(0,o.useEffect)((()=>{p&&"default-overview"!==p&&(0,n.a_)(s,u,p)}),[s,u,p]),(0,o.useEffect)((()=>{const a=(0,y.y1)(i.query);g(a),a&&(_(w.n3.EDIT),t.browserHistory.replace({pathname:i.pathname,query:d()(i.query,D)}))}),[i.pathname]),(0,v.tZ)(z,{organization:e,children:(0,v.tZ)(Z.Z,{api:s,location:i,params:r,organization:e,children:s=>{let{dashboard:e,dashboards:o,error:t,onDashboardUpdate:r}=s;return t?(0,v.tZ)(h.Z,{}):e?(0,v.tZ)(l.Z,{children:(0,v.tZ)(x.Z,{...a,initialState:j,dashboard:e,dashboards:o,onDashboardUpdate:r,newWidget:b,onSetNewWidget:()=>g(void 0)})}):(0,v.tZ)(c.Z,{})}})})}j.displayName="ViewEditDashboard";const _=(0,g.Z)(j),z=a=>{let{organization:s,children:e}=a;return(0,v.tZ)(i.Z,{hookName:"feature-disabled:dashboards-page",features:["organizations:dashboards-basic"],organization:s,renderDisabled:()=>(0,v.tZ)(b.JH,{children:(0,v.tZ)(p.Z,{type:"warning",children:(0,u.t)("You don't have access to this feature")})}),children:e})};z.displayName="DashboardBasicFeature"}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboardsV2_index_tsx.cbe0a42ee32a15cf48e1c59f840ffc0b.js.map