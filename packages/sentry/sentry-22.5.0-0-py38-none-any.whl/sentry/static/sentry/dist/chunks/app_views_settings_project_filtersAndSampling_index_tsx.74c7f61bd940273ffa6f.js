(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_filtersAndSampling_index_tsx"],{"./app/components/actions/menuItemActionLink.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/components/actions/actionLink.tsx"),a=n("./app/components/menuItem.tsx"),o=n("./app/styles/overflowEllipsis.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{className:t,...n}=e;return(0,i.tZ)(a.Z,{noAnchor:!0,withBorder:!0,disabled:n.disabled,className:t,children:(0,i.tZ)(d,{...n})})}l.displayName="MenuItemActionLink";const d=(0,s.Z)(r.Z,{target:"e18s0uh10"})("color:",(e=>e.theme.textColor),";",o.Z," &:hover{color:",(e=>e.theme.textColor),";}.dropdown-menu>li>&,.dropdown-menu>span>li>&{&.disabled:hover{background:",(e=>e.theme.background),";}}"),c=l},"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n("./app/components/asyncComponent.tsx"),r=n("./app/components/sentryDocumentTitle.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class o extends s.Z{getTitle(){return""}render(){return(0,a.tZ)(r.Z,{title:this.getTitle(),children:this.renderComponent()})}}o.displayName="AsyncView"},"./app/views/settings/organization/permissionAlert.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n("./app/components/acl/access.tsx"),r=n("./app/components/alert.tsx"),a=n("./app/locale.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=e=>{let{access:t=["org:write"],...n}=e;return(0,o.tZ)(s.Z,{access:t,children:e=>{let{hasAccess:t}=e;return!t&&(0,o.tZ)(r.Z,{type:"warning",showIcon:!0,...n,children:(0,a.t)("These settings can only be edited by users with the organization owner or manager role.")})}})};i.displayName="PermissionAlert";const l=i},"./app/views/settings/project/filtersAndSampling/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>on});var s=n("./app/components/acl/access.tsx"),r=n("./app/components/acl/feature.tsx"),a=n("./app/components/acl/featureDisabled.tsx"),o=n("./app/components/panels/index.tsx"),i=n("./app/locale.tsx"),l=n("./app/utils/withOrganization.tsx"),d=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),u=n("../node_modules/lodash/partition.js"),p=n.n(u),E=n("./app/actionCreators/indicator.tsx"),m=n("./app/actionCreators/modal.tsx"),h=n("./app/components/alert.tsx"),g=n("./app/components/links/externalLink.tsx");let _,R,T,S,N;!function(e){e.TRACE="trace",e.TRANSACTION="transaction",e.ERROR="error"}(_||(_={})),function(e){e.NOT="not",e.OR="or",e.AND="and"}(R||(R={})),function(e){e.GLOB_MATCH="glob",e.EQUAL="eq",e.CUSTOM="custom"}(T||(T={})),function(e){e.TRACE_RELEASE="trace.release",e.TRACE_ENVIRONMENT="trace.environment",e.TRACE_USER_ID="trace.user.id",e.TRACE_USER_SEGMENT="trace.user.segment",e.TRACE_TRANSACTION="trace.transaction",e.EVENT_RELEASE="event.release",e.EVENT_ENVIRONMENT="event.environment",e.EVENT_USER_ID="event.user.id",e.EVENT_USER_SEGMENT="event.user.segment",e.EVENT_LOCALHOST="event.is_local_ip",e.EVENT_WEB_CRAWLERS="event.web_crawlers",e.EVENT_BROWSER_EXTENSIONS="event.has_bad_browser_extensions",e.EVENT_TRANSACTION="event.transaction",e.EVENT_OS_NAME="event.contexts.os.name",e.EVENT_OS_VERSION="event.contexts.os.version",e.EVENT_DEVICE_NAME="event.contexts.device.name",e.EVENT_DEVICE_FAMILY="event.contexts.device.family",e.EVENT_IP_ADDRESSES="event.client_ip",e.EVENT_LEGACY_BROWSER="event.legacy_browser",e.EVENT_ERROR_MESSAGES="event.error_messages",e.EVENT_CSP="event.csp",e.EVENT_CUSTOM_TAG="event.custom_tag"}(S||(S={})),function(e){e.IE_PRE_9="ie_pre_9",e.IE9="ie9",e.IE10="ie10",e.IE11="ie11",e.SAFARI_PRE_6="safari_pre_6",e.OPERA_PRE_15="opera_pre_15",e.OPERA_MINI_PRE_8="opera_mini_pre_8",e.ANDROID_PRE_4="android_pre_4"}(N||(N={}));var y=n("./app/utils/withProject.tsx"),A=n("./app/views/asyncView.tsx"),f=n("./app/views/settings/components/settingsPageHeader.tsx"),b=n("./app/views/settings/components/text/textBlock.tsx"),Z=n("./app/views/settings/organization/permissionAlert.tsx"),v=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),C=n("../node_modules/@sentry/minimal/esm/index.js"),x=n("./app/utils/theme.tsx");const w="https://docs.sentry.io/product/data-management-settings/filtering/",I={[N.IE_PRE_9]:{icon:"internet-explorer",title:(0,i.t)("Internet Explorer version 8 and lower")},[N.IE9]:{icon:"internet-explorer",title:(0,i.t)("Internet Explorer version 9")},[N.IE10]:{icon:"internet-explorer",title:(0,i.t)("Internet Explorer version 10")},[N.IE11]:{icon:"internet-explorer",title:(0,i.t)("Internet Explorer version 11")},[N.SAFARI_PRE_6]:{icon:"safari",title:(0,i.t)("Safari version 5 and lower")},[N.OPERA_PRE_15]:{icon:"opera",title:(0,i.t)("Opera version 14 and lower")},[N.OPERA_MINI_PRE_8]:{icon:"opera",title:(0,i.t)("Opera Mini version 8 and lower")},[N.ANDROID_PRE_4]:{icon:"android",title:(0,i.t)("Android version 3 and lower")}};function V(e){switch(e){case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,i.t)("Environment");case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,i.t)("Release");case S.EVENT_USER_ID:case S.TRACE_USER_ID:return(0,i.t)("User Id");case S.EVENT_USER_SEGMENT:case S.TRACE_USER_SEGMENT:return(0,i.t)("User Segment");case S.EVENT_BROWSER_EXTENSIONS:return(0,i.t)("Browser Extensions");case S.EVENT_LOCALHOST:return(0,i.t)("Localhost");case S.EVENT_WEB_CRAWLERS:return(0,i.t)("Web Crawlers");case S.EVENT_LEGACY_BROWSER:return(0,i.t)("Legacy Browser");case S.EVENT_TRANSACTION:case S.TRACE_TRANSACTION:return(0,i.t)("Transaction");case S.EVENT_ERROR_MESSAGES:return(0,i.t)("Error Message");case S.EVENT_CSP:return(0,i.t)("Content Security Policy");case S.EVENT_IP_ADDRESSES:return(0,i.t)("IP Address");case S.EVENT_OS_NAME:return(0,i.t)("OS Name");case S.EVENT_OS_VERSION:return(0,i.t)("OS Version");case S.EVENT_DEVICE_FAMILY:return(0,i.t)("Device Family");case S.EVENT_DEVICE_NAME:return(0,i.t)("Device Name");case S.EVENT_CUSTOM_TAG:return(0,i.t)("Custom Tag");default:return C.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}const O=(0,v.iv)("[role='document']{overflow:initial;}@media (min-width: ",x.ZP.breakpoints[0],"){width:100%;max-width:700px;}","");let M;function k(e){switch(e){case S.EVENT_LEGACY_BROWSER:return(0,i.t)("Match all selected legacy browsers below");case S.EVENT_BROWSER_EXTENSIONS:return(0,i.t)("Match all browser extensions");case S.EVENT_LOCALHOST:return(0,i.t)("Match all localhosts");case S.EVENT_WEB_CRAWLERS:return(0,i.t)("Match all web crawlers");case S.EVENT_USER_ID:case S.TRACE_USER_ID:return(0,i.t)("ex. 4711 (Multiline)");case S.EVENT_USER_SEGMENT:case S.TRACE_USER_SEGMENT:return(0,i.t)("ex. paid, common (Multiline)");case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,i.t)("ex. prod, dev");case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,i.t)("ex. 1*, [I3].[0-9].*");case S.EVENT_IP_ADDRESSES:return(0,i.t)("ex. 127.0.0.1 or 10.0.0.0/8 (Multiline)");case S.EVENT_CSP:return(0,i.t)("ex. file://*, example.com (Multiline)");case S.EVENT_ERROR_MESSAGES:return(0,i.t)("ex. TypeError* (Multiline)");case S.TRACE_TRANSACTION:case S.EVENT_TRANSACTION:return(0,i.t)("ex. page-load");case S.EVENT_OS_NAME:return(0,i.t)("ex. Mac OS X, Windows");case S.EVENT_OS_VERSION:return(0,i.t)("ex. 11, 9*");case S.EVENT_DEVICE_FAMILY:case S.EVENT_DEVICE_NAME:return(0,i.t)("ex. Mac, Pixel*");case S.EVENT_CUSTOM_TAG:return(0,i.t)("Enter tag values");default:return C.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}function j(e){var t,n;if(e.category===S.EVENT_BROWSER_EXTENSIONS||e.category===S.EVENT_WEB_CRAWLERS||e.category===S.EVENT_LOCALHOST)return{op:T.EQUAL,name:e.category,value:!0};if(e.category===S.EVENT_LEGACY_BROWSER)return{op:T.CUSTOM,name:e.category,value:null!==(n=e.legacyBrowsers)&&void 0!==n?n:[]};const s=(null!==(t=e.match)&&void 0!==t?t:"").split("\n").filter((e=>!!e.trim())).map((e=>e.trim()));return e.category===S.EVENT_IP_ADDRESSES||e.category===S.EVENT_ERROR_MESSAGES||e.category===S.EVENT_CSP?{op:T.CUSTOM,name:e.category,value:s}:e.category===S.EVENT_RELEASE||e.category===S.TRACE_RELEASE||e.category===S.EVENT_TRANSACTION||e.category===S.TRACE_TRANSACTION||e.category===S.EVENT_OS_NAME||e.category===S.EVENT_OS_VERSION||e.category===S.EVENT_DEVICE_FAMILY||e.category===S.EVENT_DEVICE_NAME?{op:T.GLOB_MATCH,name:e.category,value:s}:e.category===S.TRACE_USER_ID||e.category===S.EVENT_USER_ID?{op:T.EQUAL,name:e.category,value:s,options:{ignoreCase:!1}}:e.category===S.EVENT_CUSTOM_TAG?{op:T.GLOB_MATCH,name:e.category,value:s,tagKey:e.tagKey}:{op:T.EQUAL,name:e.category,value:s,options:{ignoreCase:!0}}}!function(e){e.ALL="all",e.MATCH_CONDITIONS="match-conditions"}(M||(M={}));const D=(0,i.t)("An internal error occurred while saving dynamic sampling rule");function L(e){var t;switch(e.category){case S.EVENT_CUSTOM_TAG:return null!==(t=e.tagKey)&&void 0!==t?t:"";case S.TRACE_RELEASE:case S.EVENT_RELEASE:return"release";case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return"environment";case S.TRACE_TRANSACTION:case S.EVENT_TRANSACTION:return"transaction";case S.EVENT_OS_NAME:return"os.name";case S.EVENT_OS_VERSION:return"os.version";case S.EVENT_DEVICE_FAMILY:return"device.family";case S.EVENT_DEVICE_NAME:return"device.name";default:return C.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}function U(e){const t=e.includes(S.EVENT_CUSTOM_TAG),n=e.filter((e=>e!==S.EVENT_CUSTOM_TAG)).sort(((e,t)=>V(e).localeCompare(V(t))));return t&&n.push(S.EVENT_CUSTOM_TAG),n.map((e=>[e,V(e)]))}function P(e){return e.name===S.EVENT_CUSTOM_TAG}var B=n("../node_modules/lodash/isEqual.js"),G=n.n(B),z=n("./app/utils.tsx"),F=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),X=n("../node_modules/react-select/dist/base/dist/react-select-cac0a5ae.browser.esm.js"),W=n("../node_modules/react-select/dist/chunk-80640036.browser.esm.js"),Y=n("./app/components/button.tsx"),$=n("./app/components/buttonBar.tsx"),q=n("./app/components/forms/compactSelect.tsx"),H=n("./app/components/forms/numberField.tsx"),K=n("./app/components/forms/selectOption.tsx"),Q=n("./app/icons/index.tsx"),J=n("./app/icons/iconCheckmark.tsx"),ee=n("./app/styles/space.tsx"),te=n("./app/views/settings/components/emptyMessage.tsx"),ne=n("./app/components/forms/field/fieldRequiredBadge.tsx"),se=n("./app/components/forms/textareaField.tsx"),re=n("./app/icons/iconDelete.tsx"),ae=n("../node_modules/lodash/intersection.js"),oe=n.n(ae),ie=n("../node_modules/lodash/uniq.js"),le=n.n(ie),de=n("../node_modules/lodash/xor.js"),ce=n.n(de),ue=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function pe(e){let{selectedRowsCount:t,columnsCount:n,isPageSelected:s,isAllSelected:r,onSelectAllRows:a,onUnselectAllRows:o,bulkLimit:l,allRowsCount:d,className:u}=e;if(d&&d<=t||!s)return null;const{noticeText:p,actionText:E}=function(e,t){return(0,z.ri)(e)?t&&e>t?{noticeText:(0,i._N)("Selected up to the first [count] items.",{count:t}),actionText:(0,i._N)("Select the first [count] items.",{count:t})}:{noticeText:(0,i._N)("Selected all [count] items.",{count:e}),actionText:(0,i._N)("Select all [count] items.",{count:e})}:{noticeText:(0,i.t)("Selected all items across all pages."),actionText:(0,i.t)("Select all items across all pages.")}}(d,l);return(0,ue.tZ)(Ee,{columnsCount:n,className:u,children:r?(0,ue.BX)(c.Fragment,{children:[p," ",(0,ue.tZ)(me,{priority:"link",onClick:o,children:(0,i.t)("Cancel selection.")})]}):(0,ue.BX)(c.Fragment,{children:[(0,i.tn)("%s item on this page selected.","%s items on this page selected.",t)," ",(0,ue.tZ)(me,{priority:"link",onClick:a,children:E})]})})}pe.displayName="BulkNotice";const Ee=(0,F.Z)((e=>{let{columnsCount:t,...n}=e;return(0,ue.tZ)(o.aU,{...n})}),{target:"e1cwk49q1"})("grid-column:span ",(e=>e.columnsCount),";text-align:center;"),me=(0,F.Z)(Y.ZP,{target:"e1cwk49q0"})("&,&:hover,&:active,&:focus{color:",(e=>e.theme.textColor),";border:none;border-radius:0;border-bottom:1px dotted ",(e=>e.theme.textColor),";padding-bottom:1px;font-size:15px;}"),he=pe;class ge extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",this.getInitialState()),(0,d.Z)(this,"handleRowToggle",(e=>{this.setState((t=>({selectedIds:ce()(t.selectedIds,[e]),isAllSelected:!1})))})),(0,d.Z)(this,"handleAllRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState({selectedIds:e?[...t]:[],isAllSelected:e})})),(0,d.Z)(this,"handlePageRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState((n=>({selectedIds:e?le()([...n.selectedIds,...t]):n.selectedIds.filter((e=>!t.includes(e))),isAllSelected:!1})))}))}getInitialState(){const{defaultSelectedIds:e,pageIds:t}=this.props;return{selectedIds:oe()(null!=e?e:[],t),isAllSelected:!1}}static getDerivedStateFromProps(e,t){return{...t,selectedIds:oe()(t.selectedIds,e.pageIds)}}componentDidUpdate(e,t){var n,s;G()(t,this.state)||null===(n=(s=this.props).onChange)||void 0===n||n.call(s,this.state)}render(){const{pageIds:e,children:t,columnsCount:n,allRowsCount:s,bulkLimit:r}=this.props,{selectedIds:a,isAllSelected:o}=this.state,i=e.length>0&&e.every((e=>a.includes(e)));return t({selectedIds:a,isAllSelected:o,isPageSelected:i,onRowToggle:this.handleRowToggle,onAllRowsToggle:this.handleAllRowsToggle,onPageRowsToggle:this.handlePageRowsToggle,renderBulkNotice:()=>(0,ue.tZ)(he,{allRowsCount:s,selectedRowsCount:a.length,onUnselectAllRows:()=>this.handleAllRowsToggle(!1),onSelectAllRows:()=>this.handleAllRowsToggle(!0),columnsCount:n,isPageSelected:i,isAllSelected:o,bulkLimit:r})})}}ge.displayName="BulkController";const _e=ge;var Re=n("./app/components/switchButton.tsx");const Te=Object.values(N);function Se(e){let{onChange:t,selectedLegacyBrowsers:n=[]}=e;return(0,ue.tZ)(_e,{pageIds:Te,defaultSelectedIds:n,allRowsCount:Te.length,onChange:function(e){let{selectedIds:n}=e;t(n)},columnsCount:0,children:e=>{let{selectedIds:t,onRowToggle:n,onPageRowsToggle:s,isPageSelected:r}=e;return(0,ue.BX)(ye,{children:[(0,i.t)("All browsers"),(0,ue.tZ)(Re.Z,{size:"lg",isActive:r,toggle:()=>{s(!r)}},"switch"),Te.map((e=>{const{icon:s,title:r}=I[e];return(0,ue.BX)(c.Fragment,{children:[(0,ue.BX)(Ae,{children:[(0,ue.tZ)(fe,{className:`icon-${s}`,"data-test-id":`icon-${s}`}),r]}),(0,ue.tZ)(Re.Z,{size:"lg",isActive:t.includes(e),toggle:()=>n(e)})]},e)}))]})}})}Se.displayName="LegacyBrowsers";const Ne=Se,ye=(0,F.Z)("div",{target:"evvj4pe2"})("grid-column:1/-1;display:grid;grid-template-columns:1fr max-content;gap:",(0,ee.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray400),";padding-top:",(0,ee.Z)(2),";padding-bottom:",(0,ee.Z)(1),";"),Ae=(0,F.Z)("div",{target:"evvj4pe1"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,ee.Z)(1),";color:",(e=>e.theme.gray500),";"),fe=(0,F.Z)("div",{target:"evvj4pe0"})({name:"1bjfr92",styles:"width:24px;height:24px;background-repeat:no-repeat;background-position:center;background-size:24px 24px;flex-shrink:0"});var be=n("./app/components/forms/selectField.tsx"),Ze=n("./app/utils/useApi.tsx");function ve(e){let{onChange:t,orgSlug:n,projectSlug:s,value:r}=e;const[a,o]=(0,c.useState)(r?[{key:r,name:r}]:[]),l=(0,Ze.Z)(),d=(0,c.useCallback)((async()=>{try{const e=await l.requestPromise(`/projects/${n}/${s}/tags/`);o(e)}catch{}}),[l,n,s]);return(0,c.useEffect)((()=>{d()}),[d]),(0,ue.tZ)(Ce,{children:(0,ue.tZ)(be.Z,{name:"customTagKey",options:a.map((e=>{let{key:t}=e;return{value:t,label:t}})),inline:!1,stacked:!0,hideControlState:!0,required:!0,creatable:!0,placeholder:(0,i.t)("tag"),onChange:t,value:r})})}ve.displayName="TagKeyAutocomplete";const Ce=(0,F.Z)("div",{target:"e1vmypmv0"})({name:"1d3w5wq",styles:"width:100%"});var xe=n("./app/actionCreators/tags.tsx");function we(e){let{orgSlug:t,projectId:n,category:s,onChange:r,value:a,tagKey:o}=e;const l=(0,Ze.Z)(),[d,u]=(0,c.useState)([]),p=(0,c.useCallback)((async()=>{if(o)try{const e=await(0,xe.Fo)(l,t,o,null,[n]);u(e)}catch{}}),[o,l,t,n]);(0,c.useEffect)((()=>{p()}),[p]);const E=a?a.split(",").filter((e=>!d.some((t=>t.value===e)))).map((e=>({value:e}))):[];return(0,ue.tZ)(Ie,{name:"match","aria-label":function(){switch(s){case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,i.t)("Search or add a release");case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,i.t)("Search or add an environment");case S.TRACE_TRANSACTION:case S.EVENT_TRANSACTION:return(0,i.t)("Search or add a transaction");case S.EVENT_OS_NAME:return(0,i.t)("Search or add an os name");case S.EVENT_OS_VERSION:return(0,i.t)("Search or add an os version");case S.EVENT_DEVICE_FAMILY:return(0,i.t)("Search or add a device family");case S.EVENT_DEVICE_NAME:return(0,i.t)("Search or add a device name");case S.EVENT_CUSTOM_TAG:return(0,i.t)("Search or add tag values");default:return C.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}(),options:[...E,...d].map((e=>({value:e.value,label:e.value}))),value:null==a?void 0:a.split(","),onChange:e=>{r(null==e?void 0:e.join(","))},styles:{menu:e=>({...e,wordBreak:"break-all"})},components:{SelectContainer:e=>(0,ue.tZ)(W.y.SelectContainer,{...e,innerProps:{...e.innerProps,"data-test-id":`autocomplete-${o}`}}),MultiValue:e=>(0,ue.tZ)(W.y.MultiValue,{...e,innerProps:{...e.innerProps,"data-test-id":"multivalue"}}),Option:e=>(0,ue.tZ)(W.y.Option,{...e,innerProps:{...e.innerProps,"data-test-id":"option"}})},formatCreateLabel:e=>(0,i._N)('Add "[newLabel]"',{newLabel:e}),placeholder:k(s),inline:!1,multiple:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0,creatable:!0,allowClear:!0})}we.displayName="TagValueAutocomplete";const Ie=(0,F.Z)(be.Z,{target:"e1vyjdb80"})({name:"1d3w5wq",styles:"width:100%"});function Ve(e){let{conditions:t,orgSlug:n,projectId:s,projectSlug:r,onDelete:a,onChange:o}=e;return(0,ue.tZ)(c.Fragment,{children:t.map(((e,t)=>{const{category:l,match:d,legacyBrowsers:c,tagKey:u}=e,p=l===S.EVENT_LEGACY_BROWSER,E=[S.EVENT_BROWSER_EXTENSIONS,S.EVENT_LOCALHOST,S.EVENT_WEB_CRAWLERS].includes(l)||p,m=l===S.EVENT_ENVIRONMENT||l===S.EVENT_RELEASE||l===S.EVENT_TRANSACTION||l===S.EVENT_OS_NAME||l===S.EVENT_DEVICE_FAMILY||l===S.EVENT_DEVICE_NAME||l===S.EVENT_CUSTOM_TAG||l===S.TRACE_ENVIRONMENT||l===S.TRACE_RELEASE||l===S.TRACE_TRANSACTION,h=l===S.EVENT_CUSTOM_TAG;return(0,ue.BX)(Me,{children:[(0,ue.tZ)(je,{children:h?(0,ue.tZ)(ve,{orgSlug:n,projectSlug:r,onChange:e=>o(t,"tagKey",e),value:u}):(0,ue.BX)("span",{children:[V(l),(0,ue.tZ)(ne.Z,{})]})}),(0,ue.tZ)(De,{children:!E&&(m?(0,ue.tZ)(we,{category:l,tagKey:L(e),orgSlug:n,projectId:s,value:d,onChange:e=>o(t,"match",e)}):(0,ue.tZ)(Ue,{name:"match",value:d,onChange:e=>o(t,"match",e),placeholder:k(l),inline:!1,rows:1,autosize:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0}))}),(0,ue.tZ)(Le,{children:(0,ue.tZ)(Y.ZP,{onClick:()=>a(t),icon:(0,ue.tZ)(re.F,{}),"aria-label":(0,i.t)("Delete Condition")})}),p&&(0,ue.tZ)(Ne,{selectedLegacyBrowsers:c,onChange:e=>{o(t,"legacyBrowsers",e)}})]},t)}))})}Ve.displayName="Conditions";const Oe=Ve,Me=(0,F.Z)("div",{target:"ep8w7uu5"})("display:grid;grid-template-columns:1fr minmax(0, 1fr);align-items:flex-start;padding:",(0,ee.Z)(1)," ",(0,ee.Z)(2),";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.gray100),";}@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:0.6fr minmax(0, 1fr) max-content;}"),ke=(0,F.Z)("div",{target:"ep8w7uu4"})({name:"38ghps",styles:"min-height:40px;display:inline-flex;align-items:center"}),je=(0,F.Z)(ke,{target:"ep8w7uu3"})("padding-right:",(0,ee.Z)(2),";line-height:16px;"),De=(0,F.Z)(ke,{target:"ep8w7uu2"})("padding-top:",(0,ee.Z)(1),";grid-column:1/-1;grid-row:2/2;",(e=>!e.children&&"display: none"),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-column:auto;grid-row:auto;padding-top:0;}"),Le=(0,F.Z)(ke,{target:"ep8w7uu1"})("justify-content:flex-end;padding-left:",(0,ee.Z)(1),";"),Ue=(0,F.Z)(se.Z,{target:"ep8w7uu0"})({name:"1fz47qv",styles:"padding-bottom:0;width:100%"});function Pe(e){let{Header:t,Body:n,Footer:s,closeModal:r,title:a,emptyMessage:l,conditionCategories:d,api:u,organization:p,project:m,onSubmitSuccess:h,onSubmit:g,onChange:_,extraFields:R,rule:T}=e;const[N,y]=(0,c.useState)(function(){if(T){const{condition:e,sampleRate:t}=T,{inner:n}=e;return{conditions:n.map((e=>{const{name:t,value:n}=e;var s;return Array.isArray(n)?n.every((e=>!!I[e]))?{category:t,legacyBrowsers:n}:{category:t,match:n.join("\n"),...P(e)&&{tagKey:null!==(s=e.tagKey)&&void 0!==s?s:""}}:{category:t}})),sampleRate:100*t,errors:{}}}return{conditions:[],sampleRate:null,errors:{}}}());(0,c.useEffect)((()=>{y((e=>e.errors.sampleRate?{...e,errors:{...e.errors,sampleRate:void 0}}:e))}),[N.sampleRate]),(0,c.useEffect)((()=>{null==_||_(N)}),[N,_]);const{errors:A,conditions:f,sampleRate:b}=N;async function Z(e,t){try{const t=await u.requestPromise(`/projects/${p.slug}/${m.slug}/`,{method:"PUT",data:{dynamicSampling:{rules:e}}});h(t,T?(0,i.t)("Successfully edited dynamic sampling rule"):(0,i.t)("Successfully added dynamic sampling rule")),r()}catch(e){!function(e){"string"!=typeof e?"sampleRate"===e.type?y({...N,errors:{...A,sampleRate:e.message}}):(0,E.Iw)(e.message):(0,E.Iw)(e)}(function(e,t){var n,s,r;const a=null===(n=e.responseJSON)||void 0===n?void 0:n.detail;if(a)return a[0];const o=e.responseJSON;if(!o)return D;const l=null!==(s=null===(r=o.dynamicSampling)||void 0===r?void 0:r.rules[t])&&void 0!==s?s:{},[d,c]=Object.entries(l)[0];return"sampleRate"===d?{type:"sampleRate",message:(0,i.t)("Ensure this value is a floating number between 0 and 100")}:D}(e,t))}}const v=!(0,z.ri)(b)||!(null==f||!f.find((e=>{var t;return e.category===S.EVENT_LEGACY_BROWSER?!(null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]).length:e.category!==S.EVENT_LOCALHOST&&e.category!==S.EVENT_BROWSER_EXTENSIONS&&e.category!==S.EVENT_WEB_CRAWLERS&&!e.match})));return(0,ue.BX)(c.Fragment,{children:[(0,ue.tZ)(t,{closeButton:!0,children:(0,ue.tZ)("h4",{children:a})}),(0,ue.tZ)(n,{children:(0,ue.BX)(Ge,{children:[R,(0,ue.BX)(Xe,{children:[(0,ue.BX)(Fe,{hasButtons:!0,children:[(0,i.t)("Conditions"),(0,ue.tZ)(ze,{placement:"bottom right",triggerLabel:(0,i.t)("Add Condition"),placeholder:(0,i.t)("Filter conditions"),isOptionDisabled:e=>e.disabled,options:d.map((e=>{let[t,n]=e;const s=t!==S.EVENT_CUSTOM_TAG&&f.some((e=>e.category===t));return{value:t,label:n,disabled:s,tooltip:s?(0,i.t)("This condition has already been added"):void 0}})),value:f.filter((e=>{let{category:t}=e;return t!==S.EVENT_CUSTOM_TAG})).map((e=>{let{category:t}=e;return t})),onChange:function(e){const t=f.map((e=>{let{category:t}=e;return t})),n=e.filter((e=>{let{value:n}=e;return n===S.EVENT_CUSTOM_TAG||!t.includes(n)})).map((e=>{let{value:t}=e;return t}));y({...N,conditions:[...f,...n.map((e=>({category:e,match:""})))]})},isSearchable:!0,multiple:!0,filterOption:(e,t)=>e.value===S.EVENT_CUSTOM_TAG||(0,X.c)(null)(e,t),components:{Option:e=>e.value===S.EVENT_CUSTOM_TAG?(0,ue.tZ)(W.y.Option,{className:"select-option",...e,children:(0,ue.BX)(We,{isFocused:e.isFocused,children:[(0,ue.tZ)(Q.N_,{isCircled:!0})," ",(0,i.t)("Add Custom Tag")]})}):(0,ue.tZ)(K.Z,{...e})}})]}),(0,ue.tZ)(o.N,{children:f.length?(0,ue.tZ)(Oe,{conditions:f,onDelete:function(e){const t=[...f];t.splice(e,1),y({...N,conditions:t})},onChange:function(e,t,n){const s=[...f];s[e][t]=n,"tagKey"===t&&(s[e].match=""),y({...N,conditions:s})},orgSlug:p.slug,projectId:m.id,projectSlug:m.slug}):(0,ue.tZ)(te.Z,{icon:(0,ue.tZ)(J.D,{isCircled:!0,size:"xl"}),children:l})})]}),(0,ue.tZ)(H.Z,{label:`${(0,i.t)("Sampling Rate")} %`,name:"sampleRate",onChange:e=>{y({...N,sampleRate:e?Number(e):null})},placeholder:"%",value:b,inline:!1,hideControlState:!A.sampleRate,error:A.sampleRate,showHelpInTooltip:!0,stacked:!0,required:!0})]})}),(0,ue.tZ)(s,{children:(0,ue.BX)($.ZP,{gap:1,children:[(0,ue.tZ)(Y.ZP,{onClick:r,children:(0,i.t)("Cancel")}),(0,ue.tZ)(Y.ZP,{priority:"primary",onClick:()=>g({conditions:f,sampleRate:b,submitRules:Z}),title:v?(0,i.t)("Required fields must be filled out"):void 0,disabled:v,children:(0,i.t)("Save Rule")})]})})]})}Pe.displayName="RuleModal";const Be=Pe,Ge=(0,F.Z)("div",{target:"e1mf53z04"})("display:grid;gap:",(0,ee.Z)(2),";"),ze=(0,F.Z)(q.Z,{target:"e1mf53z03"})({name:"1ffbk74",styles:"font-weight:400;text-transform:none"}),Fe=(0,F.Z)(o.V9,{target:"e1mf53z02"})("padding-right:",(0,ee.Z)(2),";"),Xe=(0,F.Z)(o.s_,{target:"e1mf53z01"})({name:"1ykowef",styles:"margin-bottom:0"}),We=(0,F.Z)("div",{target:"e1mf53z00"})("display:flex;align-items:center;padding:",(0,ee.Z)(1)," ",(0,ee.Z)(1)," ",(0,ee.Z)(1)," ",(0,ee.Z)(1.5),";gap:",(0,ee.Z)(1),";line-height:1.4;border-radius:",(e=>e.theme.borderRadius),";",(e=>e.isFocused&&`background: ${e.theme.hover};`),";");function Ye(e){let{rule:t,errorRules:n,transactionRules:s,...r}=e;return(0,ue.tZ)(Be,{...r,title:t?(0,i.t)("Edit Error Sampling Rule"):(0,i.t)("Add Error Sampling Rule"),emptyMessage:(0,i.t)("Apply sampling rate to all errors"),conditionCategories:U([S.EVENT_RELEASE,S.EVENT_ENVIRONMENT,S.EVENT_USER_ID,S.EVENT_USER_SEGMENT,S.EVENT_BROWSER_EXTENSIONS,S.EVENT_LOCALHOST,S.EVENT_LEGACY_BROWSER,S.EVENT_WEB_CRAWLERS,S.EVENT_IP_ADDRESSES,S.EVENT_CSP,S.EVENT_ERROR_MESSAGES,S.EVENT_TRANSACTION,S.EVENT_OS_NAME,S.EVENT_OS_VERSION,S.EVENT_DEVICE_FAMILY,S.EVENT_DEVICE_NAME,S.EVENT_CUSTOM_TAG]),rule:t,onSubmit:function(e){let{sampleRate:r,conditions:a,submitRules:o}=e;if(!(0,z.ri)(r))return;const i={id:0,type:_.ERROR,condition:{op:R.AND,inner:a.length?a.map(j):[]},sampleRate:r/100},l=t?[...n.map((e=>G()(e,t)?i:e)),...s]:[...n,i,...s],d=l.findIndex((e=>e===i));o(l,d)}})}Ye.displayName="ErrorRuleModal";const $e=Ye;var qe=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),He=n("./app/components/checkboxFancy/checkboxFancy.tsx"),Ke=n("./app/components/forms/field/index.tsx"),Qe=n("./app/components/tooltip.tsx");function Je(e){let{rule:t,errorRules:n,transactionRules:s,...r}=e;const a=(0,qe.u)(),[o,l]=(0,c.useState)(!t||t.type===_.TRACE),[d,u]=(0,c.useState)(!(null==t||!t.condition.inner.length));return(0,ue.tZ)(Be,{...r,title:t?(0,i.t)("Edit Transaction Sampling Rule"):(0,i.t)("Add Transaction Sampling Rule"),emptyMessage:(0,i.t)("Apply sampling rate to all transactions"),conditionCategories:U(o?[S.TRACE_RELEASE,S.TRACE_ENVIRONMENT,S.TRACE_USER_ID,S.TRACE_USER_SEGMENT,S.TRACE_TRANSACTION]:[S.EVENT_RELEASE,S.EVENT_ENVIRONMENT,S.EVENT_USER_ID,S.EVENT_USER_SEGMENT,S.EVENT_BROWSER_EXTENSIONS,S.EVENT_LOCALHOST,S.EVENT_LEGACY_BROWSER,S.EVENT_WEB_CRAWLERS,S.EVENT_IP_ADDRESSES,S.EVENT_CSP,S.EVENT_ERROR_MESSAGES,S.EVENT_TRANSACTION,S.EVENT_OS_NAME,S.EVENT_OS_VERSION,S.EVENT_DEVICE_FAMILY,S.EVENT_DEVICE_NAME,S.EVENT_CUSTOM_TAG]),rule:t,onSubmit:function(e){let{sampleRate:r,conditions:a,submitRules:i}=e;if(!(0,z.ri)(r))return;const l={id:0,type:o?_.TRACE:_.TRANSACTION,condition:{op:R.AND,inner:a.length?a.map(j):[]},sampleRate:r/100},d=t?s.map((e=>G()(e,t)?l:e)):[...s,l],[c,u]=p()(d,(e=>e.type===_.TRACE)),E=[...n,...c,...u],m=E.findIndex((e=>e===l));i(E,m)},onChange:function(e){let{conditions:t}=e;u(!!t.length)},extraFields:(0,ue.tZ)(Ke.Z,{label:(0,i.t)("Tracing"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0,children:(0,ue.tZ)(Qe.ZP,{title:(0,i.t)("This field can only be edited if there are no match conditions"),disabled:!d,popperStyle:(0,v.iv)("@media (min-width: ",a.breakpoints[0],"){max-width:370px;}",""),children:(0,ue.BX)(tt,{onClick:d?void 0:()=>l(!o),children:[(0,ue.tZ)(nt,{isChecked:o,isDisabled:d}),(0,i._N)("Include all related transactions by trace ID. This can span across multiple projects. All related errors will remain. [link:Learn more about tracing].",{link:(0,ue.tZ)(g.Z,{href:w,onClick:e=>e.stopPropagation()})})]})})})})}Je.displayName="TransactionRuleModal";const et=Je,tt=(0,F.Z)("div",{target:"ejbmws91"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,ee.Z)(1),";cursor:",(e=>e.onClick?"pointer":"not-allowed"),";"),nt=(0,F.Z)(He.Z,{target:"ejbmws90"})("margin-top:",(0,ee.Z)(.5),";");function st(e){let{type:t,...n}=e;return"error"===t?(0,ue.tZ)($e,{...n}):(0,ue.tZ)(et,{...n})}st.displayName="Modal";const rt=st;var at=n("./app/styles/overflowEllipsis.tsx"),ot=n("../node_modules/react-dom/profiling.js"),it=n("../node_modules/@dnd-kit/core/dist/core.esm.js"),lt=n("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");function dt(e){let{value:t,dragging:n,index:s,transform:r,listeners:a,sorting:o,transition:i,forwardRef:l,attributes:d,renderItem:c,wrapperStyle:u}=e;return(0,ue.tZ)(Et,{ref:l,style:{...u,transition:i,"--translate-x":r?`${Math.round(r.x)}px`:void 0,"--translate-y":r?`${Math.round(r.y)}px`:void 0,"--scale-x":null!=r&&r.scaleX?`${r.scaleX}`:void 0,"--scale-y":null!=r&&r.scaleY?`${r.scaleY}`:void 0},children:(0,ue.tZ)(mt,{children:c({dragging:Boolean(n),sorting:Boolean(o),listeners:a,transform:r,transition:i,value:t,index:s,attributes:d})})})}dt.displayName="Item";const ct=dt,ut="0 0 0 calc(1px / var(--scale-x, 1)) rgba(63, 63, 68, 0.05)",pt=`${ut}, 0 1px calc(3px / var(--scale-x, 1)) 0 rgba(34, 33, 81, 0.15)`,Et=(0,F.Z)("div",{target:"e1puudz31"})("transform:translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1));transform-origin:0 0;touch-action:manipulation;--box-shadow:",pt,";--box-shadow-picked-up:",ut,",-1px 0 15px 0 rgba(34, 33, 81, 0.01),0px 15px 15px 0 rgba(34, 33, 81, 0.25);"),mt=(0,F.Z)("div",{target:"e1puudz30"})("background-color:",(e=>e.theme.background),";animation:pop 200ms cubic-bezier(0.18, 0.67, 0.6, 1.22);box-shadow:var(--box-shadow-picked-up);opacity:1;:focus{box-shadow:0 0px 4px 1px rgba(76, 159, 254, 1),",pt,";}@keyframes pop{0%{transform:scale(1);box-shadow:var(--box-shadow);}100%{box-shadow:var(--box-shadow-picked-up);}}");function ht(e){let{id:t,index:n,renderItem:s,disabled:r,wrapperStyle:a}=e;const{attributes:o,isSorting:i,isDragging:l,listeners:d,setNodeRef:c,transform:u,transition:p}=(0,lt.nB)({id:t,disabled:r});return(0,ue.tZ)(ct,{forwardRef:c,value:t,sorting:i,renderItem:s,index:n,transform:u,transition:p,listeners:d,attributes:o,wrapperStyle:a({index:n,isDragging:l,isSorting:i})})}ht.displayName="SortableItem";const gt=ht;class _t extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",{}),(0,d.Z)(this,"handleChangeActive",(e=>{this.setState({activeId:e})}))}render(){const{activeId:e}=this.state,{items:t,onUpdateItems:n,renderItem:s,disabled:r,wrapperStyle:a}=this.props,o=t.indexOf.bind(t),i=e?o(e):-1;return(0,ue.BX)(it.LB,{onDragStart:e=>{let{active:t}=e;t&&this.handleChangeActive(t.id)},onDragEnd:e=>{let{over:s}=e;if(this.handleChangeActive(void 0),s){const e=o(s.id);i!==e&&n({activeIndex:i,overIndex:e,reorderedItems:(0,lt.Rp)(t,i,e)})}},onDragCancel:()=>this.handleChangeActive(void 0),children:[(0,ue.tZ)(lt.Fo,{items:t,strategy:lt.qw,children:t.map(((e,t)=>(0,ue.tZ)(gt,{id:e,index:t,renderItem:s,disabled:r,wrapperStyle:a},e)))}),(0,ot.createPortal)((0,ue.tZ)(it.y9,{children:e?(0,ue.tZ)(ct,{value:t[i],renderItem:s,wrapperStyle:a({index:i,isDragging:!0,isSorting:!1})}):null}),document.body)]})}}_t.displayName="DraggableList",(0,d.Z)(_t,"defaultProps",{disabled:!1,wrapperStyle:()=>({})});const Rt=_t;var Tt=n("./app/icons/iconGrabbable.tsx");const St=e=>`\n> * {\n  :nth-child(-n + 5):nth-child(5n - 1) {\n    text-align: center;\n  }\n  @media (max-width: ${e.breakpoints[0]}) {\n    :nth-child(5n - 4),\n    :nth-child(5n - 3) {\n      display: none;\n    }\n  }\n}\ngrid-template-columns: 2fr 1.5fr 1fr;\n@media (min-width: ${e.breakpoints[0]}) {\n  grid-template-columns: 0.5fr 1.5fr 2fr 1.5fr 1fr;\n}\n@media (min-width: ${e.breakpoints[2]}) {\n  grid-template-columns: 0.5fr 2fr 2.5fr 2fr 1.5fr;\n}\n@media (min-width: ${e.breakpoints[3]}) {\n  grid-template-columns: 0.5fr 2fr 3fr 2fr 1fr;\n}\n`;var Nt=n("./app/components/actions/menuItemActionLink.tsx"),yt=n("./app/components/confirm.tsx"),At=n("./app/components/dropdownLink.tsx");const ft=(0,i.t)("Are you sure you wish to delete this dynamic sampling rule?"),bt=(0,i.t)("You do not have permission to delete dynamic sampling rules."),Zt=(0,i.t)("You do not have permission to edit dynamic sampling rules.");function vt(e){let{disabled:t,onEditRule:n,onDeleteRule:s,onOpenMenuActions:r,isMenuActionsOpen:a}=e;return(0,ue.BX)(c.Fragment,{children:[(0,ue.BX)(xt,{gap:1,children:[(0,ue.tZ)(Y.ZP,{"aria-label":(0,i.t)("Edit Rule"),size:"small",onClick:n,icon:(0,ue.tZ)(Q.yl,{}),disabled:t,title:t?Zt:void 0}),(0,ue.tZ)(yt.Z,{priority:"danger",message:ft,onConfirm:s,disabled:t,children:(0,ue.tZ)(Y.ZP,{"aria-label":(0,i.t)("Delete Rule"),size:"small",icon:(0,ue.tZ)(Q.Fz,{}),title:t?bt:void 0})})]}),(0,ue.BX)(wt,{caret:!1,customTitle:(0,ue.tZ)(Y.ZP,{"aria-label":(0,i.t)("Actions"),icon:(0,ue.tZ)(Q.YR,{size:"sm"}),size:"xsmall",onClick:r}),isOpen:a,anchorRight:!0,children:[(0,ue.tZ)(Nt.Z,{shouldConfirm:!1,icon:(0,ue.tZ)(Q.Dj,{size:"xs"}),title:(0,i.t)("Edit"),onClick:t?e=>{null==e||e.stopPropagation()}:n,disabled:t,children:(0,ue.tZ)(Qe.ZP,{disabled:!t,title:Zt,containerDisplayMode:"block",children:(0,i.t)("Edit")})}),(0,ue.tZ)(Nt.Z,{onAction:s,message:ft,icon:(0,ue.tZ)(Q.Dj,{size:"xs"}),title:(0,i.t)("Delete"),disabled:t,priority:"danger",shouldConfirm:!0,children:(0,ue.tZ)(Qe.ZP,{disabled:!t,title:bt,containerDisplayMode:"block",children:(0,i.t)("Delete")})})]})]})}vt.displayName="Actions";const Ct=vt,xt=(0,F.Z)($.ZP,{target:"e1a3egcn1"})("justify-content:flex-end;flex:1;display:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:grid;}"),wt=(0,F.Z)(At.Z,{target:"e1a3egcn0"})("display:flex;align-items:center;transition:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:none;}"),It=function(e){let{condition:t}=e;if(t.op===R.AND){const{inner:e}=t;return e.length?(0,ue.tZ)(Vt,{children:e.map(((e,t)=>{return(0,ue.BX)("div",{children:[(0,ue.tZ)(Ot,{children:P(e)?(a=e.tagKey,`${a} - ${(0,i.t)("Custom")}`):V(e.name)}),(n=e.value,Array.isArray(n)?(0,ue.tZ)(c.Fragment,{children:[...n].map(((e,t)=>{var s,r;return(0,ue.BX)(c.Fragment,{children:[(0,ue.tZ)(Mt,{children:null!==(s=null===(r=I[e])||void 0===r?void 0:r.title)&&void 0!==s?s:e}),t!==n.length-1&&(0,ue.tZ)(kt,{children:","})]},e)}))}):(0,ue.tZ)(Mt,{children:null!==(s=null===(r=I[String(n)])||void 0===r?void 0:r.title)&&void 0!==s?s:String(n)}))]},t);var n,s,r,a}))}):(0,ue.tZ)(Ot,{children:(0,i.t)("All")})}return C.Tb(new Error("Unknown dynamic sampling condition operator")),null},Vt=(0,F.Z)("div",{target:"e5dv9sd3"})("display:grid;gap:",(0,ee.Z)(1.5),";"),Ot=(0,F.Z)("span",{target:"e5dv9sd2"})("margin-right:",(0,ee.Z)(1),";"),Mt=(0,F.Z)("span",{target:"e5dv9sd1"})("word-break:break-all;white-space:pre-wrap;color:",(e=>e.theme.gray300),";"),kt=(0,F.Z)(Mt,{target:"e5dv9sd0"})("padding-right:",(0,ee.Z)(.5),";");function jt(e){let{sampleRate:t}=e;return(0,ue.tZ)(Lt,{children:100*t+"%"})}jt.displayName="SampleRate";const Dt=jt,Lt=(0,F.Z)("div",{target:"e17oa8sb0"})({name:"1h3cbh4",styles:"white-space:pre-wrap;word-break:break-all"}),Ut=function(e){let{type:t}=e;switch(t){case _.ERROR:return(0,ue.tZ)(Pt,{children:(0,i.t)("Errors only")});case _.TRANSACTION:return(0,ue.tZ)(Bt,{children:(0,i.t)("Individual transactions")});case _.TRACE:return(0,ue.tZ)(Bt,{children:(0,i.t)("Transaction traces")});default:return C.Tb(new Error("Unknown dynamic sampling rule type")),null}},Pt=(0,F.Z)("div",{target:"enki2wy1"})("color:",(e=>e.theme.pink300),";white-space:pre-wrap;"),Bt=(0,F.Z)(Pt,{target:"enki2wy0"})("color:",(e=>e.theme.linkColor),";");class Gt extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",{isMenuActionsOpen:!1}),(0,d.Z)(this,"handleChangeMenuAction",(()=>{this.setState((e=>({isMenuActionsOpen:!e.isMenuActionsOpen})))}))}componentDidMount(){this.checkMenuActionsVisibility()}componentDidUpdate(){this.checkMenuActionsVisibility()}checkMenuActionsVisibility(){const{dragging:e,sorting:t}=this.props,{isMenuActionsOpen:n}=this.state;(e||t)&&n&&this.setState({isMenuActionsOpen:!1})}render(){const{rule:e,onEditRule:t,onDeleteRule:n,disabled:s,listeners:r,grabAttributes:a}=this.props,{type:o,condition:l,sampleRate:d}=e,{isMenuActionsOpen:c}=this.state;return(0,ue.BX)(Ft,{children:[(0,ue.tZ)(Wt,{children:(0,ue.tZ)(Qe.ZP,{title:s?(0,i.t)("You do not have permission to reorder dynamic sampling rules."):void 0,children:(0,ue.tZ)($t,{...r,disabled:s,...a,children:(0,ue.tZ)(Tt.L,{})})})}),(0,ue.tZ)(Xt,{children:(0,ue.tZ)(Ut,{type:o})}),(0,ue.tZ)(Xt,{children:(0,ue.tZ)(It,{condition:l})}),(0,ue.tZ)(Yt,{children:(0,ue.tZ)(Dt,{sampleRate:d})}),(0,ue.tZ)(Xt,{children:(0,ue.tZ)(Ct,{onEditRule:t,onDeleteRule:n,disabled:s,onOpenMenuActions:this.handleChangeMenuAction,isMenuActionsOpen:c})})]})}}Gt.displayName="Rule";const zt=Gt,Ft=(0,F.Z)("div",{target:"el3sh2r4"})("display:grid;align-items:center;",(e=>St(e.theme)),">*{overflow:visible;:nth-child(5n){justify-content:flex-end;}}"),Xt=(0,F.Z)("div",{target:"el3sh2r3"})("display:flex;align-items:center;padding:",(0,ee.Z)(2),";cursor:default;white-space:pre-wrap;word-break:break-all;"),Wt=(0,F.Z)(Xt,{target:"el3sh2r2"})({name:"m8x70k",styles:"cursor:inherit;[role='button']{cursor:grab;}"}),Yt=(0,F.Z)(Xt,{target:"el3sh2r1"})({name:"1gtpzmm",styles:"text-align:center;justify-content:center"}),$t=(0,F.Z)("div",{target:"el3sh2r0"})((e=>e.disabled&&`\n    color: ${e.theme.disabled};\n    cursor: not-allowed;\n  `),";outline:none;");class qt extends c.PureComponent{constructor(){super(...arguments),(0,d.Z)(this,"state",{rules:[]}),(0,d.Z)(this,"handleUpdateRules",(e=>{let{activeIndex:t,overIndex:n,reorderedItems:s}=e;const{rules:r}=this.state,a=s.map((e=>r.find((t=>String(t.id)===e)))).filter((e=>!!e)),o=r[t].type,l=r[n].type;o!==_.TRACE||l!==_.TRANSACTION?o!==_.TRANSACTION||l!==_.TRACE?this.setState({rules:a}):(0,E.Iw)((0,i.t)("Individual transactions rules cannot be above transaction traces rules")):(0,E.Iw)((0,i.t)("Transaction traces rules cannot be under individual transactions rules"))}))}componentDidMount(){this.getRules()}componentDidUpdate(e){G()(e.rules,this.props.rules)?G()(this.props.rules,this.state.rules)||this.handleUpdateRulesParent():this.getRules()}getRules(){this.setState({rules:this.props.rules})}handleUpdateRulesParent(){const{onUpdateRules:e}=this.props,{rules:t}=this.state;e(t)}render(){const{onEditRule:e,onDeleteRule:t,disabled:n,emptyMessage:s}=this.props,{rules:r}=this.state;return(0,ue.tZ)(Kt,{headers:["",(0,i.t)("Type"),(0,i.t)("Conditions"),(0,i.t)("Rate"),""],isEmpty:!r.length,emptyMessage:s,children:(0,ue.tZ)(Rt,{disabled:n,items:r.map((e=>String(e.id))),onUpdateItems:this.handleUpdateRules,wrapperStyle:e=>{let{isDragging:t,isSorting:n,index:s}=e;return t?{cursor:"grabbing"}:n?{}:{transform:"none",transformOrigin:"0","--box-shadow":"none","--box-shadow-picked-up":"none",overflow:"visible",position:"relative",zIndex:r.length-s,cursor:"default"}},renderItem:s=>{let{value:a,listeners:o,attributes:i,dragging:l,sorting:d}=s;const c=r.find((e=>String(e.id)===a));return c?(0,ue.tZ)(zt,{rule:c,onEditRule:e(c),onDeleteRule:t(c),disabled:n,listeners:o,grabAttributes:i,dragging:l,sorting:d}):null}})})}}qt.displayName="Rules";const Ht=qt,Kt=(0,F.Z)(o.KB,{target:"e15ewxcp0"})("overflow:visible;margin-bottom:0;border:none;border-bottom-right-radius:0;border-bottom-left-radius:0;",(e=>St(e.theme)),">*{",at.Z,";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.border),";}:nth-child(n + 6){",(e=>e.isEmpty?"\n              display: block;\n              grid-column: 1/-1;\n            ":"\n              display: grid;\n              grid-column: 1/-1;\n              padding: 0;\n            "),";}}");function Qt(e){let{rules:t,onAddRule:n,onEditRule:s,onDeleteRule:r,onUpdateRules:a,isErrorPanel:l,disabled:d}=e;const c=l?(0,i.t)("error"):(0,i.t)("transaction");return(0,ue.BX)(o.s_,{children:[(0,ue.tZ)(Ht,{rules:t,onEditRule:s,onDeleteRule:r,disabled:d,onUpdateRules:a,emptyMessage:(0,i.t)("There are no %s rules to display",c)}),(0,ue.tZ)(en,{children:(0,ue.BX)(tn,{gap:1,children:[(0,ue.tZ)(Y.ZP,{href:w,external:!0,children:(0,i.t)("Read the docs")}),(0,ue.tZ)(nn,{priority:"primary",onClick:n,disabled:d,title:d?(0,i.t)("You do not have permission to add dynamic sampling rules."):void 0,children:(0,i.t)("Add %s rule",c)})]})})]})}Qt.displayName="RulesPanel";const Jt=Qt,en=(0,F.Z)(o.jH,{target:"e1lsth6w2"})("padding:",(0,ee.Z)(1)," ",(0,ee.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;align-items:center;justify-content:flex-end;}"),tn=(0,F.Z)($.ZP,{target:"e1lsth6w1"})("@media (max-width: ",(e=>e.theme.breakpoints[0]),"){grid-auto-flow:row;grid-row-gap:",(0,ee.Z)(1),";}"),nn=(0,F.Z)(Y.ZP,{target:"e1lsth6w0"})("@media (max-width: ",(e=>e.theme.breakpoints[0]),"){width:100%;}");class sn extends A.Z{constructor(){super(...arguments),(0,d.Z)(this,"successfullySubmitted",((e,t)=>{this.setState({projectDetails:e}),t&&(0,E.S9)(t)})),(0,d.Z)(this,"handleOpenRule",((e,t)=>()=>{const{organization:n,project:s}=this.props,{errorRules:r,transactionRules:a}=this.state;return(0,m.openModal)((o=>(0,ue.tZ)(rt,{...o,type:e,api:this.api,organization:n,project:s,rule:t,errorRules:r,transactionRules:a,onSubmitSuccess:this.successfullySubmitted})),{modalCss:O})})),(0,d.Z)(this,"handleAddRule",(e=>()=>{"errorRules"!==e?this.handleOpenRule("transaction")():this.handleOpenRule("error")()})),(0,d.Z)(this,"handleEditRule",(e=>()=>{e.type!==_.ERROR?this.handleOpenRule("transaction",e)():this.handleOpenRule("error",e)()})),(0,d.Z)(this,"handleDeleteRule",(e=>()=>{const{errorRules:t,transactionRules:n}=this.state,s=[...e.type===_.ERROR?t.filter((t=>t.id!==e.id)):t,...e.type!==_.ERROR?n.filter((t=>t.id!==e.id)):n];this.submitRules(s,(0,i.t)("Successfully deleted dynamic sampling rule"),(0,i.t)("An error occurred while deleting dynamic sampling rule"))})),(0,d.Z)(this,"handleUpdateRules",(e=>{var t;if(!e.length)return;const{errorRules:n,transactionRules:s}=this.state;(null===(t=e[0])||void 0===t?void 0:t.type)!==_.ERROR?this.submitRules([...n,...e]):this.submitRules([...e,...s])}))}getTitle(){return(0,i.t)("Filters & Sampling")}getDefaultState(){return{...super.getDefaultState(),errorRules:[],transactionRules:[],projectDetails:null}}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectDetails",`/projects/${e.slug}/${t.slug}/`]]}componentDidMount(){this.getRules()}componentDidUpdate(e,t){t.projectDetails===this.state.projectDetails||this.getRules()}getRules(){var e;const{projectDetails:t}=this.state;if(!t)return;const{dynamicSampling:n}=t,s=null!==(e=null==n?void 0:n.rules)&&void 0!==e?e:[],[r,a]=p()(s,(e=>e.type===_.ERROR));this.setState({errorRules:r,transactionRules:a})}async submitRules(e,t,n){const{organization:s,project:r}=this.props;try{const n=await this.api.requestPromise(`/projects/${s.slug}/${r.slug}/`,{method:"PUT",data:{dynamicSampling:{rules:e}}});this.successfullySubmitted(n,t)}catch(e){this.getRules(),n&&(0,E.Iw)(n)}}renderBody(){const{errorRules:e,transactionRules:t}=this.state,{hasAccess:n,organization:s}=this.props,r=!n,a=[...e,...t].some((e=>e.condition.op!==R.AND));return a?(0,ue.tZ)(h.Z,{type:"error",children:(0,i.t)("A condition operator has been found that is not yet supported.")}):(0,ue.BX)(c.Fragment,{children:[(0,ue.tZ)(f.Z,{title:this.getTitle()}),(0,ue.tZ)(Z.Z,{}),(0,ue.tZ)(b.Z,{children:(0,i._N)("Manage the inbound data you want to store. To change the sampling rate or rate limits, [link:update your SDK configuration]. The rules added below will apply on top of your SDK configuration. Any new rule may take a few minutes to propagate.",{link:(0,ue.tZ)(g.Z,{href:w})})}),s.features.includes("filters-and-sampling-error-rules")&&(0,ue.tZ)(Jt,{rules:e,disabled:r,onAddRule:this.handleAddRule("errorRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules,isErrorPanel:!0}),(0,ue.tZ)(b.Z,{children:(0,i.t)("Rules for traces should precede rules for individual transactions.")}),(0,ue.tZ)(Jt,{rules:t,disabled:r,onAddRule:this.handleAddRule("transactionRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules})]})}}const rn=(0,y.Z)(sn),an=e=>{let{organization:t,...n}=e;return(0,ue.tZ)(r.Z,{features:["filters-and-sampling"],organization:t,renderDisabled:()=>(0,ue.tZ)(a.Z,{alert:o.aU,features:t.features,featureName:(0,i.t)("Filters & Sampling")}),children:(0,ue.tZ)(s.Z,{organization:t,access:["project:write"],children:e=>{let{hasAccess:s}=e;return(0,ue.tZ)(rn,{...n,hasAccess:s,organization:t})}})})};an.displayName="Index";const on=(0,l.Z)(an)},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),r=n("../node_modules/lodash/_arrayIncludes.js"),a=n("../node_modules/lodash/_arrayIncludesWith.js"),o=n("../node_modules/lodash/_arrayMap.js"),i=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,d){var c=-1,u=r,p=!0,E=e.length,m=[],h=t.length;if(!E)return m;n&&(t=o(t,i(n))),d?(u=a,p=!1):t.length>=200&&(u=l,p=!1,t=new s(t));e:for(;++c<E;){var g=e[c],_=null==n?g:n(g);if(g=d||0!==g?g:0,p&&_==_){for(var R=h;R--;)if(t[R]===_)continue e;m.push(g)}else u(t,_,d)||m.push(g)}return m}},"../node_modules/lodash/_baseIntersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),r=n("../node_modules/lodash/_arrayIncludes.js"),a=n("../node_modules/lodash/_arrayIncludesWith.js"),o=n("../node_modules/lodash/_arrayMap.js"),i=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js"),d=Math.min;e.exports=function(e,t,n){for(var c=n?a:r,u=e[0].length,p=e.length,E=p,m=Array(p),h=1/0,g=[];E--;){var _=e[E];E&&t&&(_=o(_,i(t))),h=d(_.length,h),m[E]=!n&&(t||u>=120&&_.length>=120)?new s(E&&_):void 0}_=e[0];var R=-1,T=m[0];e:for(;++R<u&&g.length<h;){var S=_[R],N=t?t(S):S;if(S=n||0!==S?S:0,!(T?l(T,N):c(g,N,n))){for(E=p;--E;){var y=m[E];if(!(y?l(y,N):c(e[E],N,n)))continue e}T&&T.push(N),g.push(S)}}return g}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_baseDifference.js"),r=n("../node_modules/lodash/_baseFlatten.js"),a=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var o=e.length;if(o<2)return o?a(e[0]):[];for(var i=-1,l=Array(o);++i<o;)for(var d=e[i],c=-1;++c<o;)c!=i&&(l[i]=s(l[i]||d,e[c],t,n));return a(r(l,1),t,n)}},"../node_modules/lodash/_castArrayLikeObject.js":(e,t,n)=>{var s=n("../node_modules/lodash/isArrayLikeObject.js");e.exports=function(e){return s(e)?e:[]}},"../node_modules/lodash/intersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayMap.js"),r=n("../node_modules/lodash/_baseIntersection.js"),a=n("../node_modules/lodash/_baseRest.js"),o=n("../node_modules/lodash/_castArrayLikeObject.js"),i=a((function(e){var t=s(e,o);return t.length&&t[0]===e[0]?r(t):[]}));e.exports=i},"../node_modules/lodash/xor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayFilter.js"),r=n("../node_modules/lodash/_baseRest.js"),a=n("../node_modules/lodash/_baseXor.js"),o=n("../node_modules/lodash/isArrayLikeObject.js"),i=r((function(e){return a(s(e,o))}));e.exports=i}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_filtersAndSampling_index_tsx.192d707afac8f26ee8609466179ffa36.js.map