"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_traceDetails_utils_tsx"],{"./app/components/events/interfaces/spans/constants.tsx":(t,e,n)=>{n.d(e,{DX:()=>a,rz:()=>s,bl:()=>r,h0:()=>i,ZR:()=>o,S5:()=>p,tJ:()=>l});const a=120,s=4,r=a/s,i=20,o=a+i+20+1,p=18,l=10},"./app/components/events/interfaces/spans/utils.tsx":(t,e,n)=>{n.d(e,{kP:()=>S,IG:()=>g,n0:()=>w,TC:()=>y,hw:()=>E,ro:()=>I,Rr:()=>C,yk:()=>b,PA:()=>F,k9:()=>A,yn:()=>P,h_:()=>M,PC:()=>R,o0:()=>x,is:()=>q,vu:()=>j,rF:()=>$,ct:()=>L,PQ:()=>k,ll:()=>z,sT:()=>Z}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=n("../node_modules/react-router/es/index.js"),s=n("../node_modules/lodash/isNumber.js"),r=n.n(s),i=n("../node_modules/lodash/isString.js"),o=n.n(i),p=n("../node_modules/lodash/set.js"),l=n.n(p),m=n("../node_modules/moment/moment.js"),c=n.n(m),u=n("./app/types/event.tsx"),d=n("./app/types/utils.tsx"),f=n("./app/utils/performance/vitals/constants.tsx"),h=n("./app/utils/performanceForSentry.tsx"),T=n("./app/components/events/interfaces/spans/constants.tsx");const S=t=>{const e=(0,h.Zz)();if(!e||0===t)return;const n=[10,100,200,300,400,500,600,700,800,900,1001].find((e=>t<=e))||-1;e.setTag("ui.spanCount",t),e.setTag("ui.spanCount.grouped",`<=${n}`)},v=t=>{const{startTimestamp:e,endTimestamp:n}=t;return e>n?{startTimestamp:n,endTimestamp:e}:t};let _;!function(t){t[t.Stable=0]="Stable",t[t.Reversed=1]="Reversed",t[t.Equal=2]="Equal"}(_||(_={}));const g=t=>{const{viewStart:e,viewEnd:n}=t,{startTimestamp:a,endTimestamp:s}=v({startTimestamp:t.traceStartTimestamp,endTimestamp:t.traceEndTimestamp}),r=s-a,i=a+e*r,o=s-(1-n)*r-i;return t=>{if(r<=0)return{type:"TRACE_TIMESTAMPS_EQUAL",isSpanVisibleInView:!0};if(o<=0)return{type:"INVALID_VIEW_WINDOW",isSpanVisibleInView:!0};const{startTimestamp:e,endTimestamp:n}=v(t),a=(t=>{const e=t.startTimestamp,n=t.endTimestamp;return e<n?_.Stable:e===n?_.Equal:_.Reversed})(t),s=(e-i)/o,p=(n-i)/o,l=p>0&&s<1;switch(a){case _.Equal:return{type:"TIMESTAMPS_EQUAL",start:s,width:1,isSpanVisibleInView:p>=0&&s<=1};case _.Reversed:return{type:"TIMESTAMPS_REVERSED",start:s,end:p,isSpanVisibleInView:l};case _.Stable:return{type:"TIMESTAMPS_STABLE",start:s,end:p,isSpanVisibleInView:l};default:return a}}};function w(t){return{trace_id:t.traceID,span_id:t.rootSpanID,parent_span_id:t.parentSpanID,start_timestamp:t.traceStartTimestamp,timestamp:t.traceEndTimestamp,op:t.op,description:t.description,data:{},status:t.rootSpanStatus,hash:t.hash,exclusive_time:t.exclusiveTime}}function y(t){return{start:c().unix(t.start).subtract(12,"hours").utc().format("YYYY-MM-DDTHH:mm:ss.SSS"),end:c().unix(t.end).add(12,"hours").utc().format("YYYY-MM-DDTHH:mm:ss.SSS")}}function E(t){return"type"in t&&"gap"===t.type}function I(t){if("type"in t){if("orphan"===t.type)return!0;if("gap"===t.type)return t.isOrphan}return!1}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return E(t)?e:t.span_id}function b(t){if(!E(t))return t.op}function F(t){var e;return null==t||null===(e=t.contexts)||void 0===e?void 0:e.trace}function A(t){var e;const n=t.entries.find((t=>t.type===u.UZ.SPANS)),a=null!==(e=null==n?void 0:n.data)&&void 0!==e?e:[],s=F(t),i=s&&s.trace_id||"",p=s&&s.span_id||"",m=s&&s.op||"transaction",c=s&&s.description,f=s&&s.parent_span_id,h=s&&s.status,T=s&&s.hash,S=s&&s.exclusive_time;if(!n||a.length<=0)return{op:m,childSpans:{},traceStartTimestamp:t.startTimestamp,traceEndTimestamp:t.endTimestamp,traceID:i,rootSpanID:p,rootSpanStatus:h,parentSpanID:f,spans:[],description:c,hash:T,exclusiveTime:S};const v=new Set(a.map((t=>t.span_id)));v.add(p);const _={op:m,childSpans:{},traceStartTimestamp:t.startTimestamp,traceEndTimestamp:t.endTimestamp,traceID:i,rootSpanID:p,rootSpanStatus:h,parentSpanID:f,spans:a,description:c,hash:T,exclusiveTime:S},g=a.reduce(((t,e)=>{var n;let a=e;const s=function(t){return E(t)?"gap-span":t.parent_span_id}(a),i=s&&v.has(s);var m;m=s,o()(m)&&m.length>0&&i||(a.parent_span_id=p,a={type:"orphan",...a}),(0,d.hu)(a.parent_span_id);const c=null!==(n=t.childSpans[a.parent_span_id])&&void 0!==n?n:[];c.push(a),l()(t.childSpans,a.parent_span_id,c),(!t.traceStartTimestamp||a.start_timestamp<t.traceStartTimestamp)&&(t.traceStartTimestamp=a.start_timestamp);const u=r()(a.timestamp);return t.traceEndTimestamp?u&&a.timestamp>t.traceEndTimestamp?(t.traceEndTimestamp=a.timestamp,t):(a.start_timestamp>t.traceEndTimestamp&&(t.traceEndTimestamp=a.start_timestamp),t):u?(t.traceEndTimestamp=a.timestamp,t):(t.traceEndTimestamp=a.start_timestamp,t)}),_);return Object.values(g.childSpans).forEach((t=>{t.sort(V)})),g}function V(t,e){return I(t)&&!I(e)?1:!I(t)&&I(e)||t.start_timestamp<e.start_timestamp?-1:t.start_timestamp===e.start_timestamp?0:1}function P(t){return"number"!=typeof t&&"orphan"===(null==t?void 0:t.type)}function M(t){return P(t)?t.depth:t}function R(t){var e;const n=null===(e=t.sdk)||void 0===e?void 0:e.name;return!!n&&["sentry.javascript.browser","sentry.javascript.react","sentry.javascript.gatsby","sentry.javascript.ember","sentry.javascript.vue","sentry.javascript.angular","sentry.javascript.nextjs","sentry.javascript.electron"].includes(n.toLowerCase())}const x=["mark","paint"];function D(t){const e=Object.keys(t);return Object.values(f.r9).filter((t=>e.includes(t.slug))).some((e=>{const{value:n}=t[e.slug];return"number"==typeof n&&"number"==typeof e.poorThreshold&&n>=e.poorThreshold}))}function q(t,e){if(!t.measurements)return new Map;const n=Object.keys(t.measurements).filter((t=>t.startsWith("mark."))).map((e=>{const n=e.slice("mark.".length),a=t.measurements[n];return{name:e,timestamp:t.measurements[e].value,value:a?a.value:void 0}})),a=new Map;return n.forEach((t=>{const n=t.name.slice("mark.".length),s=t.value,r=e({startTimestamp:t.timestamp,endTimestamp:t.timestamp});if("TIMESTAMPS_EQUAL"!==r.type)return;const i=Math.round(100*r.start);for(const[e]of a)if(Math.abs(e-i)<=T.tJ){const r=a.get(e);return r.marks={...r.marks,[n]:{value:s,timestamp:t.timestamp}},r.failedThreshold||(r.failedThreshold=D(r.marks)),void a.set(e,r)}const o={[n]:{value:s,timestamp:t.timestamp}};a.set(i,{marks:o,failedThreshold:D(o)})})),a}function j(t,e){const n=e({startTimestamp:t,endTimestamp:t});switch(n.type){case"TRACE_TIMESTAMPS_EQUAL":case"INVALID_VIEW_WINDOW":return{warning:void 0,left:void 0,width:void 0,isSpanVisibleInView:n.isSpanVisibleInView};case"TIMESTAMPS_EQUAL":return{warning:void 0,left:n.start,width:1e-5,isSpanVisibleInView:n.isSpanVisibleInView};case"TIMESTAMPS_REVERSED":case"TIMESTAMPS_STABLE":return{warning:void 0,left:n.start,width:n.end-n.start,isSpanVisibleInView:n.isSpanVisibleInView};default:return n}}function $(t,e,n){return s=>{s.preventDefault();const r=L(t);e(r),a.browserHistory.push({...n,hash:r})}}function L(t){return`#span-${t}`}function k(t,e){return void 0!==e?`${t.op}.${t.description}.${e}`:`${t.op}.${t.description}`}function z(t){return t.reduce(((t,e)=>{const{start_timestamp:n,timestamp:a}=e.span;let s=t.startTimestamp,r=t.endTimestamp;return n<s&&(s=n),r<a&&(r=a),{startTimestamp:s,endTimestamp:r}}),{startTimestamp:t[0].span.start_timestamp,endTimestamp:t[0].span.timestamp})}function Z(t,e){const{startTimestamp:n,endTimestamp:a}=z(t),s=e({startTimestamp:n,endTimestamp:a});switch(s.type){case"TRACE_TIMESTAMPS_EQUAL":case"INVALID_VIEW_WINDOW":return{warning:void 0,left:void 0,width:void 0,isSpanVisibleInView:s.isSpanVisibleInView};case"TIMESTAMPS_EQUAL":return{warning:void 0,left:s.start,width:1e-5,isSpanVisibleInView:s.isSpanVisibleInView};case"TIMESTAMPS_REVERSED":case"TIMESTAMPS_STABLE":return{warning:void 0,left:s.start,width:s.end-s.start,isSpanVisibleInView:s.isSpanVisibleInView};default:return s}}},"./app/utils/performance/quickTrace/utils.tsx":(t,e,n)=>{n.d(e,{hp:()=>c,q2:()=>u,eW:()=>d,R8:()=>h,eF:()=>S,_Z:()=>v,$J:()=>_,S2:()=>g,xB:()=>w,y3:()=>y,Ci:()=>E}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=n("../node_modules/lodash/omit.js"),s=n.n(a),r=n("../node_modules/moment-timezone/index.js"),i=n.n(r),o=n("./app/components/events/interfaces/spans/utils.tsx"),p=n("./app/constants/pageFilters.tsx"),l=n("./app/utils/analytics.tsx"),m=n("./app/utils/discover/eventView.tsx");function c(t){return"transaction"===t.type}function u(t,e){return c(e)?t.event_id===e.id:void 0!==t.errors&&t.errors.some((t=>t.event_id===e.id))}function d(t,e){const n=[],a=[],s=[{event:e,path:[]}];for(;s.length;){const e=s.shift();if(u(e.event,t)){for(const t of e.path)n.push(t);a.push(e.event)}else{const t=[...e.path,f(e.event)];for(const n of e.event.children)s.push({event:n,path:t})}}if(!a.length)throw new Error("No relevant path exists!");for(;a.length;){const t=a.shift();for(const e of t.children)a.push(e);n.push(f(t))}return n}function f(t){return s()(t,["children"])}function h(t,e,n){var a,s,r;const{type:i,trace:o}=t;if("empty"===i||null===o)throw new Error("Current event not in trace navigator!");const p="full"===i,m=null!==(a=o.find((t=>u(t,e))))&&void 0!==a?a:null;if(null===m)throw new Error("Current event not in trace navigator!");const c=m.parent_event_id&&null!==(s=o.find((t=>t.event_id===m.parent_event_id)))&&void 0!==s?s:null,d=null!==(r=o.find((t=>t.event_id!==m.event_id&&t.event_id!==(null==c?void 0:c.event_id)&&0===t.generation)))&&void 0!==r?r:null,f=p?[]:null,h=[],S=p?[]:null,v=new Set;return o.forEach((t=>{v.add(t.project_id),(t=>t.parent_event_id===m.event_id)(t)?h.push(t):p&&((t=>null!==m.generation&&null!==t.generation&&t.generation>0&&m.generation-1>t.generation)(t)?null==f||f.push(t):(t=>null!==m.generation&&null!==t.generation&&m.generation+1<t.generation)(t)&&(null==S||S.push(t)))})),p&&v.size>1&&function(t,e){(0,l.ec)({eventKey:"quick_trace.connected_services",eventName:"Quick Trace: Connected Services",organization_id:parseInt(t.id,10),projects:e})}(n,v.size),{root:d,ancestors:null===f?null:T(f),parent:c,current:m,children:T(h),descendants:null===S?null:T(S)}}function T(t){return t.sort(((t,e)=>e["transaction.duration"]-t["transaction.duration"]))}function S(t){let{eventView:e,location:n}=t;return s()(e.getEventsAPIPayload(n),["field","sort","per_page"])}function v(t){let{start:e,end:n,statsPeriod:a}=t;return m.ZP.fromSavedQuery({id:void 0,version:2,name:"",fields:["transaction.duration"],projects:[p.mP],query:"",environment:[],start:e,end:n,range:null!=a?a:void 0})}function _(t){const e=c(t)?t.startTimestamp:i()(t.dateReceived?t.dateReceived:t.dateCreated).valueOf()/1e3,n=c(t)?t.endTimestamp:e;return(0,o.TC)({start:e,end:n})}function g(t,e,n){let a=n;const s=[t];for(;s.length;){const t=s.pop();for(const e of t.children)s.push(e);a=e(a,t)}return a}function w(t,e){return g(t,((t,n)=>(e(n)&&t.push(n),t)),[])}function y(t){return Boolean(t.event_id)}function E(t){return Boolean(t.event_id)}},"./app/utils/performance/vitals/constants.tsx":(t,e,n)=>{n.d(e,{r9:()=>r,TT:()=>i,AR:()=>o});var a=n("./app/locale.tsx"),s=n("./app/utils/discover/fields.tsx");const r={[s.Zl.FP]:{slug:"fp",name:(0,a.t)("First Paint"),acronym:"FP",description:(0,a.t)("Render time of the first pixel loaded in the viewport (may overlap with FCP)."),poorThreshold:3e3,type:(0,s.Cq)(s.Zl.FP)},[s.Zl.FCP]:{slug:"fcp",name:(0,a.t)("First Contentful Paint"),acronym:"FCP",description:(0,a.t)("Render time of the first image, text or other DOM node in the viewport."),poorThreshold:3e3,type:(0,s.Cq)(s.Zl.FCP)},[s.Zl.LCP]:{slug:"lcp",name:(0,a.t)("Largest Contentful Paint"),acronym:"LCP",description:(0,a.t)("Render time of the largest image, text or other DOM node in the viewport."),poorThreshold:4e3,type:(0,s.Cq)(s.Zl.LCP)},[s.Zl.FID]:{slug:"fid",name:(0,a.t)("First Input Delay"),acronym:"FID",description:(0,a.t)("Response time of the browser to a user interaction (clicking, tapping, etc)."),poorThreshold:300,type:(0,s.Cq)(s.Zl.FID)},[s.Zl.CLS]:{slug:"cls",name:(0,a.t)("Cumulative Layout Shift"),acronym:"CLS",description:(0,a.t)("Sum of layout shift scores that measure the visual stability of the page."),poorThreshold:.25,type:(0,s.Cq)(s.Zl.CLS)},[s.Zl.TTFB]:{slug:"ttfb",name:(0,a.t)("Time to First Byte"),acronym:"TTFB",description:(0,a.t)("The time that it takes for a user's browser to receive the first byte of page content."),poorThreshold:600,type:(0,s.Cq)(s.Zl.TTFB)},[s.Zl.RequestTime]:{slug:"ttfb.requesttime",name:(0,a.t)("Request Time"),acronym:"RT",description:(0,a.t)("Captures the time spent making the request and receiving the first byte of the response."),poorThreshold:600,type:(0,s.Cq)(s.Zl.RequestTime)}},i={[s.$n.AppStartCold]:{slug:"app_start_cold",name:(0,a.t)("App Start Cold"),description:(0,a.t)("Cold start is a measure of the application start up time from scratch."),type:(0,s.Cq)(s.$n.AppStartCold)},[s.$n.AppStartWarm]:{slug:"app_start_warm",name:(0,a.t)("App Start Warm"),description:(0,a.t)("Warm start is a measure of the application start up time while still in memory."),type:(0,s.Cq)(s.$n.AppStartWarm)},[s.$n.FramesTotal]:{slug:"frames_total",name:(0,a.t)("Total Frames"),description:(0,a.t)("Total frames is a count of the number of frames recorded within a transaction."),type:(0,s.Cq)(s.$n.FramesTotal)},[s.$n.FramesSlow]:{slug:"frames_slow",name:(0,a.t)("Slow Frames"),description:(0,a.t)("Slow frames is a count of the number of slow frames recorded within a transaction."),type:(0,s.Cq)(s.$n.FramesSlow)},[s.$n.FramesFrozen]:{slug:"frames_frozen",name:(0,a.t)("Frozen Frames"),description:(0,a.t)("Frozen frames is a count of the number of frozen frames recorded within a transaction."),type:(0,s.Cq)(s.$n.FramesFrozen)},[s.$n.FramesSlowRate]:{slug:"frames_slow_rate",name:(0,a.t)("Slow Frames Rate"),description:(0,a.t)("Slow Frames Rate is the percentage of frames recorded within a transaction that is considered slow."),type:(0,s.Cq)(s.$n.FramesSlowRate)},[s.$n.FramesFrozenRate]:{slug:"frames_frozen_rate",name:(0,a.t)("Frozen Frames Rate"),description:(0,a.t)("Frozen Frames Rate is the percentage of frames recorded within a transaction that is considered frozen."),type:(0,s.Cq)(s.$n.FramesFrozenRate)},[s.$n.StallCount]:{slug:"stall_count",name:(0,a.t)("Stalls"),description:(0,a.t)("Stalls is the number of times the application stalled within a transaction."),type:(0,s.Cq)(s.$n.StallCount)},[s.$n.StallTotalTime]:{slug:"stall_total_time",name:(0,a.t)("Total Stall Time"),description:(0,a.t)("Stall Total Time is the total amount of time the application is stalled within a transaction."),type:(0,s.Cq)(s.$n.StallTotalTime)},[s.$n.StallLongestTime]:{slug:"stall_longest_time",name:(0,a.t)("Longest Stall Time"),description:(0,a.t)("Stall Longest Time is the longest amount of time the application is stalled within a transaction."),type:(0,s.Cq)(s.$n.StallLongestTime)},[s.$n.StallPercentage]:{slug:"stall_percentage",name:(0,a.t)("Stall Percentage"),description:(0,a.t)("Stall Percentage is the percentage of the transaction duration the application was stalled."),type:(0,s.Cq)(s.$n.StallPercentage)}};let o;!function(t){t.CHROME="Chrome",t.EDGE="Edge",t.OPERA="Opera",t.FIREFOX="Firefox",t.SAFARI="Safari",t.IE="IE"}(o||(o={}))},"./app/views/performance/traceDetails/utils.tsx":(t,e,n)=>{n.d(e,{YA:()=>r,Rg:()=>i,uM:()=>o}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=n("./app/constants/pageFilters.tsx"),s=n("./app/utils/performance/quickTrace/utils.tsx");function r(t,e,n,s){const{start:r,end:i,statsPeriod:o}=n;return{pathname:`/organizations/${t.slug}/performance/trace/${e}/`,query:{...s,statsPeriod:o,[a.V.PAGE_START]:r,[a.V.PAGE_END]:i}}}function i(t){const e={projects:new Set,errors:new Set,transactions:new Set,startTimestamp:Number.MAX_SAFE_INTEGER,endTimestamp:0,maxGeneration:0};return t.reduce(((t,e)=>(0,s.S2)(e,((t,e)=>{for(const a of null!==(n=e.errors)&&void 0!==n?n:[]){var n;t.errors.add(a.event_id)}return t.transactions.add(e.event_id),t.projects.add(e.project_slug),t.startTimestamp=Math.min(t.startTimestamp,e.start_timestamp),t.endTimestamp=Math.max(t.endTimestamp,e.timestamp),t.maxGeneration=Math.max(t.maxGeneration,e.generation),t}),t)),e)}function o(t){return null===t.parent_span_id}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_utils_tsx.5fb700fb3a17b450a47b8a50d5eef434.js.map