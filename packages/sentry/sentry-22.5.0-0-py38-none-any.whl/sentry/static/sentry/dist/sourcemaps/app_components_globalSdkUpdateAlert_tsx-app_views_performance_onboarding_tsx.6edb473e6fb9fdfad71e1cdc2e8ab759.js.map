{"version":3,"file":"chunks/app_components_globalSdkUpdateAlert_tsx-app_views_performance_onboarding_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/globalSdkUpdateAlert.tsx","webpack:///./app/components/onboardingPanel.tsx","webpack:///./app/views/performance/onboarding.tsx"],"sourcesContent":["import {Fragment, useCallback, useEffect, useState} from 'react';\n\nimport {promptsCheck, promptsUpdate} from 'sentry/actionCreators/prompts';\nimport Alert, {AlertProps} from 'sentry/components/alert';\nimport {ALL_ACCESS_PROJECTS} from 'sentry/constants/pageFilters';\nimport {t} from 'sentry/locale';\nimport SidebarPanelStore from 'sentry/stores/sidebarPanelStore';\nimport {PageFilters, ProjectSdkUpdates} from 'sentry/types';\nimport trackAdvancedAnalyticsEvent from 'sentry/utils/analytics/trackAdvancedAnalyticsEvent';\nimport {promptIsDismissed} from 'sentry/utils/promptIsDismissed';\nimport useApi from 'sentry/utils/useApi';\nimport useOrganization from 'sentry/utils/useOrganization';\nimport withPageFilters from 'sentry/utils/withPageFilters';\nimport withSdkUpdates from 'sentry/utils/withSdkUpdates';\n\nimport {SidebarPanelKey} from './sidebar/types';\nimport Button from './button';\n\ninterface InnerGlobalSdkSuggestionsProps extends AlertProps {\n  className?: string;\n  sdkUpdates?: ProjectSdkUpdates[] | null;\n  selection?: PageFilters;\n}\n\nfunction InnerGlobalSdkUpdateAlert(\n  props: InnerGlobalSdkSuggestionsProps\n): React.ReactElement | null {\n  const api = useApi();\n  const organization = useOrganization();\n\n  const [showUpdateAlert, setShowUpdateAlert] = useState<boolean>(false);\n\n  const handleSnoozePrompt = useCallback(() => {\n    promptsUpdate(api, {\n      organizationId: organization.id,\n      feature: 'sdk_updates',\n      status: 'snoozed',\n    });\n\n    trackAdvancedAnalyticsEvent('sdk_updates.snoozed', {organization});\n    setShowUpdateAlert(false);\n  }, [api, organization]);\n\n  const handleReviewUpdatesClick = useCallback(() => {\n    SidebarPanelStore.activatePanel(SidebarPanelKey.Broadcasts);\n    trackAdvancedAnalyticsEvent('sdk_updates.clicked', {organization});\n  }, []);\n\n  useEffect(() => {\n    trackAdvancedAnalyticsEvent('sdk_updates.seen', {organization});\n\n    let isUnmounted = false;\n\n    promptsCheck(api, {\n      organizationId: organization.id,\n      feature: 'sdk_updates',\n    }).then(prompt => {\n      if (isUnmounted) {\n        return;\n      }\n\n      setShowUpdateAlert(!promptIsDismissed(prompt));\n    });\n\n    return () => {\n      isUnmounted = true;\n    };\n  }, []);\n\n  if (!showUpdateAlert || !props.sdkUpdates?.length) {\n    return null;\n  }\n\n  // withSdkUpdates explicitly only queries My Projects. This means that when\n  // looking at any projects outside of My Projects (like All Projects), this\n  // will only show the updates relevant to the to user.\n  const projectSpecificUpdates =\n    props.selection?.projects?.length === 0 ||\n    props.selection?.projects[0] === ALL_ACCESS_PROJECTS\n      ? props.sdkUpdates\n      : props.sdkUpdates.filter(update =>\n          props.selection?.projects?.includes(parseInt(update.projectId, 10))\n        );\n\n  // Check if we have at least one suggestion out of the list of updates\n  if (projectSpecificUpdates.every(v => v.suggestions.length === 0)) {\n    return null;\n  }\n\n  return (\n    <Alert\n      type=\"info\"\n      showIcon\n      className={props.className}\n      trailingItems={\n        <Fragment>\n          <Button\n            priority=\"link\"\n            size=\"zero\"\n            title={t('Dismiss for the next two weeks')}\n            onClick={handleSnoozePrompt}\n          >\n            {t('Remind me later')}\n          </Button>\n          <span>|</span>\n          <Button priority=\"link\" size=\"zero\" onClick={handleReviewUpdatesClick}>\n            {t('Review updates')}\n          </Button>\n        </Fragment>\n      }\n    >\n      {t(\n        `You have outdated SDKs in your projects. Update them for important fixes and features.`\n      )}\n    </Alert>\n  );\n}\n\nconst WithSdkUpdatesGlobalSdkUpdateAlert = withSdkUpdates(\n  withPageFilters(InnerGlobalSdkUpdateAlert)\n);\n\nexport {\n  WithSdkUpdatesGlobalSdkUpdateAlert as GlobalSdkUpdateAlert,\n  InnerGlobalSdkUpdateAlert,\n};\n","import styled from '@emotion/styled';\n\nimport {Panel} from 'sentry/components/panels';\nimport space from 'sentry/styles/space';\n\ntype Props = {\n  children: React.ReactNode;\n  image: React.ReactNode;\n  className?: string;\n};\n\nfunction OnboardingPanel({className, image, children}: Props) {\n  return (\n    <Panel className={className}>\n      <Container>\n        <IlloBox>{image}</IlloBox>\n        <StyledBox>{children}</StyledBox>\n      </Container>\n    </Panel>\n  );\n}\n\nconst Container = styled('div')`\n  padding: ${space(3)};\n  position: relative;\n\n  @media (min-width: ${p => p.theme.breakpoints[0]}) {\n    display: flex;\n    align-items: center;\n    flex-direction: row;\n    justify-content: center;\n    flex-wrap: wrap;\n    min-height: 300px;\n    max-width: 1000px;\n    margin: 0 auto;\n  }\n\n  @media (min-width: ${p => p.theme.breakpoints[1]}) {\n    min-height: 350px;\n  }\n`;\n\nconst StyledBox = styled('div')`\n  z-index: 1;\n\n  @media (min-width: ${p => p.theme.breakpoints[0]}) {\n    flex: 2;\n  }\n`;\n\nconst IlloBox = styled(StyledBox)`\n  position: relative;\n  min-height: 100px;\n  max-width: 300px;\n  margin: ${space(2)} auto;\n\n  @media (min-width: ${p => p.theme.breakpoints[0]}) {\n    flex: 1;\n    margin: ${space(3)};\n    max-width: auto;\n  }\n`;\n\nexport default OnboardingPanel;\n","import {browserHistory} from 'react-router';\nimport styled from '@emotion/styled';\nimport * as Sentry from '@sentry/react';\n\nimport emptyStateImg from 'sentry-images/spot/performance-empty-state.svg';\nimport tourAlert from 'sentry-images/spot/performance-tour-alert.svg';\nimport tourCorrelate from 'sentry-images/spot/performance-tour-correlate.svg';\nimport tourMetrics from 'sentry-images/spot/performance-tour-metrics.svg';\nimport tourTrace from 'sentry-images/spot/performance-tour-trace.svg';\n\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  clearIndicators,\n} from 'sentry/actionCreators/indicator';\nimport Button from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport FeatureTourModal, {\n  TourImage,\n  TourStep,\n  TourText,\n} from 'sentry/components/modals/featureTourModal';\nimport OnboardingPanel from 'sentry/components/onboardingPanel';\nimport {t} from 'sentry/locale';\nimport {Organization, Project} from 'sentry/types';\nimport trackAdvancedAnalyticsEvent from 'sentry/utils/analytics/trackAdvancedAnalyticsEvent';\nimport useApi from 'sentry/utils/useApi';\n\nconst performanceSetupUrl =\n  'https://docs.sentry.io/performance-monitoring/getting-started/';\n\nconst docsLink = (\n  <Button external href={performanceSetupUrl}>\n    {t('Setup')}\n  </Button>\n);\n\nexport const PERFORMANCE_TOUR_STEPS: TourStep[] = [\n  {\n    title: t('Track Application Metrics'),\n    image: <TourImage src={tourMetrics} />,\n    body: (\n      <TourText>\n        {t(\n          'Monitor your slowest pageloads and APIs to see which users are having the worst time.'\n        )}\n      </TourText>\n    ),\n    actions: docsLink,\n  },\n  {\n    title: t('Correlate Errors and Performance'),\n    image: <TourImage src={tourCorrelate} />,\n    body: (\n      <TourText>\n        {t(\n          'See what errors occurred within a transaction and the impact of those errors.'\n        )}\n      </TourText>\n    ),\n    actions: docsLink,\n  },\n  {\n    title: t('Watch and Alert'),\n    image: <TourImage src={tourAlert} />,\n    body: (\n      <TourText>\n        {t(\n          'Highlight mission-critical pages and APIs and set latency alerts to notify you before things go wrong.'\n        )}\n      </TourText>\n    ),\n    actions: docsLink,\n  },\n  {\n    title: t('Trace Across Systems'),\n    image: <TourImage src={tourTrace} />,\n    body: (\n      <TourText>\n        {t(\n          \"Follow a trace from a user's session and drill down to identify any bottlenecks that occur.\"\n        )}\n      </TourText>\n    ),\n  },\n];\n\ntype Props = {\n  organization: Organization;\n  project: Project;\n};\n\nfunction Onboarding({organization, project}: Props) {\n  const api = useApi();\n\n  function handleAdvance(step: number, duration: number) {\n    trackAdvancedAnalyticsEvent('performance_views.tour.advance', {\n      step,\n      duration,\n      organization,\n    });\n  }\n\n  function handleClose(step: number, duration: number) {\n    trackAdvancedAnalyticsEvent('performance_views.tour.close', {\n      step,\n      duration,\n      organization,\n    });\n  }\n\n  return (\n    <OnboardingPanel image={<PerfImage src={emptyStateImg} />}>\n      <h3>{t('Pinpoint problems')}</h3>\n      <p>\n        {t(\n          'Something seem slow? Track down transactions to connect the dots between 10-second page loads and poor-performing API calls or slow database queries.'\n        )}\n      </p>\n      <ButtonList gap={1}>\n        <Button\n          priority=\"primary\"\n          target=\"_blank\"\n          href=\"https://docs.sentry.io/performance-monitoring/getting-started/\"\n        >\n          {t('Start Setup')}\n        </Button>\n        <Button\n          data-test-id=\"create-sample-transaction-btn\"\n          onClick={async () => {\n            trackAdvancedAnalyticsEvent('performance_views.create_sample_transaction', {\n              platform: project.platform,\n              organization,\n            });\n            addLoadingMessage(t('Processing sample event...'), {\n              duration: 15000,\n            });\n            const url = `/projects/${organization.slug}/${project.slug}/create-sample-transaction/`;\n            try {\n              const eventData = await api.requestPromise(url, {method: 'POST'});\n              browserHistory.push(\n                `/organizations/${organization.slug}/performance/${project.slug}:${eventData.eventID}/`\n              );\n              clearIndicators();\n            } catch (error) {\n              Sentry.withScope(scope => {\n                scope.setExtra('error', error);\n                Sentry.captureException(new Error('Failed to create sample event'));\n              });\n              clearIndicators();\n              addErrorMessage(t('Failed to create a new sample event'));\n              return;\n            }\n          }}\n        >\n          {t('View Sample Transaction')}\n        </Button>\n      </ButtonList>\n      <FeatureTourModal\n        steps={PERFORMANCE_TOUR_STEPS}\n        onAdvance={handleAdvance}\n        onCloseModal={handleClose}\n        doneUrl={performanceSetupUrl}\n        doneText={t('Start Setup')}\n      >\n        {({showModal}) => (\n          <Button\n            priority=\"link\"\n            onClick={() => {\n              trackAdvancedAnalyticsEvent('performance_views.tour.start', {organization});\n              showModal();\n            }}\n          >\n            {t('Take a Tour')}\n          </Button>\n        )}\n      </FeatureTourModal>\n    </OnboardingPanel>\n  );\n}\n\nconst PerfImage = styled('img')`\n  @media (min-width: ${p => p.theme.breakpoints[0]}) {\n    max-width: unset;\n    user-select: none;\n    position: absolute;\n    top: 75px;\n    bottom: 0;\n    width: 450px;\n    margin-top: auto;\n    margin-bottom: auto;\n  }\n\n  @media (min-width: ${p => p.theme.breakpoints[1]}) {\n    width: 480px;\n  }\n\n  @media (min-width: ${p => p.theme.breakpoints[2]}) {\n    width: 600px;\n  }\n`;\n\nconst ButtonList = styled(ButtonBar)`\n  grid-template-columns: repeat(auto-fit, minmax(130px, max-content));\n  margin-bottom: 16px;\n`;\n\nexport default Onboarding;\n"],"names":["InnerGlobalSdkUpdateAlert","props","api","useApi","organization","useOrganization","showUpdateAlert","setShowUpdateAlert","useState","handleSnoozePrompt","useCallback","promptsUpdate","organizationId","id","feature","status","trackAdvancedAnalyticsEvent","handleReviewUpdatesClick","SidebarPanelStore","SidebarPanelKey","useEffect","isUnmounted","promptsCheck","then","prompt","promptIsDismissed","sdkUpdates","length","selection","projects","ALL_ACCESS_PROJECTS","filter","update","includes","parseInt","projectId","every","v","suggestions","type","showIcon","className","trailingItems","Fragment","priority","size","title","t","onClick","WithSdkUpdatesGlobalSdkUpdateAlert","withSdkUpdates","withPageFilters","OnboardingPanel","image","children","Container","IlloBox","StyledBox","space","p","theme","breakpoints","performanceSetupUrl","docsLink","external","href","PERFORMANCE_TOUR_STEPS","src","tourMetrics","body","actions","tourCorrelate","tourAlert","tourTrace","Onboarding","project","PerfImage","emptyStateImg","ButtonList","gap","target","async","platform","addLoadingMessage","duration","url","slug","eventData","requestPromise","method","browserHistory","eventID","clearIndicators","error","Sentry","scope","setExtra","Error","addErrorMessage","steps","onAdvance","step","onCloseModal","doneUrl","doneText","showModal","ButtonBar"],"sourceRoot":""}